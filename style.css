           @font-face {
               font-family: 'bulangni';
               src: url('') format('truetype');
               font-weight: normal;
               font-style: normal;
               font-display: swap;
           }

           :root {
               --screen-width: 350px;
               --screen-height: 650px;
               --secondary-bg: #ffffff;
               --border-color: #e0e0e0;
               --text-primary: #1f1f1f;
               --text-secondary: #8a8a8a;
               --accent-color: #007bff;
           }

           html {
               -webkit-text-size-adjust: 100%;
               height: 100%;
           }

           body {
               margin: 0;
               font-family: 'bulangni', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
               font-weight: normal;
               background-color: #f0f2f5;
               height: 100%;
               overflow: hidden;
           }

           #phone-screen {
               width: 100%;
               height: 100vh;
               position: relative;
               overflow: hidden;
               display: flex;
               flex-direction: column;
               background-color: #ffffff;
           }

           #chat-input-area {
               flex-shrink: 0;
               padding: 8px;
               padding-bottom: calc(8px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.8);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               display: flex;
               flex-direction: column;
               gap: 5px;
           }

           #status-bar {
               display: none;
               padding: 0 20px;
               height: 40px;
               color: white;
               background-color: transparent;
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               box-sizing: border-box;
               z-index: 100;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
               pointer-events: none;
           }

           #phone-screen.status-bar-visible #status-bar {
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .header,
           .qzone-header {
               position: relative;
               z-index: 15;
               flex-shrink: 0;
               padding: 15px 20px;
               padding-top: calc(15px + env(safe-area-inset-top));
               background-color: rgba(247, 247, 247, 0.8);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-bottom: 1px solid var(--border-color);
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 18px;
               font-weight: 600;
           }

           #status-bar {
               display: none;
           }

           #status-bar-time {
               font-weight: 600;
           }

           .battery-container {
               display: flex;
               align-items: center;
               gap: 5px;
           }

           .battery-icon {
               width: 25px;
               height: 12px;
               border: 1px solid white;
               border-radius: 3px;
               position: relative;
               padding: 1px;
           }

           .battery-icon::after {
               content: '';
               position: absolute;
               right: -3px;
               top: 2px;
               width: 2px;
               height: 6px;
               background-color: white;
               border-radius: 0 1px 1px 0;
           }

           .battery-level {
               height: 100%;
               background-color: white;
               border-radius: 1px;
               transition: width 0.5s ease;
           }

           .battery-container.charging .battery-level {
               background-color: #4cd964;
               animation: charge-breath 2s infinite;
           }

           .battery-container.charging .battery-text {
               color: #4cd964;
           }

           @keyframes charge-breath {

               0%,
               100% {
                   opacity: 1;
               }

               50% {
                   opacity: 0.7;
               }
           }

           .screen {
               width: 100%;
               height: 100%;
               position: absolute;
               top: 0;
               left: 0;
               display: flex;
               flex-direction: column;
               overflow: hidden;
               opacity: 0;
               visibility: hidden;
               transition: opacity 0.3s, visibility 0.3s;
           }

           .screen.active {
               opacity: 1;
               visibility: visible;
               z-index: 1;
           }

           .header {
               position: relative;
               z-index: 15;
               flex-shrink: 0;
               padding: 15px 20px;
               padding-top: 45px;
               background-color: rgba(247, 247, 247, 0.8);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-bottom: 1px solid var(--border-color);
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 18px;
               font-weight: 600;
           }

           .header .header-actions {
               display: flex;
               align-items: center;
               gap: 15px;
               position: relative;
               /* 新增：创建堆叠上下文 */
               z-index: 1;
               /* 新增：确保它在标题span之上 */
           }

           .header .back-btn,
           .header .action-btn {
               font-size: 24px;
               cursor: pointer;
               width: 30px;
               text-align: center;
               color: var(--accent-color);
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .header .action-btn {
               font-size: 16px;
               font-weight: 600;
           }

           .header .action-btn img {
               height: 26px;
           }

           .header .save-btn {
               font-size: 16px;
               color: var(--accent-color);
               font-weight: 600;
               cursor: pointer;
           }

           #home-screen {
               display: flex;
               flex-direction: column;
               justify-content: flex-start;
               align-items: center;
               box-sizing: border-box;
               background-size: cover;
               background-position: center;
               padding-left: 20px;
               padding-right: 20px;
           }

           #clock-container {
               text-align: center;
               color: white;
               text-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
               margin-bottom: 20px;
               flex-shrink: 0;
               margin-top: calc(60px + env(safe-area-inset-top));
           }

           #app-grid {
               margin-top: auto;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 20px;
               width: 100%;
               padding: 20px;
               margin-bottom: calc(30px + env(safe-area-inset-bottom));
           }

           #main-time {
               font-size: 88px;
               font-weight: 600;
               letter-spacing: -2px;
               font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;
           }

           #main-date {
               font-size: 22px;
               font-weight: normal;
           }

           #app-grid {
               margin-top: auto;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 20px;
               width: 100%;
               padding: 20px;
           }

           .app-row {
               display: flex;
               justify-content: center;
               gap: 25px;
               width: 100%;
           }

           .app-icon {
               display: flex;
               flex-direction: column;
               align-items: center;
               cursor: pointer;
               color: white;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
               font-size: 14px;
               font-weight: 500;
               text-align: center;
           }

           .app-icon .icon-bg {
               width: 65px;
               height: 65px;
               border-radius: 18px;
               background-color: var(--secondary-bg);
               display: flex;
               justify-content: center;
               align-items: center;
               font-size: 32px;
               margin-bottom: 8px;
               box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
               transition: transform 0.2s ease;
               overflow: hidden;
           }

           .app-icon:active .icon-bg {
               transform: scale(0.9);
           }

           .app-icon .icon-bg img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           .app-icon .label {
               color: white;
           }

           .form-container,
           .list-container {
               padding: 20px;
               overflow-y: auto;
               flex-grow: 1;
               display: flex;
               flex-direction: column;
           }

           .form-group {
               margin-bottom: 20px;
           }

           .form-group label {
               display: block;
               margin-bottom: 8px;
               font-weight: 500;
               color: var(--text-secondary);
           }

           .form-group input,
           .form-group select,
           .form-group textarea {
               width: 100%;
               padding: 12px;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               font-size: 16px;
               box-sizing: border-box;
           }

           .form-group textarea {
               min-height: 80px;
               resize: vertical;
           }

           #world-book-content-input {
               height: calc(100% - 120px);
           }

           .form-button {
               width: 100%;
               padding: 15px;
               background-color: var(--accent-color);
               color: white;
               border: none;
               border-radius: 8px;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               margin-top: 10px;
           }

           .form-button-secondary {
               background-color: #f0f0f0;
               color: var(--text-primary);
               border: 1px solid var(--border-color);
           }

           #wallpaper-screen .form-container {
               align-items: center;
           }

           #wallpaper-preview {
               width: 180px;
               height: 320px;
               border: 2px dashed var(--border-color);
               background-color: #f0f2f5;
               margin-bottom: 20px;
               background-size: cover;
               background-position: center;
               border-radius: 10px;
               display: flex;
               justify-content: center;
               align-items: center;
               color: var(--text-secondary);
           }

           #wallpaper-upload-input {
               display: none;
           }

           #world-book-list {
               flex-grow: 1;
               overflow-y: auto;
               background-color: var(--secondary-bg);
               padding-top: 80px;
               margin-top: -80px;
           }

           #chat-list {
               flex-grow: 1;
               background-color: var(--secondary-bg);
               padding-top: 80px;
               padding-bottom: 90px;
               box-sizing: border-box;
           }

           .list-item {
               display: flex;
               flex-direction: column;
               padding: 12px 20px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
           }

           .list-item:hover {
               background-color: #f5f5f5;
           }

           .list-item .item-title {
               font-weight: 500;
               font-size: 16px;
               margin-bottom: 5px;
           }

           .list-item .item-content {
               font-size: 14px;
               color: var(--text-secondary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .chat-list-item {
               display: flex;
               align-items: center;
               padding: 10px 15px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
               position: relative;
           }

           .chat-list-item:hover {
               background-color: #f5f5f5;
           }

           .chat-list-item .avatar {
               width: 45px;
               height: 45px;
               border-radius: 50%;
               margin-right: 12px;
               object-fit: cover;
               background-color: #ccc;
           }

           .chat-list-item .info {
               flex-grow: 1;
               overflow: hidden;
           }

           .chat-list-item .name-line {
               display: flex;
               align-items: center;
               gap: 6px;
               margin-bottom: 2px;
           }

           .chat-list-item .name {
               font-weight: 500;
               color: var(--text-primary);
           }

           .chat-list-item .group-tag {
               font-size: 10px;
               color: var(--accent-color);
               background-color: #e7f3ff;
               padding: 2px 6px;
               border-radius: 4px;
               font-weight: bold;
               flex-shrink: 0;
           }

           .chat-list-item .last-msg {
               font-size: 13px;
               color: var(--text-secondary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               max-width: 180px;
           }

           #chat-interface-screen {
               background-size: cover;
               background-position: center;
               position: relative;
           }

           #selection-cancel-btn,
           #selection-delete-btn {
               font-size: 16px;
               color: var(--accent-color);
               cursor: pointer;
               padding: 5px;
           }

           #selection-delete-btn {
               color: #ff3b30;
           }

           #chat-messages {
               flex-grow: 1;
               overflow-y: auto;
               overflow-x: hidden;
               padding: 10px 15px;
               padding-top: 110px;
               margin-top: -80px;
               display: flex;
               flex-direction: column;
               gap: 20px;
               box-sizing: border-box;
           }

           #load-more-btn {
               text-align: center;
               padding: 10px;
               color: var(--accent-color);
               font-size: 14px;
               cursor: pointer;
               background-color: transparent;
               border: none;
               width: 100%;
           }

           #load-more-btn:hover {
               text-decoration: underline;
           }

           .sender-name {
               font-size: 11px;
               color: #666;
               margin-bottom: 3px;
           }

           .message-wrapper.ai .sender-name {
               margin-left: 50px;
               margin-bottom: 3px;
               position: absolute;
               top: -16px;
               left: 0;
           }

           .message-wrapper {
               display: flex;
               gap: 8px;
               align-items: flex-end;
               position: relative;
               max-width: 90%;
           }

           .message-wrapper.ai {
               align-self: flex-start;
               flex-direction: row;
           }

           .message-wrapper.user {
               align-self: flex-end;
               flex-direction: row-reverse;
           }

           .message-bubble {
               display: flex;
               align-items: flex-start;
               gap: 12px;
               max-width: 100%;
               min-width: 0;
           }

           .timestamp {
               font-size: 11px;
               color: #999;
               text-shadow: 0 0 3px rgba(255, 255, 255, 0.6);
               white-space: nowrap;
               margin-bottom: 5px;
               flex-shrink: 0;
           }

           .message-bubble.selected::after {
               content: '✔';
               position: absolute;
               left: -10px;
               top: 50%;
               transform: translateY(-50%);
               background-color: var(--accent-color);
               color: white;
               width: 20px;
               height: 20px;
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 12px;
           }

           .message-bubble.user.selected::after {
               left: auto;
               right: -10px;
           }

           .message-bubble.user {
               flex-direction: row-reverse;
           }

           #typing-indicator {
               align-self: flex-start;
               display: none;
               margin: 0 10px 10px;
               color: var(--text-secondary);
           }

           #chat-list-bottom-nav {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               z-index: 15;
               display: flex;
               border-top: 1px solid var(--border-color);
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               padding-bottom: env(safe-area-inset-bottom);
           }

           #chat-input-main-row {
               display: flex;
               align-items: flex-end;
               gap: 8px;
               width: 100%;
           }

           #chat-input {
               flex-grow: 1;
               border: none;
               padding: 10px 15px;
               border-radius: 20px;
               background-color: var(--secondary-bg);
               font-size: 16px;
               height: 40px;
               resize: none;
               overflow-y: auto;
               box-sizing: border-box;
           }

           .action-button {
               border: none;
               color: white;
               border-radius: 20px;
               cursor: pointer;
               font-weight: 600;
               font-size: 14px;
               flex-shrink: 0;
           }

           #send-btn {
               background-color: var(--accent-color);
               height: 40px;
               padding: 0 15px;
           }

           .modal {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.4);
               display: none;
               justify-content: center;
               align-items: center;
               z-index: 100;
           }

           .modal.visible {
               display: flex;
           }

           .modal-content {
               width: 90%;
               max-height: 90%;
               background-color: white;
               border-radius: 15px;
               display: flex;
               flex-direction: column;
           }

           .modal-header {
               padding: 15px;
               font-weight: 600;
               border-bottom: 1px solid var(--border-color);
               text-align: center;
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .modal-body {
               padding: 15px;
               overflow-y: auto;
           }

           .modal-footer {
               padding: 15px;
               border-top: 1px solid var(--border-color);
               display: flex;
               justify-content: space-around;
           }

           .modal-footer button {
               width: 45%;
               padding: 12px;
               border-radius: 8px;
               border: 1px solid var(--accent-color);
               cursor: pointer;
               font-size: 16px;
           }

           .modal-footer .save {
               background-color: var(--accent-color);
               color: white;
           }

           .modal-footer .cancel {
               background-color: white;
               color: var(--accent-color);
           }

           .avatar-upload {
               display: flex;
               align-items: center;
               gap: 15px;
           }

           .avatar-upload img {
               width: 60px;
               height: 60px;
               border-radius: 50%;
               object-fit: cover;
               background-color: #eee;
           }

           .avatar-upload button {
               padding: 8px 12px;
               border: 1px solid #ccc;
               background-color: #f0f0f0;
               border-radius: 5px;
               cursor: pointer;
           }

           #open-persona-library-btn {
               font-size: 14px;
               padding: 6px 10px;
               margin-left: 0;
           }

           .avatar-upload input[type="file"] {
               display: none;
           }

           .theme-selector label {
               display: inline-flex;
               align-items: center;
               margin-right: 15px;
               margin-bottom: 5px;
               cursor: pointer;
           }

           #reset-theme-btn {
               background: none;
               border: 1px solid #ccc;
               color: #555;
               font-size: 12px;
               padding: 2px 8px;
               border-radius: 5px;
               cursor: pointer;
               margin-left: 10px;
           }

           #group-members-settings {
               display: flex;
               overflow-x: auto;
               padding-bottom: 10px;
               gap: 15px;
           }

           .member-editor {
               text-align: center;
               cursor: pointer;
           }

           .member-editor img {
               width: 50px;
               height: 50px;
               border-radius: 50%;
               object-fit: cover;
               background-color: #eee;
               margin-bottom: 5px;
           }

           .member-editor .member-name {
               font-size: 12px;
           }

           #notification-bar {
               position: absolute;
               top: 40px;
               left: 50%;
               width: 90%;
               z-index: 500;
               background-color: rgba(250, 250, 250, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-radius: 16px;
               padding: 10px;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
               display: flex;
               align-items: center;
               gap: 12px;
               cursor: pointer;
               transform: translateX(-50%) translateY(-150%);
               transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
               visibility: hidden;
           }

           #notification-bar.visible {
               transform: translateX(-50%) translateY(0);
               visibility: visible;
           }

           #notification-avatar {
               width: 30px;
               height: 30px;
               border-radius: 50%;
               object-fit: cover;
           }

           #notification-content .name {
               font-weight: 600;
               font-size: 15px;
               color: #000;
           }

           #notification-content .message {
               font-size: 14px;
               color: #555;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               max-width: 200px;
           }

           .sticker-image {
               max-width: 100px;
               max-height: 100px;
               display: block;
               object-fit: contain;
           }

           #chat-input-actions-top {
               display: flex;
               gap: 8px;
               padding: 0 5px;
           }

           .chat-action-icon-btn {
               font-size: 24px;
               padding: 0;
               width: 38px;
               height: 38px;
               line-height: 38px;
               text-align: center;
               border-radius: 50%;
               background-color: rgba(255, 255, 255, 0.5);
               color: var(--text-primary);
               backdrop-filter: blur(5px);
               -webkit-backdrop-filter: blur(5px);
               border: 1px solid rgba(0, 0, 0, 0.05);
               cursor: pointer;
               display: flex;
               justify-content: center;
               align-items: center;
           }

           /* 暂停调用按钮样式 */
           #stop-api-call-btn {
               background-color: rgba(255, 59, 48, 0.1);
               border: 1px solid rgba(255, 59, 48, 0.3);
               color: #ff3b30;
               transition: all 0.3s ease;
           }

           #stop-api-call-btn:hover {
               background-color: rgba(255, 59, 48, 0.2);
               border-color: rgba(255, 59, 48, 0.5);
           }

           #stop-api-call-btn:active {
               transform: scale(0.95);
           }

           #stop-api-call-btn.active {
               background-color: rgba(255, 59, 48, 0.3);
               animation: pulse-stop 1.5s ease-in-out infinite;
           }

           @keyframes pulse-stop {

               0%,
               100% {
                   opacity: 1;
               }

               50% {
                   opacity: 0.7;
               }
           }

           #sticker-panel {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               height: 50%;
               background-color: rgba(242, 242, 247, 0.85);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border-top: 1px solid var(--border-color);
               border-radius: 20px 20px 0 0;
               z-index: 200;
               display: flex;
               flex-direction: column;
               transform: translateY(100%);
               transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
               visibility: hidden;
           }

           #sticker-panel.visible {
               transform: translateY(0);
               visibility: visible;
           }

           #sticker-panel-header {
               padding: 10px 20px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
           }

           #sticker-panel-header .title {
               font-weight: 600;
           }

           #sticker-panel-header .panel-btn {
               font-size: 16px;
               padding: 5px 10px;
               cursor: pointer;
               color: var(--accent-color);
           }

           #sticker-grid {
               flex-grow: 1;
               overflow-y: auto;
               padding: 15px;
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
               gap: 15px;
           }

           .sticker-item {
               position: relative;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 6px;
               cursor: pointer;
           }

           .sticker-image-container {
               width: 100%;
               aspect-ratio: 1 / 1;
               background-color: white;
               border-radius: 10px;
               background-size: contain;
               background-repeat: no-repeat;
               background-position: center;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
           }

           .sticker-name {
               font-size: 12px;
               color: var(--text-secondary);
               width: 100%;
               text-align: center;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .sticker-item .delete-btn {
               display: none;
               position: absolute;
               top: -5px;
               right: -5px;
               width: 20px;
               height: 20px;
               background-color: #ff3b30;
               color: white;
               border-radius: 50%;
               text-align: center;
               line-height: 20px;
               font-size: 14px;
               cursor: pointer;
               border: 2px solid white;
           }

           #input-actions-wrapper {
               position: static;
               display: flex;
               align-items: flex-end;
               gap: 8px;
               flex-shrink: 0;
           }

           #wait-reply-btn {
               position: static;
               bottom: auto;
               right: auto;
               width: auto;
               height: 40px;
               padding: 0 10px;
               border-radius: 20px;
               display: flex;
               align-items: center;
               justify-content: center;
               background-color: rgba(255, 255, 255, 0.6);
               backdrop-filter: blur(5px);
               -webkit-backdrop-filter: blur(5px);
               border: 1px solid rgba(0, 0, 0, 0.08);
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
               transition: opacity 0.2s, transform 0.1s;
               cursor: pointer;
           }

           #wait-reply-btn:hover {
               opacity: 0.8;
           }

           #wait-reply-btn:active {
               transform: scale(0.9);
           }

           #wait-reply-btn img {
               height: 22px;
               display: block;
               margin: auto;
           }

           .chat-image {
               max-width: 100%;
               border-radius: 10px;
               display: block;
           }

           .message-bubble.has-image .content {
               padding: 5px;
           }

           #custom-modal-overlay {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.5);
               display: none;
               align-items: center;
               justify-content: center;
               z-index: 10200;
               opacity: 0;
               transition: opacity 0.2s ease-in-out;
           }

           #custom-modal-overlay.visible {
               display: flex;
               opacity: 1;
           }

           #custom-modal {
               background-color: var(--secondary-bg);
               width: 280px;
               border-radius: 14px;
               box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
               display: flex;
               flex-direction: column;
               transform: scale(0.95);
               transition: transform 0.2s ease-in-out;
           }

           #custom-modal-overlay.visible #custom-modal {
               transform: scale(1);
           }

           .custom-modal-header {
               padding: 16px;
               font-size: 17px;
               font-weight: 600;
               text-align: center;
           }

           .custom-modal-body {
               padding: 0 16px 16px;
               text-align: center;
               font-size: 14px;
               color: #333;
               line-height: 1.5;
               max-height: 60vh;
               overflow-y: auto;
           }

           .custom-modal-body p {
               margin: 0;
               margin-bottom: 12px;
           }

           .custom-modal-body input {
               width: 100%;
               padding: 8px 12px;
               border-radius: 6px;
               border: 1px solid #ccc;
               font-size: 16px;
               box-sizing: border-box;
           }

           .custom-modal-footer {
               border-top: 1px solid #dbdbdb;
               display: flex;
           }

           .custom-modal-footer button {
               flex: 1;
               background: none;
               border: none;
               padding: 12px;
               font-size: 17px;
               cursor: pointer;
               color: var(--accent-color);
           }

           .custom-modal-footer button:first-child {
               border-right: 1px solid #dbdbdb;
           }

           .custom-modal-footer .confirm-btn {
               font-weight: 600;
           }

           .custom-modal-footer .confirm-btn.btn-danger {
               color: #ff3b30;
           }

           #preset-actions-modal .custom-modal-footer {
               flex-direction: column;
           }

           #preset-actions-modal .custom-modal-footer button {
               width: 100%;
               border: none;
               border-bottom: 1px solid #dbdbdb;
               padding: 14px;
               font-size: 18px;
           }

           #preset-actions-modal .custom-modal-footer button:last-child {
               border-bottom: none;
           }

           .custom-multiselect {
               position: relative;
               -webkit-user-select: none;
               user-select: none;
           }

           .select-box {
               display: flex;
               align-items: center;
               width: 100%;
               padding: 12px;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               font-size: 16px;
               box-sizing: border-box;
               background-color: var(--secondary-bg);
               cursor: pointer;
           }

           .select-box .selected-options-text {
               flex-grow: 1;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               color: var(--text-primary);
           }

           .select-box .arrow-down {
               margin-left: auto;
               font-size: 10px;
               color: var(--text-secondary);
               transition: transform 0.2s;
           }

           .select-box.expanded .arrow-down {
               transform: rotate(180deg);
           }

           .checkboxes-container {
               display: none;
               position: absolute;
               top: 100%;
               margin-top: 5px;
               left: 0;
               right: 0;
               max-height: 150px;
               overflow-y: auto;
               background-color: var(--secondary-bg);
               /* <-- 修改后 */
               border: 1px solid var(--border-color);
               border-radius: 8px;
               z-index: 101;
               box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
           }

           .checkboxes-container.visible {
               display: block;
           }

           .checkboxes-container label {
               display: block;
               padding: 10px 12px;
               cursor: pointer;
               font-weight: normal;
               color: var(--text-primary);
           }

           .checkboxes-container label {
               display: block;
               padding: 12px 15px;
               cursor: pointer;
               font-weight: normal;
               color: var(--text-primary);
               font-size: 15px;
           }

           .checkboxes-container input {
               margin-right: 10px;
               vertical-align: middle;
           }

           .bg-upload-container {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-top: 8px;
               flex-wrap: wrap;
           }

           .bg-preview-img {
               max-width: 120px;
               max-height: 80px;
               border-radius: 8px;
               border: 1px solid var(--border-color);
               object-fit: cover;
               display: none;
           }

           #remove-bg-btn {
               padding: 8px 12px;
               border: 1px solid #ff3b30;
               color: #ff3b30;
               background-color: var(--secondary-bg);
               border-radius: 5px;
               cursor: pointer;
               font-size: 14px;
               display: none;
           }

           .ai-generated-image {
               max-width: 180px;
               border-radius: 12px;
               display: block;
               cursor: pointer;
               transition: transform 0.2s, box-shadow 0.2s;
           }

           .ai-generated-image:hover {
               transform: scale(1.05);
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
           }

           /* RealImag/NovelAI图片在私聊/群聊消息气泡里的样式 */
           .realimag-image {
               max-width: 250px;
               max-height: 250px;
               width: auto;
               height: auto;
               display: block;
               border-radius: 10px;
               object-fit: cover;
               background-color: #f8f8f8;
               min-width: 100px;
               min-height: 100px;
               cursor: pointer;
               transition: transform 0.2s;
           }

           .realimag-image:hover {
               transform: scale(1.02);
           }

           .message-bubble.is-realimag .content {
               padding: 5px;
               background: transparent;
               box-shadow: none;
               border: none;
               backdrop-filter: none;
               -webkit-backdrop-filter: none;
           }

           .voice-message-body {
               display: flex;
               align-items: center;
               cursor: pointer;
               padding: 8px 12px;
               min-width: 80px;
               max-width: 200px;
           }

           .message-bubble.user .voice-message-body {
               color: #1a3d00;
               flex-direction: row-reverse;
           }

           .message-bubble.ai .voice-message-body {
               color: var(--text-primary);
           }

           .voice-waveform {
               display: flex;
               align-items: center;
               height: 20px;
               gap: 2px;
               flex-grow: 1;
               margin: 0 10px;
           }

           .voice-waveform div {
               width: 3px;
               background-color: currentColor;
               border-radius: 2px;
               animation: wave-quiet 1.5s ease-in-out infinite;
           }

           @keyframes wave-quiet {

               0%,
               100% {
                   height: 2px;
               }

               50% {
                   height: 10px;
               }
           }

           .voice-waveform div:nth-child(2) {
               animation-delay: 0.2s;
           }

           .voice-waveform div:nth-child(3) {
               animation-delay: 0.4s;
           }

           .voice-waveform div:nth-child(4) {
               animation-delay: 0.6s;
           }

           .voice-waveform div:nth-child(5) {
               animation-delay: 0.8s;
           }

           .voice-duration {
               font-size: var(--chat-font-size, 13px);
               font-weight: 500;
               color: var(--text-secondary);
           }

           .message-bubble.user .voice-duration {
               color: #3e6224;
           }

           .message-bubble .content {
               position: relative;
               font-size: var(--chat-font-size, 16px);
               padding: 8px 12px;
               line-height: 1.5;
               word-break: break-word;
           }

           .message-bubble.user .content {
               background-color: rgba(255, 255, 255, 0.75);
               color: #585858;
               border-radius: 8px 2px 8px 8px;
           }

           .message-bubble.ai .content {
               background-color: rgba(255, 255, 255, 0.7);
               color: #585858;
               border-radius: 2px 8px 8px 8px;
           }

           .message-bubble::after {
               content: "";
               position: absolute;
               width: 20px;
               height: 20px;
               background-size: contain;
               background-repeat: no-repeat;
               opacity: 1;
               z-index: 1;
           }

           #chat-messages[data-theme="pink_blue"] .message-bubble.user .content {
               background-color: #fff0f6;
               color: #432531;
           }

           #chat-messages[data-theme="pink_blue"] .message-bubble.ai .content {
               background-color: #eff7ff;
               color: #263a4e;
           }

           #chat-messages[data-theme="blue_white"] .message-bubble.user .content {
               background-color: #eff7ff;
               color: #263a4e;
           }

           #chat-messages[data-theme="blue_white"] .message-bubble.ai .content {
               background-color: #f8f9fa;
               color: #383d41;
           }

           #chat-messages[data-theme="purple_yellow"] .message-bubble.user .content {
               background-color: #faf7ff;
               color: #827693;
           }

           #chat-messages[data-theme="purple_yellow"] .message-bubble.ai .content {
               background-color: #fffde4;
               color: #5C4033;
           }

           #chat-messages[data-theme="black_white"] .message-bubble.user .content {
               background-color: #343a40;
               color: #f8f9fa;
           }

           #chat-messages[data-theme="black_white"] .message-bubble.ai .content {
               background-color: #f8f9fa;
               color: #343a40;
           }

           #chat-messages[data-theme="yellow_white"] .message-bubble.user .content {
               background-color: #FFEB3B;
               color: #5D4037;
           }

           #chat-messages[data-theme="yellow_white"] .message-bubble.ai .content {
               background-color: #f8f9fa;
               color: #383d41;
           }

           #chat-messages[data-theme="red_black"] .message-bubble.user .content {
               background-color: #C62828;
               color: #FFFFFF;
           }

           #chat-messages[data-theme="red_black"] .message-bubble.ai .content {
               background-color: #212121;
               color: #FFFFFF;
           }

           #chat-messages[data-theme="blue_yellow"] .message-bubble.user .content {
               background-color: #A0D2EB;
               color: #153243;
           }

           #chat-messages[data-theme="blue_yellow"] .message-bubble.ai .content {
               background-color: #FEF9E7;
               color: #5D4037;
           }

           #chat-messages[data-theme="pink_yellow"] .message-bubble.user .content {
               background-color: #fff0f6;
               color: #432531;
           }

           #chat-messages[data-theme="pink_yellow"] .message-bubble.ai .content {
               background-color: #FEF9E7;
               color: #5D4037;
           }

           #chat-messages[data-theme="pink_purple"] .message-bubble.user .content {
               background-color: #fff0f6;
               color: #a78396;
           }

           #chat-messages[data-theme="pink_purple"] .message-bubble.ai .content {
               background-color: #faf7ff;
               color: #827693;
           }

           #chat-messages[data-theme="gray_white"] .message-bubble.user .content {
               background-color: #e9ecef;
               color: #495057;
           }

           #chat-messages[data-theme="gray_white"] .message-bubble.ai .content {
               background-color: #f8f9fa;
               color: #383d41;
           }

           /* 记忆库样式 */
           .memory-archive-item {
               background-color: var(--secondary-bg);
               border: 1px solid var(--border-color);
               border-radius: 8px;
               padding: 12px;
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .memory-archive-info {
               flex-grow: 1;
           }

           .memory-archive-name {
               font-weight: 500;
               font-size: 15px;
               margin-bottom: 4px;
           }

           .memory-archive-date {
               font-size: 12px;
               color: var(--text-secondary);
           }

           .memory-archive-actions {
               display: flex;
               gap: 8px;
           }

           .memory-archive-btn {
               padding: 6px 12px;
               border: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
               border-radius: 6px;
               cursor: pointer;
               font-size: 13px;
               color: var(--text-primary);
           }

           .memory-archive-btn.load {
               background-color: var(--accent-color);
               color: white;
               border-color: var(--accent-color);
           }

           .memory-archive-btn.delete {
               color: #ff3b30;
               border-color: #ff3b30;
           }

           #chat-messages[data-theme="blue_green"] .message-bubble.user .content {
               background-color: #d1ecf1;
               color: #0c5460;
           }

           #chat-messages[data-theme="blue_green"] .message-bubble.ai .content {
               background-color: #d4edda;
               color: #155724;
           }

           #chat-messages[data-theme="pink_white"] .message-bubble.user .content {
               background-color: #fff0f6;
               color: #a78396;
           }

           #chat-messages[data-theme="pink_white"] .message-bubble.ai .content {
               background-color: #f8f9fa;
               color: #383d41;
           }

           #chat-messages[data-theme="pink_black"] .message-bubble.user .content {
               background-color: #F8BBD0;
               color: #5B2C6F;
           }

           #chat-messages[data-theme="pink_black"] .message-bubble.ai .content {
               background-color: #343a40;
               color: #f8f9fa;
           }

           #chat-messages[data-theme="pink_green"] .message-bubble.user .content {
               background-color: #F8BBD0;
               color: #5B2C6F;
           }

           #chat-messages[data-theme="pink_green"] .message-bubble.ai .content {
               background-color: #C8E6C9;
               color: #1B5E20;
           }

           #chat-messages[data-theme="green_black"] .message-bubble.user .content {
               background-color: #d4edda;
               color: #155724;
           }

           #chat-messages[data-theme="green_black"] .message-bubble.ai .content {
               background-color: #343a40;
               color: #f8f9fa;
           }

           #transfer-btn {
               font-weight: bold;
           }

           #transfer-modal {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.5);
               display: none;
               align-items: center;
               justify-content: center;
               z-index: 1001;
           }

           #transfer-modal.visible {
               display: flex;
           }

           .transfer-content {
               background-color: #fff0f5;
               border-radius: 20px;
               width: 290px;
               padding: 20px;
               box-shadow: 0 5px 25px rgba(255, 105, 180, 0.3);
               text-align: center;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100" opacity="0.05"><path d="M50,4 C35,4 28,15 28,24 C28,33 35,32 35,40 C35,48 28,49 28,57 C28,65 35,66 35,74 C35,82 28,83 28,91 C28,99 35,100 50,100 C65,100 72,99 72,91 C72,83 65,82 65,74 C65,66 72,65 72,57 C72,49 65,48 65,40 C65,32 72,33 72,24 C72,15 65,4 50,4 Z" fill="%23FF69B4"/></svg>');
               background-repeat: no-repeat;
               background-position: top right;
               background-size: 80px;
           }

           .transfer-header {
               font-size: 20px;
               font-weight: bold;
               color: #a35c7b;
               margin-bottom: 20px;
           }

           .transfer-input-group {
               margin-bottom: 15px;
               text-align: left;
           }

           .transfer-input-group label {
               display: block;
               font-size: 14px;
               color: #ff85b3;
               margin-bottom: 5px;
               font-weight: 500;
           }

           .transfer-input-group input {
               width: 100%;
               padding: 12px;
               border-radius: 10px;
               border: 2px solid #ffcce0;
               background-color: var(--secondary-bg);
               font-size: 16px;
               box-sizing: border-box;
           }

           .transfer-input-group input:focus {
               border-color: #ff85b3;
               outline: none;
           }

           .transfer-actions {
               display: flex;
               justify-content: space-between;
               gap: 10px;
           }

           .transfer-actions button {
               flex: 1;
               padding: 12px;
               border: none;
               border-radius: 10px;
               font-size: 16px;
               font-weight: bold;
               cursor: pointer;
               transition: transform 0.2s;
           }

           .transfer-actions button:active {
               transform: scale(0.95);
           }

           #transfer-cancel-btn {
               background-color: #ffdde9;
               color: #a35c7b;
           }

           #transfer-confirm-btn {
               background-color: #ff85b3;
               color: white;
           }

           .transfer-card {
               width: 200px;
               border-radius: 12px;
               padding: 12px;
               color: white;
               position: relative;
               overflow: hidden;
           }

           .transfer-card::before {
               content: '🐾';
               position: absolute;
               right: 10px;
               top: 5px;
               font-size: 30px;
               opacity: 0.2;
               transform: rotate(15deg);
           }

           .message-bubble.user .transfer-card {
               background: radial-gradient(circle at top left, #ffc5d5, #ff85b3);
           }

           .message-bubble.ai .transfer-card {
               background: radial-gradient(circle at top left, #a1c4fd, #c2e9fb);
           }

           .transfer-title {
               font-size: 16px;
               font-weight: 600;
               display: flex;
               align-items: center;
               gap: 6px;
               margin-bottom: 8px;
           }

           .transfer-amount {
               font-size: 28px;
               font-weight: bold;
               margin-bottom: 4px;
           }

           .transfer-note {
               font-size: 13px;
               opacity: 0.9;
               border-top: 1px solid rgba(255, 255, 255, 0.3);
               padding-top: 8px;
               margin-top: 8px;
               word-break: break-all;
           }

           @keyframes spin {
               from {
                   transform: rotate(0deg);
               }

               to {
                   transform: rotate(360deg);
               }
           }

           #listen-together-btn img.rotating {
               animation: spin 2s linear infinite;
           }

           #listen-together-btn img.paused {
               animation-play-state: paused;
           }

           #music-player-overlay {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               z-index: 50;
               display: none;
               justify-content: center;
               align-items: center;
               background-color: rgba(0, 0, 0, 0.3);
           }

           #music-player-overlay.visible {
               display: flex;
           }

           .music-player-window {
               width: 90%;
               background-color: rgba(255, 255, 255, 0.6);
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border-radius: 20px;
               box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
               border: 1px solid rgba(255, 255, 255, 0.18);
               padding: 25px;
               display: flex;
               flex-direction: column;
               align-items: center;
               color: #1f1f1f;
               position: relative;
           }

           #music-playlist-btn {
               position: absolute;
               top: 15px;
               right: 15px;
               font-size: 24px;
               cursor: pointer;
               color: #333;
           }

           #music-time-counter {
               font-size: 12px;
               color: #555;
               margin-bottom: 20px;
           }

           #music-player-song-title {
               font-size: 20px;
               font-weight: 600;
               margin-bottom: 5px;
               text-align: center;
           }

           #music-player-artist {
               font-size: 14px;
               color: #666;
               margin-bottom: 25px;
           }

           .music-controls {
               display: flex;
               align-items: center;
               justify-content: center;
               gap: 20px;
               width: 100%;
               margin-bottom: 30px;
           }

           .music-controls button {
               background: none;
               border: none;
               font-size: 16px;
               font-weight: bold;
               cursor: pointer;
               color: #333;
               width: 44px;
               height: 44px;
               display: flex;
               justify-content: center;
               align-items: center;
               transition: transform 0.2s;
           }

           .music-controls button:active {
               transform: scale(0.9);
           }

           .music-controls .play-pause-btn {
               font-size: 24px;
               width: 60px;
               height: 60px;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.05);
           }

           .music-bottom-actions {
               display: flex;
               justify-content: space-between;
               width: 100%;
           }

           .music-bottom-actions button {
               flex: 1;
               padding: 12px 0;
               border: none;
               border-radius: 10px;
               font-size: 15px;
               font-weight: 500;
               cursor: pointer;
           }

           #music-exit-btn {
               background-color: rgba(255, 100, 100, 0.7);
               color: white;
               margin-right: 5px;
           }

           #music-return-btn {
               background-color: rgba(0, 123, 255, 0.7);
               color: white;
               margin-left: 5px;
           }

           #music-playlist-panel {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               height: 70%;
               background-color: rgba(242, 242, 247, 0.9);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border-top: 1px solid var(--border-color);
               border-radius: 20px 20px 0 0;
               z-index: 210;
               display: flex;
               flex-direction: column;
               transform: translateY(100%);
               transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
               visibility: hidden;
           }

           #music-playlist-panel.visible {
               transform: translateY(0);
               visibility: visible;
           }

           .playlist-header {
               padding: 15px 20px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
               font-weight: 600;
           }

           .playlist-header .panel-btn {
               font-size: 16px;
               cursor: pointer;
               color: var(--accent-color);
           }

           .playlist-body {
               flex-grow: 1;
               overflow-y: auto;
               padding: 10px 0 80px 0;
               box-sizing: border-box;
           }

           .playlist-item {
               padding: 10px 20px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               cursor: pointer;
               border-bottom: 1px solid #eee;
           }

           .playlist-item.playing {
               background-color: rgba(0, 123, 255, 0.1);
           }

           .playlist-item-info .title {
               font-weight: 500;
               font-size: 15px;
           }

           .playlist-item-info .artist {
               font-size: 12px;
               color: #666;
           }

           .playlist-item .delete-track-btn {
               color: #ff3b30;
               font-size: 20px;
               padding: 5px;
           }

           #persona-library-grid {
               display: grid;
               grid-template-columns: repeat(4, 1fr);
               gap: 15px;
               padding: 10px;
           }

           .persona-preset-item {
               aspect-ratio: 1 / 1;
               border-radius: 12px;
               background-size: cover;
               background-position: center;
               cursor: pointer;
               transition: transform 0.2s, box-shadow 0.2s;
               border: 1px solid rgba(0, 0, 0, 0.1);
               position: relative;
           }

           .persona-preset-item:hover {
               transform: scale(1.08);
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
           }

           .persona-preset-item.manage-mode::before {
               content: '';
               position: absolute;
               top: 5px;
               left: 5px;
               width: 20px;
               height: 20px;
               border: 2px solid white;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.3);
               box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
           }

           .persona-preset-item.selected::before {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           .persona-preset-item.selected::after {
               content: '✓';
               position: absolute;
               top: 5px;
               left: 5px;
               width: 20px;
               height: 20px;
               color: white;
               font-size: 14px;
               font-weight: bold;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .modal-header .header-actions {
               display: flex;
               gap: 10px;
           }

           #persona-manage-actions {
               display: flex;
               gap: 10px;
           }

           .modal-header .action-button {
               font-size: 16px;
               color: var(--accent-color);
               font-weight: 600;
               cursor: pointer;
               background: none;
               border: none;
               padding: 5px;
           }

           #battery-alert-modal {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.4);
               display: none;
               justify-content: center;
               align-items: center;
               z-index: 2000;
               opacity: 0;
               transition: opacity 0.3s ease;
           }

           #battery-alert-modal.visible {
               display: flex;
               opacity: 1;
           }

           .battery-alert-content {
               background-color: rgba(255, 255, 255, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               width: 280px;
               border-radius: 15px;
               box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
               text-align: center;
               padding: 20px;
               cursor: pointer;
               transform: scale(0.9);
               transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
           }

           #battery-alert-modal.visible .battery-alert-content {
               transform: scale(1);
           }

           #battery-alert-image {
               max-width: 100px;
               max-height: 100px;
               margin-bottom: 15px;
           }

           #battery-alert-text {
               font-size: 16px;
               font-weight: 500;
               color: #333;
               margin: 0;
               line-height: 1.4;
           }

           #font-preview {
               transition: font-family 0.3s ease;
           }

           #chat-list-screen {}

           .chat-list-view {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               display: flex;
               flex-direction: column;
               opacity: 0;
               visibility: hidden;
               transition: opacity 0.2s, visibility 0.2s;
               z-index: 1;
           }

           .chat-list-view.active {
               opacity: 1;
               visibility: visible;
               z-index: 2;
           }

           #messages-view {
               overflow-y: auto;
           }

           .nav-item {
               flex: 1;
               text-align: center;
               padding: 12px 0;
               font-size: 14px;
               color: var(--text-secondary);
               cursor: pointer;
               transition: color 0.2s;
           }

           .nav-item.active {
               color: var(--accent-color);
               font-weight: 600;
           }

           #qzone-screen {
               background-color: #f0f2f5;
           }

           .qzone-header {
               position: relative;
               z-index: 10;
               flex-shrink: 0;
               padding: 15px 20px;
               padding-top: 45px;
               background-color: rgba(247, 247, 247, 0.7);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-bottom: 1px solid var(--border-color);
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 18px;
               font-weight: 600;
               text-align: center;
           }

           .qzone-header .back-btn {
               font-size: 24px;
               cursor: pointer;
               color: var(--accent-color);
           }

           .qzone-header span:nth-child(2) {
               position: absolute;
               left: 50%;
               transform: translateX(-50%);
           }

           .qzone-content {
               flex-grow: 1;
               overflow-y: auto;
           }

           .qzone-profile-header {
               position: relative;
               margin-bottom: 20px;
           }

           .qzone-banner-container {
               width: 100%;
               height: 180px;
               position: relative;
           }

           #qzone-banner-img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           .qzone-user-info {
               position: absolute;
               bottom: -30px;
               left: 20px;
               display: flex;
               align-items: flex-end;
               gap: 10px;
           }

           .qzone-avatar-container {
               position: relative;
           }

           #qzone-avatar-img {
               width: 70px;
               height: 70px;
               border-radius: 50%;
               border: 3px solid white;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
               object-fit: cover;
           }

           #qzone-nickname {
               font-size: 18px;
               font-weight: 600;
               color: #fff;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
               padding-bottom: 5px;
           }

           .qzone-edit-btn {
               position: absolute;
               background-color: rgba(0, 0, 0, 0.4);
               color: white;
               border: none;
               border-radius: 10px;
               padding: 4px 8px;
               font-size: 12px;
               cursor: pointer;
               backdrop-filter: blur(5px);
               -webkit-backdrop-filter: blur(5px);
           }

           #change-qzone-banner-btn {
               bottom: 10px;
               right: 10px;
           }

           #change-qzone-avatar-btn {
               bottom: 5px;
               right: 5px;
           }

           #change-qzone-nickname-btn {
               font-size: 14px;
               padding: 2px 6px;
               margin-left: 5px;
               color: var(--text-primary);
               background-color: rgba(255, 255, 255, 0.7);
               border-radius: 5px;
               position: relative;
               bottom: 5px;
           }

           #qzone-banner-container,
           #qzone-avatar-container,
           #qzone-nickname {
               cursor: pointer;
               transition: opacity 0.2s;
           }

           #qzone-banner-container:hover,
           #qzone-avatar-container:hover,
           #qzone-nickname:hover {
               opacity: 0.85;
           }

           .qzone-edit-btn {
               display: none;
           }

           #qzone-screen .qzone-header {
               display: none;
           }

           #qzone-screen.active .qzone-header {
               display: flex;
           }

           #chat-list-screen.in-qzone-view>.header,
           #chat-list-screen.in-qzone-view>#chat-list-bottom-nav {
               display: none;
           }

           .chat-list-item:first-child,
           .chat-group-container:first-child {
               margin-top: 10px;
           }

           .qzone-actions-bar {
               display: flex;
               justify-content: space-around;
               padding: 10px 0;
               margin: 40px 15px 15px 15px;
               background-color: var(--secondary-bg);
               border-radius: 12px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
           }

           .action-item {
               flex: 1;
               text-align: center;
               font-size: 15px;
               font-weight: 500;
               color: var(--text-primary);
               cursor: pointer;
               padding: 8px 0;
               position: relative;
           }

           .action-item:not(:last-child)::after {
               content: '';
               position: absolute;
               right: 0;
               top: 50%;
               transform: translateY(-50%);
               width: 1px;
               height: 20px;
               background-color: var(--border-color);
           }

           #qzone-posts-list {
               padding: 0 15px 20px 15px;
               display: flex;
               flex-direction: column;
               gap: 20px;
           }

           .qzone-post-item {
               background-color: var(--secondary-bg);
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
           }

           .post-header {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-bottom: 12px;
           }

           .post-header .post-avatar {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               object-fit: cover;
           }

           .post-info {
               display: flex;
               flex-direction: column;
           }

           .post-info .post-nickname {
               font-weight: 600;
               font-size: 15px;
               color: var(--text-primary);
           }

           .post-info .post-timestamp {
               font-size: 12px;
               color: var(--text-secondary);
           }

           .post-content {
               font-size: 14px;
               line-height: 1.6;
               color: #333;
               white-space: pre-wrap;
               word-break: break-word;
           }

           #post-public-text {
               min-height: 80px;
               resize: vertical;
           }

           .post-image-preview-container {
               position: relative;
               width: 100%;
               aspect-ratio: 16 / 9;
               background-color: #f0f2f5;
               border: 2px dashed var(--border-color);
               border-radius: 8px;
               margin-bottom: 15px;
               display: none;
               justify-content: center;
               align-items: center;
           }

           .post-image-preview-container.visible {
               display: flex;
           }

           #post-image-preview {
               max-width: 100%;
               max-height: 100%;
               object-fit: contain;
               border-radius: 6px;
           }

           #post-remove-image-btn {
               position: absolute;
               top: -10px;
               right: -10px;
               width: 24px;
               height: 24px;
               border-radius: 50%;
               background-color: #ff3b30;
               color: white;
               border: 2px solid white;
               font-size: 16px;
               line-height: 20px;
               text-align: center;
               cursor: pointer;
               box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
           }

           .post-image-upload-options {
               display: flex;
               gap: 10px;
           }

           .post-image-upload-options button {
               flex: 1;
               margin-top: 0;
           }

           .post-mode-switcher {
               display: flex;
               margin-bottom: 20px;
               background-color: #e9ecef;
               border-radius: 8px;
               padding: 4px;
           }

           .mode-btn {
               flex: 1;
               padding: 8px;
               border: none;
               background-color: transparent;
               border-radius: 6px;
               font-size: 14px;
               font-weight: 500;
               color: var(--text-secondary);
               cursor: pointer;
               transition: all 0.2s ease-in-out;
           }

           .mode-btn.active {
               background-color: var(--secondary-bg);
               color: var(--text-primary);
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
           }

           .post-mode-content {
               display: none;
           }

           .post-mode-content.active {
               display: block;
           }

           #album-screen {
               background-color: #f0f2f5;
           }

           #album-grid-page {
               padding: 15px;
               display: grid;
               grid-template-columns: repeat(2, 1fr);
               gap: 15px;
           }

           .album-item {
               display: flex;
               flex-direction: column;
               cursor: pointer;
               transition: transform 0.2s ease, box-shadow 0.2s ease;
               border-radius: 8px;
           }

           .album-item:hover {
               transform: translateY(-5px);
               box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
           }

           .album-cover {
               aspect-ratio: 1 / 1;
               background-size: cover;
               background-position: center;
               border-radius: 8px;
               margin-bottom: 8px;
               background-color: #f0f2f5;
           }

           .album-info {
               text-align: center;
           }

           .album-name {
               font-weight: 500;
               margin: 0 0 4px 0;
               color: var(--text-primary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .album-count {
               font-size: 12px;
               color: var(--text-secondary);
               margin: 0;
           }

           #album-photos-screen {
               background-color: #f0f2f5;
           }

           #photos-grid-page {
               padding: 15px;
               display: grid;
               grid-template-columns: repeat(3, 1fr);
               gap: 10px;
           }

           .photo-item {
               position: relative;
               aspect-ratio: 1 / 1;
               border-radius: 6px;
               overflow: hidden;
               background-color: #e9ecef;
           }

           .photo-item .photo-thumb {
               width: 100%;
               height: 100%;
               object-fit: cover;
               cursor: pointer;
           }

           .photo-item .photo-delete-btn {
               position: absolute;
               top: 5px;
               right: 5px;
               width: 22px;
               height: 22px;
               background-color: rgba(0, 0, 0, 0.6);
               color: white;
               border: none;
               border-radius: 50%;
               font-size: 16px;
               line-height: 22px;
               text-align: center;
               cursor: pointer;
               opacity: 0;
               transition: opacity 0.2s ease;
           }

           .photo-item:hover .photo-delete-btn {
               opacity: 1;
           }

           #photo-viewer-modal {
               background-color: rgba(0, 0, 0, 0.85);
               z-index: 1002;
               -webkit-backdrop-filter: blur(5px);
               backdrop-filter: blur(5px);
           }

           .photo-viewer-content {
               display: flex;
               justify-content: center;
               align-items: center;
               width: 100%;
               height: 100%;
           }

           #photo-viewer-image {
               max-width: 90vw;
               max-height: 85vh;
               object-fit: contain;
               border-radius: 8px;
               box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
               transition: opacity 0.2s ease-in-out;
           }

           #photo-viewer-close-btn {
               position: absolute;
               top: 20px;
               right: 20px;
               background: none;
               border: none;
               color: white;
               font-size: 40px;
               font-weight: 200;
               cursor: pointer;
               line-height: 1;
               text-shadow: 0 0 5px black;
           }

           #photo-viewer-modal .nav-arrow {
               position: absolute;
               top: 50%;
               transform: translateY(-50%);
               background: none;
               border: none;
               color: rgba(255, 255, 255, 0.7);
               font-size: 50px;
               font-weight: 100;
               cursor: pointer;
               padding: 10px;
               -webkit-user-select: none;
               user-select: none;
               transition: color 0.2s;
               z-index: 1003;
           }

           #photo-viewer-prev-btn {
               left: 5px;
           }

           #photo-viewer-next-btn {
               right: 5px;
           }

           #photo-viewer-modal .nav-arrow:hover {
               color: white;
           }

           #photo-viewer-modal .nav-arrow:disabled {
               color: rgba(255, 255, 255, 0.2);
               cursor: default;
           }

           .post-main-content {}

           .post-feedback-icons {
               display: flex;
               justify-content: flex-end;
               align-items: center;
               gap: 12px;
               padding: 8px 0;
           }

           .action-icon {
               cursor: pointer;
               color: var(--text-secondary);
               transition: all 0.2s ease-in-out;
           }

           .action-icon svg {
               width: 22px;
               height: 22px;
               fill: none;
               stroke: currentColor;
               stroke-width: 2;
               stroke-linecap: round;
               stroke-linejoin: round;
           }

           .action-icon.active {
               color: #ff5252;
               transform: scale(1.1);
           }

           .action-icon.active.favorite {
               color: #ffc107;
           }

           .action-icon.active svg {
               fill: currentColor;
           }

           .animate-like {
               animation: like-bounce 0.4s ease-in-out;
           }

           @keyframes like-bounce {
               0% {
                   transform: scale(1);
               }

               25% {
                   transform: scale(0.8);
               }

               50% {
                   transform: scale(1.2);
               }

               75% {
                   transform: scale(1.05);
               }

               100% {
                   transform: scale(1.1);
               }
           }

           .post-footer {
               margin-top: 15px;
               padding-top: 10px;
               border-top: 1px solid #f0f0f0;
               display: flex;
               align-items: center;
               gap: 8px;
           }

           .comment-section {
               flex-grow: 1;
               display: flex;
               align-items: center;
               gap: 8px;
           }

           .comment-section .comment-avatar {
               width: 28px;
               height: 28px;
               border-radius: 50%;
               object-fit: cover;
               flex-shrink: 0;
           }

           .comment-section {
               position: relative;
           }

           .comment-section .comment-input {
               width: 100%;
               padding: 8px 12px;
               border: none;
               background-color: #f0f2f5;
               border-radius: 14px;
               font-size: 16px;
               outline: none;
           }

           .comment-send-btn {
               flex-shrink: 0;
               padding: 8px 15px;
               border: none;
               background-color: var(--accent-color);
               color: white;
               border-radius: 14px;
               font-size: 16px;
               font-weight: 500;
               cursor: pointer;
           }

           .unread-indicator {
               position: absolute;
               top: -8px;
               right: -15px;
               min-width: 18px;
               height: 18px;
               padding: 0 5px;
               background-color: #ff3b30;
               color: white;
               font-size: 11px;
               font-weight: bold;
               line-height: 18px;
               text-align: center;
               border-radius: 9px;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
               display: none;
               z-index: 1;
           }

           .back-btn-indicator {
               top: 0;
               right: -8px;
               width: 10px;
               height: 10px;
               min-width: 10px;
               padding: 0;
               border-radius: 50%;
           }

           .post-comments-container {
               padding: 10px 0;
               display: flex;
               flex-direction: column;
               gap: 8px;
               font-size: 13px;
           }

           .comment-item {
               line-height: 1.5;
           }

           .comment-item .commenter-name {
               font-weight: 600;
               color: var(--accent-color);
               cursor: pointer;
               margin-right: 5px;
           }

           .comment-item .comment-text {
               color: var(--text-primary);
               word-break: break-word;
           }

           .post-likes-section {
               display: flex;
               align-items: center;
               gap: 6px;
               padding: 8px 10px;
               font-size: 13px;
               color: var(--accent-color);
               background-color: #f0f5fa;
               border-top: 1px solid #e9eef3;
               border-bottom: 1px solid #e9eef3;
               margin-top: 5px;
           }

           .post-likes-section .like-icon {
               width: 16px;
               height: 16px;
               fill: currentColor;
               flex-shrink: 0;
           }

           .at-mention-popup {
               position: absolute;
               bottom: 100%;
               left: 40px;
               width: calc(100% - 40px);
               max-height: 120px;
               overflow-y: auto;
               background-color: var(--secondary-bg);
               border: 1px solid var(--border-color);
               border-radius: 8px;
               box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
               z-index: 10;
               display: none;
           }

           .at-mention-item {
               padding: 8px 12px;
               font-size: 14px;
               cursor: pointer;
               color: var(--text-primary);
               border-bottom: 1px solid #f0f0f0;
           }

           .at-mention-item:last-child {
               border-bottom: none;
           }

           .at-mention-item:hover {
               background-color: #f5f5f5;
           }

           #favorites-view {
               display: flex;
               flex-direction: column;
           }

           #favorites-view>.header {
               flex-shrink: 0;
           }

           #favorites-list {
               flex-grow: 1;
               overflow-y: auto;
               overflow-x: hidden;
               padding: 15px;
               display: flex;
               flex-direction: column;
               gap: 15px;
           }

           .favorite-item-card {
               background-color: var(--secondary-bg);
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
               position: relative;
           }

           .fav-card-header {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-bottom: 12px;
           }

           .fav-card-header .avatar {
               width: 36px;
               height: 36px;
               border-radius: 50%;
               object-fit: cover;
           }

           .fav-card-header .info {
               flex-grow: 1;
           }

           .fav-card-header .name {
               font-weight: 600;
               font-size: 15px;
           }

           .fav-card-header .source {
               font-size: 12px;
               color: var(--text-secondary);
           }

           .fav-card-content {
               font-size: 14px;
               line-height: 1.6;
               color: #333;
               white-space: pre-wrap;
               word-break: break-word;
           }

           .fav-card-content .chat-image {
               margin-top: 8px;
           }

           .fav-delete-btn {
               position: absolute;
               top: 10px;
               right: 10px;
               width: 28px;
               height: 28px;
               background: #f0f2f5;
               border: none;
               border-radius: 50%;
               cursor: pointer;
               font-size: 18px;
               color: var(--text-secondary);
               line-height: 28px;
               text-align: center;
           }

           .fav-delete-btn:hover {
               background-color: #e9ecef;
               color: #ff3b30;
           }

           .search-bar-container {
               padding: 10px 15px;
               background-color: #f9f9f9;
               position: relative;
               flex-shrink: 0;
           }

           #favorites-search-input {
               width: 100%;
               padding: 10px 30px 10px 15px;
               font-size: 16px;
               border: 1px solid var(--border-color);
               border-radius: 18px;
               background-color: var(--secondary-bg);
               box-sizing: border-box;
               outline: none;
           }

           #favorites-search-input:focus {
               border-color: var(--accent-color);
           }

           .search-clear-btn {
               position: absolute;
               right: 25px;
               top: 50%;
               transform: translateY(-50%);
               background: #ccc;
               color: white;
               border: none;
               border-radius: 50%;
               width: 20px;
               height: 20px;
               line-height: 20px;
               text-align: center;
               font-size: 16px;
               cursor: pointer;
           }

           #chat-interface-screen .header .selection-controls {
               display: flex;
               justify-content: space-between;
               align-items: center;
               width: 100%;
           }

           #chat-interface-screen .selection-controls .action-btn {
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               padding: 5px;
           }

           #favorites-view.selection-mode .favorite-item-card {
               transition: transform 0.2s ease, box-shadow 0.2s ease;
           }

           .favorite-item-card::before {
               content: '';
               position: absolute;
               left: -25px;
               top: 50%;
               transform: translateY(-50%);
               width: 20px;
               height: 20px;
               border: 2px solid #ccc;
               border-radius: 50%;
               background-color: white;
               transition: all 0.2s ease;
               opacity: 0;
           }

           #favorites-view.selection-mode .favorite-item-card {
               transform: translateX(35px);
           }

           #favorites-view.selection-mode .favorite-item-card::before {
               opacity: 1;
           }

           #favorites-view.selection-mode .favorite-item-card.selected::before {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
               content: '✔';
               color: white;
               font-size: 14px;
               text-align: center;
               line-height: 20px;
           }

           #favorites-action-bar {
               position: absolute;
               bottom: 0;
               left: 0;
               right: 0;
               width: auto;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               box-sizing: border-box;
               z-index: 5;
               display: none;
           }

           #favorites-action-bar .action-bar-btn {
               width: 100%;
               padding: 12px;
               border-radius: 8px;
               border: none;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
           }

           #chat-interface-screen .header .selection-controls {
               display: none;
           }

           #chat-interface-screen .header .default-controls {
               display: flex;
               justify-content: space-between;
               align-items: center;
               width: 100%;
           }

           #chat-interface-screen.selection-mode .header .default-controls {
               display: none;
           }

           #chat-interface-screen.selection-mode .header .selection-controls {
               display: flex;
               justify-content: space-between;
               align-items: center;
               width: 100%;
           }

           #add-chat-btn,
           #add-world-book-btn,
           #create-album-btn-page {
               font-size: 28px;
               font-weight: 300;
               position: relative;
               top: -1px;
           }

           #settings-preview-area {
               width: 100%;
               height: 180px;
               background-color: #f0f2f5;
               border-radius: 8px;
               padding: 15px;
               box-sizing: border-box;
               overflow: hidden;
               display: flex;
               flex-direction: column;
               gap: 10px;
               border: 1px solid var(--border-color);
               position: relative;
           }

           #settings-preview-area::before {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-size: cover;
               background-position: center;
               z-index: 1;
               opacity: 0.8;
           }

           #settings-preview-area .message-wrapper {
               position: relative;
               z-index: 2;
           }

           #settings-preview-area .message-bubble .avatar {
               width: 30px;
               height: 30px;
           }

           #settings-preview-area .message-bubble .timestamp {
               display: none;
           }

           .existing-group-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 12px;
               background-color: #f9f9f9;
               border-radius: 8px;
               border: 1px solid var(--border-color);
           }

           .existing-group-item .group-name {
               font-weight: 500;
           }

           .existing-group-item .delete-group-btn {
               color: #ff3b30;
               font-size: 20px;
               cursor: pointer;
               padding: 5px;
           }

           .chat-group-container {
               border-bottom: 1px solid var(--border-color);
           }

           .chat-group-container:first-child {
               border-top: 1px solid var(--border-color);
           }

           .chat-group-header {
               display: flex;
               align-items: center;
               padding: 12px 15px;
               cursor: pointer;
               background-color: #f7f7f7;
           }

           .chat-group-header .arrow {
               font-size: 14px;
               margin-right: 8px;
               transition: transform 0.2s ease;
           }

           .chat-group-header.collapsed .arrow {
               transform: rotate(-90deg);
           }

           .chat-group-header .group-name {
               font-weight: 600;
               font-size: 15px;
           }

           .chat-group-content {
               max-height: 1000px;
               overflow: hidden;
               transition: max-height 0.3s ease-in-out;
           }

           .chat-group-content.collapsed {
               max-height: 0;
           }

           .format-helpers {
               display: flex;
               gap: 10px;
               margin-bottom: 15px;
               flex-wrap: wrap;
           }

           .format-btn {
               background-color: #e9ecef;
               color: var(--text-primary);
               border: none;
               padding: 6px 12px;
               border-radius: 16px;
               font-size: 13px;
               font-weight: 500;
               cursor: pointer;
               transition: background-color 0.2s;
           }

           .format-btn:hover {
               background-color: #dcdfe3;
           }

           .post-actions-btn {
               margin-left: auto;
               padding: 5px 10px;
               font-size: 20px;
               font-weight: bold;
               color: var(--text-secondary);
               cursor: pointer;
               border-radius: 50%;
               line-height: 1;
           }

           .post-actions-btn:hover {
               background-color: #f0f0f0;
           }

           #post-actions-modal .custom-modal-footer button {
               width: 100%;
               border: none;
               border-bottom: 1px solid #dbdbdb;
               padding: 14px;
               font-size: 18px;
           }

           #post-actions-modal .custom-modal-footer button:last-child {
               border-bottom: none;
           }

           #post-actions-modal #cancel-post-action-btn {
               margin-top: 8px;
               border-radius: 8px;
               background-color: #f0f0f0;
           }

           #chat-messages .transfer-card .transfer-title,
           #chat-messages .transfer-card .transfer-amount,
           #chat-messages .transfer-card .transfer-note {
               text-shadow: none !important;
               color: white !important;
           }

           #chat-messages .transfer-card .transfer-title {
               font-size: 16px !important;
               font-weight: 600 !important;
           }

           #chat-messages .transfer-card .transfer-amount {
               font-size: 28px !important;
               font-weight: bold !important;
           }

           #chat-messages .transfer-card .transfer-note {
               font-size: 13px !important;
               opacity: 0.9 !important;
           }

           .header>span:nth-child(2),
           #chat-header-title {
               position: absolute;
               left: 50%;
               transform: translateX(calc(-50% - 2px));
               max-width: 60%;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           #message-editor-container {
               display: flex;
               flex-direction: column;
               gap: 15px;
           }

           .message-editor-block {
               background-color: #f9f9f9;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               padding: 12px;
           }

           .message-editor-block textarea {
               width: 100%;
               min-height: 60px;
               resize: vertical;
               border: 1px solid #ccc;
               border-radius: 6px;
               padding: 8px;
               font-size: 16px;
               box-sizing: border-box;
           }

           .message-editor-block .format-helpers {
               margin-top: 8px;
               margin-bottom: 0;
           }

           .message-editor-block .delete-block-btn {
               float: right;
               margin-top: -5px;
               background: none;
               border: none;
               color: #ff3b30;
               font-size: 20px;
               cursor: pointer;
           }

           .contact-picker-item {
               display: flex;
               align-items: center;
               padding: 10px 15px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
           }

           .contact-picker-item .checkbox {
               width: 20px;
               height: 20px;
               border: 2px solid #ccc;
               border-radius: 50%;
               margin-right: 15px;
               transition: all 0.2s ease;
           }

           .contact-picker-item.selected .checkbox {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
               content: '✔';
               color: white;
               font-size: 14px;
               text-align: center;
               line-height: 20px;
           }

           .contact-picker-item .avatar {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               margin-right: 12px;
           }

           .contact-picker-item .name {
               font-weight: 500;
           }

           #member-management-list {
               padding: 0;
           }

           .member-management-item {
               display: flex;
               align-items: center;
               padding: 12px 15px;
               border-bottom: 1px solid var(--border-color);
           }

           .member-management-item .avatar {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               margin-right: 12px;
           }

           .member-management-item .name {
               flex-grow: 1;
               font-weight: 500;
           }

           .member-management-item .remove-member-btn {
               background-color: #ff3b30;
               color: white;
               border: none;
               width: 28px;
               height: 28px;
               border-radius: 50%;
               font-size: 20px;
               line-height: 28px;
               text-align: center;
               cursor: pointer;
               flex-shrink: 0;
           }

           #member-management-actions {
               flex-shrink: 0;
               padding: 15px;
               border-top: 1px solid var(--border-color);
               background-color: #f7f7f7;
               display: flex;
               flex-direction: column;
               gap: 10px;
           }

           #member-management-actions button {
               width: 100%;
               padding: 15px;
               background-color: var(--accent-color);
               color: white;
               border: none;
               border-radius: 8px;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
           }

           #member-management-actions #create-new-member-btn {
               background-color: #4cd964;
           }

           .waimai-card {
               width: 240px;
               border-radius: 12px;
               overflow: hidden;
               background-color: var(--secondary-bg);
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
           }

           .waimai-header {
               display: flex;
               align-items: center;
               gap: 8px;
               padding: 10px 12px;
               border-bottom: 1px solid #f0f0f0;
           }

           .waimai-header .icon {
               width: 20px;
               height: 20px;
           }

           .waimai-header .title-group {
               display: flex;
               align-items: baseline;
               font-size: 14px;
               color: #8a8a8a;
           }

           .waimai-header .title-group .brand {
               font-weight: 600;
               color: #555;
               margin-right: 5px;
           }

           .waimai-header .title-group .separator {
               margin: 0 5px;
           }

           .waimai-catchphrase {
               font-size: 13px;
               color: #1f1f1f;
               padding: 12px;
           }

           .waimai-main {
               background-color: #FFD66B;
               padding: 12px;
               text-align: center;
           }

           .waimai-main .request-title {
               font-size: 12px;
               color: #856404;
               margin-bottom: 8px;
           }

           .waimai-main .payment-box {
               background-color: var(--secondary-bg);
               border-radius: 8px;
               padding: 15px 10px;
           }

           .waimai-main .payment-label {
               font-size: 13px;
               color: #8a8a8a;
           }

           .waimai-main .amount {
               font-size: 32px;
               font-weight: 700;
               color: #1f1f1f;
               margin: 4px 0 12px 0;
           }

           .waimai-main .countdown-label {
               font-size: 13px;
               color: #8a8a8a;
           }

           .waimai-main .countdown-timer {
               display: inline-flex;
               align-items: center;
               gap: 2px;
               margin-left: 5px;
           }

           .waimai-main .countdown-timer span {
               background-color: #333;
               color: white;
               padding: 2px 4px;
               border-radius: 2px;
               font-weight: bold;
               font-size: 12px;
           }

           .waimai-details-btn {
               width: 100%;
               padding: 10px 0;
               margin-top: 15px;
               border: none;
               border-radius: 6px;
               background-color: #FFC33A;
               color: #49380a;
               font-size: 14px;
               font-weight: 600;
               cursor: pointer;
           }

           .message-bubble.status-paid .waimai-card {
               border: 2px solid #28a745;
           }

           .message-bubble.status-paid .waimai-main .request-title::before {
               content: '✅  ';
           }

           .message-bubble.status-paid .waimai-main .request-title {
               color: #155724;
               font-weight: 600;
               content: "我已为您买单，请尽情享用吧～" !important;
               display: block;
               margin-bottom: 15px;
           }

           .message-bubble.status-paid .payment-box {
               display: none;
           }

           .message-bubble.status-paid .waimai-details-btn {
               background-color: #28a745;
               color: white;
           }

           .message-bubble.status-rejected .waimai-card {
               border: 2px solid #dc3545;
               opacity: 0.8;
           }

           .message-bubble.status-rejected .waimai-main {
               background-color: #e9ecef;
           }

           .message-bubble.status-rejected .waimai-main .request-title::before {
               content: '❌ ';
           }

           .message-bubble.status-rejected .waimai-main .request-title {
               color: #721c24;
               font-weight: 600;
               content: "我拒绝了您的代付请求" !important;
               display: block;
               margin-bottom: 15px;
           }

           .message-bubble.status-rejected .payment-box {
               display: none;
           }

           .message-bubble.status-rejected .waimai-details-btn {
               background-color: #6c757d;
               color: white;
           }

           .message-bubble[class*="status-"] .request-title {
               font-size: 0;
           }

           .message-bubble[class*="status-"] .request-title::after {
               font-size: 14px;
           }

           .message-bubble.status-paid .request-title::after {
               content: "我已为您买单，请尽情享用吧～";
           }

           .message-bubble.status-rejected .request-title::after {
               content: "我拒绝了您的代付请求";
           }

           .waimai-user-actions {
               display: flex;
               gap: 10px;
               padding: 0 12px 12px 12px;
               background-color: var(--secondary-bg);
           }

           .waimai-user-actions button {
               flex: 1;
               padding: 10px;
               border-radius: 8px;
               border: 1.5px solid;
               font-size: 14px;
               font-weight: 600;
               cursor: pointer;
               transition: all 0.2s ease;
           }

           .waimai-pay-btn {
               background-color: #28a745;
               border-color: #1f7a33;
               color: white;
           }

           .waimai-pay-btn:hover {
               background-color: #218838;
           }

           .waimai-decline-btn {
               background-color: #f8f9fa;
               border-color: #ced4da;
               color: #495057;
           }

           .waimai-decline-btn:hover {
               background-color: #e2e6ea;
           }

           #api-settings-screen,
           #font-settings-screen,
           #wallpaper-screen,
           #memories-view,
           #contact-picker-screen,
           #member-management-screen,
           #world-book-editor-screen {
               background-color: var(--secondary-bg);
           }

           #api-settings-screen .form-container,
           #font-settings-screen .form-container,
           #wallpaper-screen .form-container {
               padding-top: 100px;
               margin-top: -80px;
               background-color: var(--secondary-bg);
           }

           #wallpaper-screen .form-container {
               align-items: center;
           }

           #incoming-call-modal .incoming-call-content {
               background-color: rgba(40, 40, 40, 0.85);
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border-radius: 20px;
               width: 280px;
               padding: 30px 20px;
               text-align: center;
               color: white;
               box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
           }

           .caller-avatar {
               width: 80px;
               height: 80px;
               border-radius: 50%;
               object-fit: cover;
               margin-bottom: 12px;
               border: 3px solid rgba(255, 255, 255, 0.5);
           }

           .caller-name {
               font-size: 20px;
               font-weight: 600;
               margin-bottom: 5px;
           }

           .caller-text {
               font-size: 14px;
               color: #ccc;
               margin-bottom: 30px;
           }

           .incoming-call-actions {
               display: flex;
               justify-content: space-around;
               align-items: center;
           }

           .action-button-wrapper {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
               font-size: 13px;
               color: #e0e0e0;
           }

           .call-action-btn {
               width: 60px;
               height: 60px;
               border-radius: 50%;
               border: none;
               cursor: pointer;
               background-size: 50%;
               background-repeat: no-repeat;
               background-position: center;
               transition: transform 0.2s, box-shadow 0.2s;
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
           }

           .call-action-btn:active {
               transform: scale(0.9);
           }

           .call-action-btn.decline {
               background-color: #ff3b30;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13.5 16.5L3 6m18 6l-5.6-5.6a1.2 1.2 0 0 0-1.7 0L3 18.2a1.2 1.2 0 0 0-.3 1.2l1.2 3.6a1.2 1.2 0 0 0 1.2.9h15.6a1.2 1.2 0 0 0 1.2-1.2V7.7a1.2 1.2 0 0 0-.3-1.1z"/></svg>');
           }

           .call-action-btn.accept {
               background-color: #4cd964;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>');
               animation: pulse 1.5s infinite;
           }

           @keyframes pulse {
               0% {
                   box-shadow: 0 0 0 0 rgba(76, 217, 100, 0.7);
               }

               70% {
                   box-shadow: 0 0 0 15px rgba(76, 217, 100, 0);
               }

               100% {
                   box-shadow: 0 0 0 0 rgba(76, 217, 100, 0);
               }
           }

           #video-call-screen {
               background-color: #1c1c1e;
               color: white;
               display: flex;
               flex-direction: column;
               overflow: hidden;
           }

           .video-call-top-bar {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               padding: 15px 20px;
               padding-top: 50px;
               background: linear-gradient(to bottom, rgba(0, 0, 0, 0.5), transparent);
               z-index: 100;
               text-align: center;
               box-sizing: border-box;
               pointer-events: none;
           }

           #call-timer {
               font-size: 16px;
               font-weight: 500;
               letter-spacing: 1px;
           }

           .video-call-controls {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               display: flex;
               justify-content: space-around;
               align-items: center;
               padding: 20px;
               padding-bottom: 40px;
               background: linear-gradient(to top, rgba(0, 0, 0, 0.5), transparent);
               z-index: 100;
               box-sizing: border-box;
           }

           .video-call-avatar-area {
               flex-grow: 1;
               display: flex;
               justify-content: center;
               align-items: center;
               padding: 20px;
               padding-top: 80px;
               box-sizing: border-box;
               overflow-y: auto;
           }

           #participant-avatars-grid {
               display: flex;
               flex-wrap: wrap;
               justify-content: center;
               align-items: center;
               gap: 15px;
               max-width: 100%;
           }

           .participant-avatar-wrapper {
               position: relative;
               text-align: center;
               flex-shrink: 0;
           }

           .participant-avatar {
               width: 70px;
               height: 70px;
               border-radius: 50%;
               object-fit: cover;
               border: 3px solid rgba(255, 255, 255, 0.2);
               transition: all 0.3s ease;
           }

           .participant-name {
               margin-top: 8px;
               font-size: 12px;
               color: #ccc;
           }

           .participant-avatar.speaking {
               border-color: #4cd964;
               box-shadow: 0 0 20px rgba(76, 217, 100, 0.6);
               transform: scale(1.05);
           }

           /* 视频通话优化 - 视频显示区域 */
           #video-display-area {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               z-index: 1;
           }

           .video-large-screen {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: #000;
               overflow: hidden;
           }

           .video-large-screen img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           .video-small-screen {
               position: absolute;
               top: 80px;
               right: 20px;
               width: 100px;
               height: 140px;
               background-color: #000;
               border-radius: 12px;
               overflow: hidden;
               border: 2px solid rgba(255, 255, 255, 0.3);
               cursor: pointer;
               z-index: 101;
               transition: all 0.3s ease;
           }

           .video-small-screen:hover {
               border-color: rgba(255, 255, 255, 0.6);
               transform: scale(1.05);
           }

           .video-small-screen img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           #video-call-main {
               position: absolute;
               bottom: 140px;
               left: 15px;
               right: 15px;
               max-height: 30%;
               overflow-y: auto;
               padding: 15px;
               background-color: rgba(0, 0, 0, 0.6);
               border-radius: 20px;
               display: flex;
               flex-direction: column;
               gap: 15px;
               box-sizing: border-box;
               z-index: 50;
               backdrop-filter: blur(10px);
           }

           .control-btn {
               width: 70px;
               height: 70px;
               border-radius: 50%;
               border: none;
               cursor: pointer;
               background-repeat: no-repeat;
               background-position: center;
               transition: transform 0.2s, background-color 0.2s;
           }

           .control-btn:active {
               transform: scale(0.9);
           }

           .control-btn.speak-btn {
               background-color: rgba(255, 255, 255, 0.2);
               background-size: 55%;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>');
           }

           .control-btn.hangup-btn {
               background-color: #ff3b30;
               background-size: 50%;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13.5 16.5L3 6m18 6l-5.6-5.6a1.2 1.2 0 0 0-1.7 0L3 18.2a1.2 1.2 0 0 0-.3 1.2l1.2 3.6a1.2 1.2 0 0 0 1.2.9h15.6a1.2 1.2 0 0 0 1.2-1.2V7.7a1.2 1.2 0 0 0-.3-1.1z"/></svg>');
           }

           .control-btn.join-btn {
               background-color: #007bff;
               background-size: 50%;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="17" y1="11" x2="23" y2="11"></line></svg>');
           }

           .call-message-bubble {
               padding: 10px 15px;
               border-radius: 12px;
               max-width: 85%;
               line-height: 1.6;
               word-break: break-word;
               white-space: pre-wrap;
           }

           .call-message-bubble.ai-speech {
               background-color: rgba(255, 255, 255, 0.15);
               align-self: flex-start;
           }

           .call-message-bubble.user-speech {
               background-color: #4cd964;
               align-self: flex-end;
               text-align: left;
           }

           #outgoing-call-screen {
               background-color: #1c1c1e;
               color: white;
               justify-content: center;
           }

           /* 语音通话样式 */
           #voice-call-screen {
               background-color: #1c1c1e;
               color: white;
               display: flex;
               flex-direction: column;
               overflow: hidden;
           }

           .voice-call-top-bar {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               padding: 15px 20px;
               padding-top: 50px;
               background: linear-gradient(to bottom, rgba(0, 0, 0, 0.5), transparent);
               z-index: 100;
               text-align: center;
               box-sizing: border-box;
               pointer-events: none;
           }

           #voice-call-timer {
               font-size: 16px;
               font-weight: 500;
               letter-spacing: 1px;
           }

           .voice-call-controls {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               display: flex;
               justify-content: space-around;
               align-items: center;
               padding: 20px;
               padding-bottom: 40px;
               background: linear-gradient(to top, rgba(0, 0, 0, 0.5), transparent);
               z-index: 100;
               box-sizing: border-box;
           }

           .voice-call-avatar-area {
               flex-grow: 1;
               display: flex;
               justify-content: center;
               align-items: center;
               padding: 20px;
               padding-top: 80px;
               box-sizing: border-box;
               overflow-y: auto;
           }

           #voice-participant-avatars-grid {
               display: flex;
               flex-wrap: wrap;
               justify-content: center;
               align-items: center;
               gap: 15px;
               max-width: 100%;
           }

           #voice-call-main {
               position: absolute;
               bottom: 140px;
               left: 15px;
               right: 15px;
               max-height: 30%;
               overflow-y: auto;
               padding: 15px;
               background-color: rgba(0, 0, 0, 0.6);
               border-radius: 20px;
               display: flex;
               flex-direction: column;
               gap: 15px;
               box-sizing: border-box;
               z-index: 50;
               backdrop-filter: blur(10px);
           }

           .voice-call-top-bar #minimize-voice-call-btn {
               position: absolute;
               left: 20px;
               top: 50px;
               width: 36px;
               height: 36px;
               border-radius: 50%;
               background-color: rgba(255, 255, 255, 0.2);
               border: none;
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: all 0.3s ease;
               opacity: 0.7;
               pointer-events: auto;
           }

           .voice-call-top-bar #minimize-voice-call-btn:hover {
               opacity: 1;
           }

           #voice-call-restore-btn {
               position: absolute;
               top: 120px;
               right: 20px;
               width: 60px;
               height: 60px;
               border-radius: 50%;
               background-color: #1c1c1e;
               border: 2px solid rgba(255, 255, 255, 0.3);
               cursor: pointer;
               display: none;
               align-items: center;
               justify-content: center;
               z-index: 1000;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
               transition: all 0.3s ease;
           }

           #voice-call-restore-btn:hover {
               transform: scale(1.1);
               border-color: rgba(255, 255, 255, 0.6);
           }

           #voice-call-restore-btn svg {
               width: 30px;
               height: 30px;
               stroke: white;
           }

           .outgoing-call-content {
               display: flex;
               flex-direction: column;
               align-items: center;
               text-align: center;
           }

           .outgoing-call-actions {
               margin-top: 50px;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
               font-size: 13px;
               color: #e0e0e0;
           }

           .qzone-post-container {
               position: relative;
               overflow: hidden;
               border-radius: 12px;
           }

           .qzone-post-item {
               transition: transform 0.3s ease;
               background-color: var(--secondary-bg);
               position: relative;
               z-index: 2;
           }

           .qzone-post-delete-action {
               position: absolute;
               top: 0;
               right: 0;
               bottom: 0;
               width: 90px;
               background-color: #ff3b30;
               color: white;
               display: flex;
               align-items: center;
               justify-content: center;
               font-weight: 500;
               cursor: pointer;
               z-index: 1;
           }

           .qzone-post-item.swiped {
               transform: translateX(-90px);
           }

           @keyframes pat-shake {

               0%,
               100% {
                   transform: translateX(0);
               }

               10%,
               30%,
               50%,
               70%,
               90% {
                   transform: translateX(-3px);
               }

               20%,
               40%,
               60%,
               80% {
                   transform: translateX(3px);
               }
           }

           .pat-animation {
               animation: pat-shake 0.4s ease-in-out;
           }

           .system-message {
               align-self: center;
               padding: 4px 12px;
               margin: 5px 0;
               background-color: rgba(0, 0, 0, 0.1);
               color: var(--text-secondary);
               font-size: 12px;
               border-radius: 10px;
               text-align: center;
               max-width: 80%;
           }

           .message-wrapper.system-pat {
               justify-content: center;
               align-self: center;
               margin: 5px 0;
               max-width: 80%;
           }

           .message-bubble.system-bubble {
               background-color: rgba(0, 0, 0, 0.1);
               color: var(--text-secondary);
               font-size: 12px;
               padding: 4px 12px;
               border-radius: 10px;
           }

           #chat-input-actions-top {
               display: flex;
               gap: 8px;
               padding: 0 5px;
               overflow-x: auto;
               flex-wrap: nowrap;
               -webkit-overflow-scrolling: touch;
               scrollbar-width: none;
               -ms-overflow-style: none;
           }

           #chat-input-actions-top::-webkit-scrollbar {
               display: none;
           }

           #chat-header-title-wrapper {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 2px;
               position: absolute;
               left: 50%;
               transform: translateX(-50%);
               max-width: 60%;
           }

           #chat-header-title {
               font-size: 16px;
               font-weight: 600;
               position: static;
               transform: none;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               max-width: 100%;
           }

           #chat-header-status {
               display: flex;
               align-items: center;
               gap: 5px;
               font-size: 11px;
               color: var(--text-secondary);
               transition: all 0.3s ease;
           }

           .status-dot {
               width: 7px;
               height: 7px;
               border-radius: 50%;
               background-color: #4cd964;
               transition: background-color 0.3s ease;
           }

           #chat-header-status.busy .status-dot {
               background-color: #cccccc;
           }

           .status-text {
               font-weight: 500;
           }

           .memory-card {
               background-color: #fffaf0;
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 2px 6px rgba(0, 0, 0, 0.07);
               border-left: 5px solid #ffb74d;
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .memory-card .header {
               border-bottom: 1px solid rgba(217, 129, 0, 0.15);
               padding-bottom: 8px;
           }

           .memory-card .header .date {
               font-size: 11px;
               color: #a1887f;
               margin-bottom: 4px;
           }

           .memory-card .header .author {
               font-weight: 600;
               color: #d98100;
               font-size: 15px;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .memory-card .content {
               font-size: 14px;
               line-height: 1.7;
               color: #5d4037;
               white-space: pre-wrap;
           }

           .countdown-card {
               background: linear-gradient(135deg, #667eea, #764ba2);
               color: white;
               border-radius: 12px;
               padding: 20px;
               box-shadow: 0 4px 15px rgba(118, 75, 162, 0.4);
               text-align: center;
               position: relative;
               overflow: hidden;
               flex-shrink: 0;
           }

           .countdown-card::before {
               content: '✨';
               position: absolute;
               top: -10px;
               left: -10px;
               font-size: 50px;
               opacity: 0.1;
               transform: rotate(-15deg);
           }

           .countdown-card .title {
               font-size: 18px;
               font-weight: 600;
               margin-bottom: 15px;
           }

           .countdown-card .timer {
               font-size: 28px;
               font-weight: 300;
               letter-spacing: 2px;
               margin-bottom: 15px;
           }

           .countdown-card .target-date {
               font-size: 12px;
               opacity: 0.8;
               border-top: 1px solid rgba(255, 255, 255, 0.2);
               padding-top: 10px;
           }

           #chat-lock-overlay {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               z-index: 150;
               display: none;
               align-items: center;
               justify-content: center;
               padding: 20px;
               box-sizing: border-box;
               border-top: 1px solid var(--border-color);
               text-align: center;
           }

           #chat-lock-content {
               display: flex;
               flex-direction: column;
               gap: 15px;
           }

           #chat-lock-content .lock-text {
               color: var(--text-secondary);
               font-size: 14px;
           }

           #chat-lock-content .lock-action-btn {
               padding: 10px 20px;
               border-radius: 20px;
               border: 1px solid var(--accent-color);
               background-color: var(--accent-color);
               color: white;
               cursor: pointer;
           }

           #chat-lock-content .lock-action-btn.secondary {
               background-color: transparent;
               color: var(--accent-color);
           }

           .red-packet-card {
               width: 220px;
               border-radius: 8px;
               background: linear-gradient(160deg, #F96259, #E44D44);
               color: #ffd700;
               padding: 12px;
               cursor: pointer;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
               position: relative;
               overflow: hidden;
           }

           .red-packet-card.opened {
               background: linear-gradient(160deg, #d3c4a0, #c4b693);
               cursor: default;
           }

           .red-packet-card::before {
               content: '🧧';
               position: absolute;
               top: -5px;
               left: -5px;
               font-size: 30px;
               opacity: 0.2;
               transform: rotate(-10deg);
           }

           .rp-header {
               display: flex;
               align-items: center;
               gap: 8px;
               margin-bottom: 8px;
           }

           .rp-icon {
               width: 20px;
               height: 20px;
           }

           .rp-greeting {
               font-size: 15px;
               font-weight: 500;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .rp-type {
               font-size: 11px;
               color: white;
               opacity: 0.8;
               border-top: 1px solid rgba(255, 255, 255, 0.2);
               padding-top: 8px;
               margin-top: 8px;
           }

           .rp-claimed-info {
               font-size: 13px;
               color: white;
               margin-top: 10px;
               padding-top: 10px;
               border-top: 1px solid rgba(255, 255, 255, 0.3);
           }

           .rp-details-item {
               display: flex;
               align-items: center;
               padding: 8px 0;
               border-bottom: 1px solid #eee;
           }

           .rp-details-item:last-child {
               border-bottom: none;
           }

           .rp-details-item .name {
               flex-grow: 1;
               font-weight: 500;
               color: #333;
           }

           .rp-details-item .amount {
               font-weight: 500;
               color: #555;
           }

           .rp-details-item .lucky-king-tag {
               font-size: 10px;
               background-color: #ffd700;
               color: #a67c00;
               padding: 2px 5px;
               border-radius: 4px;
               margin-left: 8px;
               font-weight: bold;
           }

           .poll-card {
               width: 250px;
               background-color: #f9f9f9;
               border-radius: 10px;
               border: 1px solid #e0e0e0;
               padding: 12px;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
           }

           .poll-card.closed {
               background-color: #e9ecef;
           }

           .poll-question {
               font-weight: 600;
               font-size: 15px;
               margin-bottom: 12px;
               line-height: 1.4;
               word-break: break-word;
           }

           .poll-options-list {
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .poll-option-item {
               background-color: white;
               border: 1px solid #dcdcdc;
               border-radius: 8px;
               padding: 10px;
               cursor: pointer;
               position: relative;
               overflow: hidden;
               transition: background-color 0.2s;
           }

           .poll-card:not(.closed) .poll-option-item:hover {
               background-color: #f0f8ff;
           }

           .poll-option-item.voted {
               border-color: var(--accent-color);
               background-color: #e7f3ff;
               font-weight: 500;
           }

           .poll-option-bar {
               position: absolute;
               top: 0;
               left: 0;
               height: 100%;
               background-color: rgba(0, 123, 255, 0.1);
               z-index: 1;
               transition: width 0.3s ease-in-out;
           }

           .poll-option-content {
               position: relative;
               z-index: 2;
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .poll-option-text {
               font-size: 14px;
           }

           .poll-option-votes {
               font-size: 13px;
               color: #8a8a8a;
               font-weight: 500;
           }

           .poll-footer {
               margin-top: 12px;
               padding-top: 8px;
               border-top: 1px solid #e9e9e9;
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 12px;
               color: var(--text-secondary);
           }

           .poll-total-votes {
               font-weight: 500;
           }

           .poll-action-btn {
               background: none;
               border: 1px solid var(--accent-color);
               color: var(--accent-color);
               padding: 4px 10px;
               border-radius: 15px;
               cursor: pointer;
               font-size: 12px;
           }

           .poll-card.closed .poll-action-btn {
               background-color: #6c757d;
               color: white;
               border-color: #6c757d;
           }

           .poll-option-input-wrapper {
               display: flex;
               align-items: center;
               gap: 8px;
           }

           .poll-option-input-wrapper input {
               flex-grow: 1;
           }

           .poll-option-input-wrapper .remove-option-btn {
               width: 28px;
               height: 28px;
               border-radius: 50%;
               background-color: #f0f0f0;
               color: #ff3b30;
               border: none;
               cursor: pointer;
               font-size: 18px;
               line-height: 28px;
               text-align: center;
               flex-shrink: 0;
           }

           #chat-header-title.typing-status {
               color: var(--text-secondary);
               animation: typing-pulse 1.5s infinite;
               font-style: italic;
           }

           @keyframes typing-pulse {

               0%,
               100% {
                   opacity: 1;
               }

               50% {
                   opacity: 0.6;
               }
           }

           #chat-header-title {
               transition: opacity 0.2s ease-in-out;
           }

           @keyframes message-pop-in {
               from {
                   opacity: 0;
                   transform: translateY(15px);
               }

               to {
                   opacity: 1;
                   transform: translateY(0);
               }
           }

           .message-wrapper.animate-in {
               animation: message-pop-in 0.3s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
           }

           #icon-settings-grid,
           #cphone-icon-settings-grid {
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
               gap: 20px;
               width: 100%;
               padding: 0 10px;
               box-sizing: border-box;
           }

           .icon-setting-item {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
           }

           .icon-preview {
               width: 60px;
               height: 60px;
               border-radius: 15px;
               background-size: cover;
               background-position: center;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
           }

           .change-icon-btn {
               padding: 4px 10px;
               font-size: 12px;
               border: 1px solid #ccc;
               background-color: #f0f0f0;
               border-radius: 5px;
               cursor: pointer;
           }

           #wallpaper-screen .form-container {
               min-height: 0;
           }

           #wallpaper-preview {
               flex-shrink: 0;
           }

           #browser-screen {
               background-color: #f8f9fa;
           }

           #browser-content {
               padding: 20px;
               font-size: 16px;
               line-height: 1.8;
               color: #333;
               overflow-y: auto;
               background-color: #f8f9fa;
           }

           #browser-content .article-title {
               font-size: 24px;
               font-weight: 700;
               margin-bottom: 10px;
           }

           #browser-content .article-meta {
               font-size: 13px;
               color: #8a8a8a;
               margin-bottom: 25px;
               padding-bottom: 15px;
               border-bottom: 1px solid #e0e0e0;
           }

           #browser-content .article-body {
               white-space: pre-wrap;
               word-break: break-word;
           }

           #browser-content .article-body p {
               margin-bottom: 1em;
           }

           .link-share-card {
               width: 210px;
               background-color: var(--secondary-bg);
               border-radius: 10px;
               border: 1px solid #e0e0e0;
               padding: 12px;
               cursor: pointer;
               transition: background-color 0.2s;
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .link-share-card:hover {
               background-color: #f9f9f9;
           }

           .link-share-card .title {
               font-weight: 600;
               font-size: 15px;
               line-height: 1.4;
               color: #1f1f1f;
               display: -webkit-box;
               -webkit-line-clamp: 2;
               -webkit-box-orient: vertical;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .link-share-card .description {
               font-size: 13px;
               color: #8a8a8a;
               display: -webkit-box;
               -webkit-line-clamp: 3;
               -webkit-box-orient: vertical;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .link-share-card .footer {
               display: flex;
               align-items: center;
               gap: 6px;
               font-size: 12px;
               color: var(--text-secondary);
               margin-top: 4px;
           }

           .link-share-card .footer-icon {
               width: 14px;
               height: 14px;
               flex-shrink: 0;
           }

           .comment-item {
               position: relative;
               padding-right: 25px;
           }

           .comment-delete-btn {
               position: absolute;
               top: 50%;
               right: 0;
               transform: translateY(-50%);
               width: 22px;
               height: 22px;
               line-height: 22px;
               text-align: center;
               border-radius: 50%;
               color: var(--text-secondary);
               font-size: 18px;
               cursor: pointer;
               transition: all 0.2s ease;
               opacity: 0;
           }

           .comment-item:hover .comment-delete-btn {
               opacity: 1;
           }

           .comment-delete-btn:hover {
               background-color: #f0f0f0;
               color: #ff3b30;
           }

           #phone-screen.dark-mode {
               --secondary-bg: #1c1c1e;
               --border-color: #38383a;
               --text-primary: #ffffff;
               --text-secondary: #8d8d92;
           }

           #phone-screen.dark-mode #chat-list-screen,
           #phone-screen.dark-mode #qzone-screen .qzone-content,
           #phone-screen.dark-mode #memories-view {
               background-color: #000000;
           }

           #phone-screen.dark-mode #chat-list {
               background-color: #000000;
           }

           #phone-screen.dark-mode .chat-list-item {
               border-bottom-color: rgba(255, 255, 255, 0.15);
           }

           #phone-screen.dark-mode .chat-group-header {
               background-color: #1c1c1e;
               border-bottom: 1px solid #38383a;
           }

           #phone-screen.dark-mode .chat-list-item .name,
           #phone-screen.dark-mode .chat-group-header .group-name {
               color: #ffffff;
           }

           #phone-screen.dark-mode .chat-list-item:hover {
               background-color: #1c1c1e;
           }

           #phone-screen.dark-mode .header,
           #phone-screen.dark-mode .qzone-header {
               background-color: rgba(25, 25, 25, 0.9);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border-bottom-color: rgba(255, 255, 255, 0.15);
               color: #ffffff;
           }

           #phone-screen.dark-mode .header .back-btn,
           #phone-screen.dark-mode .header .action-btn,
           #phone-screen.dark-mode .header .save-btn {
               color: #ffffff;
           }

           #phone-screen.dark-mode #chat-list-bottom-nav {
               background-color: rgba(25, 25, 25, 0.9);
               border-top-color: rgba(255, 255, 255, 0.15);
           }

           #phone-screen.dark-mode .nav-item.active {
               color: #ffffff;
           }

           #phone-screen.dark-mode #chat-input-area {
               background-color: rgba(5, 5, 5, 0.8);
               border-top: none;
           }

           #phone-screen.dark-mode #chat-input {
               background-color: #3e3e42;
               color: #ffffff;
           }

           #phone-screen.dark-mode #chat-input::placeholder {
               color: #8d8d92;
           }

           #phone-screen.dark-mode .chat-action-icon-btn {
               color: #ffffff;
               background-color: rgba(255, 255, 255, 0.1);
               border: none;
           }

           #phone-screen.dark-mode #send-btn {
               background-color: var(--accent-color);
           }

           #phone-screen.dark-mode .qzone-actions-bar,
           #phone-screen.dark-mode .qzone-post-item {
               background-color: #1c1c1e;
               border: 1px solid #333;
               box-shadow: 0 2px 8px rgba(255, 255, 255, 0.05);
           }

           #phone-screen.dark-mode .action-item:not(:last-child)::after {
               background-color: #333;
           }

           #phone-screen.dark-mode .post-footer,
           #phone-screen.dark-mode .post-likes-section {
               border-top-color: #333;
           }

           #phone-screen.dark-mode .post-likes-section {
               background-color: rgba(0, 123, 255, 0.1);
           }

           #phone-screen.dark-mode .comment-input {
               background-color: #333;
               color: #ffffff;
           }

           #phone-screen.dark-mode .comment-input::placeholder {
               color: #8d8d92;
           }

           #phone-screen.dark-mode .post-actions-btn:hover {
               background-color: #333;
           }

           #phone-screen.dark-mode .at-mention-popup {
               background-color: #1c1c1e;
               border-color: #333;
           }

           #phone-screen.dark-mode .at-mention-item {
               border-bottom-color: #333;
           }

           #phone-screen.dark-mode .at-mention-item:hover {
               background-color: #333;
           }

           #phone-screen.dark-mode .memory-card {
               background-color: #1c1c1e;
               border-left-color: #e6a753;
               box-shadow: 0 4px 12px rgba(255, 255, 255, 0.08);
           }

           #phone-screen.dark-mode .memory-card .header {
               background-color: #2c2c2e;
               border-bottom-color: #38383a;
               margin: -15px -15px 8px -15px;
               padding: 12px 15px;
               border-radius: 12px 12px 0 0;
           }

           #phone-screen.dark-mode .memory-card .header .date,
           #phone-screen.dark-mode .memory-card .header .author,
           #phone-screen.dark-mode .memory-card .content {
               color: #e0e0e0;
           }

           #phone-screen.dark-mode #api-settings-screen,
           #phone-screen.dark-mode #font-settings-screen,
           #phone-screen.dark-mode #wallpaper-screen,
           #phone-screen.dark-mode #contact-picker-screen,
           #phone-screen.dark-mode #member-management-screen,
           #phone-screen.dark-mode #world-book-editor-screen,
           #phone-screen.dark-mode #world-book-list,
           #phone-screen.dark-mode .list-item:hover,
           #phone-screen.dark-mode .list-container,
           #phone-screen.dark-mode .form-container {
               background-color: #000000;
           }

           #phone-screen.dark-mode .form-group input,
           #phone-screen.dark-mode .form-group select,
           #phone-screen.dark-mode .form-group textarea {
               background-color: #1c1c1e;
               color: #ffffff;
               border-color: #38383a;
           }

           #phone-screen.dark-mode .form-button-secondary {
               background-color: #333;
               border-color: #555;
               color: #fff;
           }

           #phone-screen.dark-mode #font-preview {
               background-color: #1c1c1e;
               border-color: #38383a;
           }

           #phone-screen.dark-mode #font-preview p {
               color: #ffffff;
           }

           #phone-screen.dark-mode .qzone-post-item .post-nickname,
           #phone-screen.dark-mode .qzone-post-item .post-content {
               color: #f0f0f0;
           }

           #phone-screen.dark-mode .favorite-item-card .fav-card-header .name,
           #phone-screen.dark-mode .favorite-item-card .fav-card-content {
               color: #f0f0f0;
           }

           #phone-screen.dark-mode .favorite-item-card .fav-card-header .source {
               color: #8d8d92;
           }

           #phone-screen.dark-mode .search-bar-container {
               background-color: #000000;
           }

           #phone-screen.dark-mode #favorites-search-input {
               background-color: #1c1c1e;
               border-color: #38383a;
               color: #ffffff;
           }

           #phone-screen.dark-mode #favorites-search-input::placeholder {
               color: #8d8d92;
           }

           .toggle-switch {
               position: relative;
               display: inline-block;
               width: 51px;
               height: 31px;
           }

           .toggle-switch input {
               opacity: 0;
               width: 0;
               height: 0;
           }

           .slider {
               position: absolute;
               cursor: pointer;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;
               background-color: #e9e9eb;
               transition: .4s;
               border-radius: 34px;
           }

           .slider:before {
               position: absolute;
               content: "";
               height: 27px;
               width: 27px;
               left: 2px;
               bottom: 2px;
               background-color: white;
               transition: .4s;
               border-radius: 50%;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
           }

           input:checked+.slider {
               background-color: #34c759;
           }

           input:checked+.slider:before {
               transform: translateX(20px);
           }

           #reply-preview-bar {
               display: none;
               padding: 8px 12px;
               margin: 0 8px 8px 8px;
               background-color: rgba(0, 0, 0, 0.05);
               border-left: 3px solid var(--accent-color);
               border-radius: 6px;
               position: relative;
               font-size: 13px;
               color: var(--text-secondary);
           }

           #phone-screen.dark-mode #reply-preview-bar {
               background-color: rgba(255, 255, 255, 0.1);
           }

           .reply-preview-content .sender {
               font-weight: 600;
               color: var(--text-primary);
           }

           .reply-preview-content .text {
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               display: block;
               max-width: 95%;
           }

           #cancel-reply-btn {
               position: absolute;
               top: 50%;
               right: 8px;
               transform: translateY(-50%);
               width: 20px;
               height: 20px;
               line-height: 20px;
               text-align: center;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.1);
               cursor: pointer;
               font-size: 14px;
           }

           .quoted-message {
               padding: 6px 10px;
               margin-bottom: 6px;
               background-color: rgba(0, 0, 0, 0.04);
               border-left: 2px solid var(--accent-color);
               border-radius: 4px;
               font-size: 0.9em;
               opacity: 0.8;
           }

           #phone-screen.dark-mode .quoted-message {
               background-color: rgba(255, 255, 255, 0.08);
               border-left-color: #a0cff1;
           }

           .quoted-message .quoted-sender {
               font-weight: 600;
               color: var(--accent-color);
           }

           #phone-screen.dark-mode .quoted-message .quoted-sender {
               color: #a0cff1;
           }

           .quoted-message .quoted-content {
               color: var(--text-secondary);
               white-space: normal;
               word-break: break-word;
               display: block;
           }

           #font-preview {
               padding: 20px;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               background-color: #f9f9f9;
               transition: background-color 0.3s, border-color 0.3s;
           }

           #font-preview p {
               color: var(--text-primary);
           }

           #phone-screen.dark-mode #font-preview {
               background-color: #1c1c1e;
               border-color: #38383a;
           }

           #phone-screen.dark-mode #font-preview p {
               color: #ffffff;
           }

           /* 字体应用范围 */
           .font-scope-container {
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .font-scope-item {
               display: flex;
               align-items: center;
               gap: 10px;
               padding: 10px 12px;
               border-radius: 8px;
               background: var(--secondary-bg, #f5f5f5);
               cursor: pointer;
               transition: background 0.2s;
               user-select: none;
           }

           .font-scope-item:active {
               background: var(--border-color, #e0e0e0);
           }

           .font-scope-item input[type="checkbox"] {
               width: 18px;
               height: 18px;
               accent-color: #007aff;
               flex-shrink: 0;
           }

           .font-scope-item span {
               font-size: 14px;
               color: var(--text-primary);
           }

           .font-scope-all {
               border-bottom: 1px solid var(--border-color, #eee);
               padding-bottom: 12px;
               margin-bottom: 4px;
               border-radius: 8px 8px 0 0;
           }

           .font-scope-list {
               display: flex;
               flex-direction: column;
               gap: 6px;
               padding-left: 8px;
           }

           #phone-screen.dark-mode .font-scope-item {
               background: #2c2c2e;
           }

           #phone-screen.dark-mode .font-scope-item:active {
               background: #3a3a3c;
           }

           .transfer-actions-content {
               background-color: #fff0f5;
               border-radius: 20px;
               width: 290px;
               padding: 20px;
               box-shadow: 0 5px 25px rgba(255, 105, 180, 0.3);
               text-align: center;
               position: relative;
               border: 1px solid #ffcce0;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
           }

           .transfer-actions-header {
               font-size: 20px;
               font-weight: bold;
               color: #a35c7b;
               margin-bottom: 15px;
           }

           .transfer-actions-body p {
               font-size: 15px;
               color: #555;
               margin: 0 0 25px 0;
               line-height: 1.5;
           }

           .transfer-actions-footer {
               display: flex;
               justify-content: space-between;
               gap: 15px;
           }

           .transfer-actions-footer .action-btn {
               flex: 1;
               padding: 12px;
               border: none;
               border-radius: 12px;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               transition: transform 0.2s, box-shadow 0.2s;
               color: white;
           }

           .transfer-actions-footer .action-btn:active {
               transform: scale(0.95);
           }

           .transfer-actions-footer .action-btn.accept {
               background: linear-gradient(135deg, #ff85b3, #ff69b4);
               box-shadow: 0 4px 10px rgba(255, 105, 180, 0.4);
           }

           .transfer-actions-footer .action-btn.decline {
               background: linear-gradient(135deg, #c2c2c2, #a0a0a0);
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
           }

           .transfer-actions-content .cancel-btn {
               position: absolute;
               top: 10px;
               right: 10px;
               width: 28px;
               height: 28px;
               border-radius: 50%;
               border: none;
               background-color: rgba(0, 0, 0, 0.1);
               color: #a35c7b;
               font-size: 20px;
               line-height: 28px;
               cursor: pointer;
           }

           .unread-count-wrapper {
               flex-shrink: 0;
               width: 40px;
               display: flex;
               justify-content: center;
               align-items: flex-start;
               padding-top: 20px;
           }

           .unread-count {
               min-width: 20px;
               height: 20px;
               padding: 0 6px;
               background-color: #ff3b30;
               color: white;
               font-size: 13px;
               font-weight: 500;
               line-height: 20px;
               text-align: center;
               border-radius: 10px;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
               display: none;
               justify-content: center;
               align-items: center;
           }

           #call-history-screen {
               background-color: #f0f2f5;
           }

           .call-record-card {
               background-color: var(--secondary-bg);
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
               cursor: pointer;
               transition: transform 0.2s ease, box-shadow 0.2s ease;
               border-left: 5px solid var(--accent-color);
           }

           .call-record-card:hover {
               transform: translateY(-3px);
               box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
           }

           .call-record-card .card-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 13px;
               color: var(--text-secondary);
               margin-bottom: 12px;
               padding-bottom: 8px;
               border-bottom: 1px solid var(--border-color);
           }

           .call-record-card .card-header .duration {
               font-weight: 500;
               color: var(--text-primary);
           }

           .call-record-card .card-body {
               display: flex;
               align-items: center;
           }

           .call-record-card .participants-avatars {
               display: flex;
               align-items: center;
           }

           .call-record-card .participant-avatar {
               width: 36px;
               height: 36px;
               border-radius: 50%;
               object-fit: cover;
               border: 2px solid white;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
           }

           .call-record-card .participant-avatar:not(:first-child) {
               margin-left: -12px;
           }

           .call-record-card .participants-names {
               margin-left: 12px;
               font-weight: 600;
               color: var(--text-primary);
               font-size: 15px;
           }

           #transcript-modal-body {
               display: flex;
               flex-direction: column;
               gap: 12px;
               padding: 15px;
           }

           .transcript-entry {
               padding: 8px 12px;
               border-radius: 10px;
               max-width: 85%;
               line-height: 1.5;
               word-break: break-word;
           }

           .transcript-entry.user {
               background-color: #dcf8c6;
               align-self: flex-end;
           }

           .transcript-entry.assistant {
               background-color: #ffffff;
               align-self: flex-start;
           }

           #chat-list-title {
               cursor: pointer;
           }

           .call-record-card .card-body {
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .call-record-card .custom-title {
               font-size: 16px;
               font-weight: 600;
               color: var(--text-primary);
               padding-bottom: 8px;
               border-bottom: 1px solid var(--border-color);
               margin-bottom: 4px;
           }

           .call-record-card .participants-info {
               display: flex;
               align-items: center;
           }

           .call-record-card .participants-names {
               margin-left: 12px;
               font-weight: 500;
               font-size: 14px;
               color: var(--text-secondary);
           }

           .voice-transcript {
               font-size: 14px;
               line-height: 1.6;
               color: var(--text-secondary);
               padding: 8px 12px;
               margin-top: 6px;
               background-color: rgba(0, 0, 0, 0.04);
               border-radius: 6px;
               word-break: break-word;
               display: none;
           }

           #phone-screen.dark-mode .voice-transcript {
               background-color: rgba(255, 255, 255, 0.1);
           }

           .loading-spinner {
               display: none;
               width: 16px;
               height: 16px;
               border: 2px solid rgba(0, 0, 0, 0.2);
               border-top-color: var(--accent-color);
               border-radius: 50%;
               animation: spin 1s linear infinite;
               margin: 0 8px;
           }

           @keyframes spin {
               to {
                   transform: rotate(360deg);
               }
           }

           #shared-history-viewer-content {
               display: flex;
               flex-direction: column;
               gap: 20px;
               padding: 15px;
           }

           #music-player-overlay {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               z-index: 50;
               display: flex;
               justify-content: center;
               align-items: flex-start;
               padding-top: 60px;
               background-color: rgba(0, 0, 0, 0.3);
               opacity: 0;
               visibility: hidden;
               transform: translateY(-50px);
               transition: opacity 0.4s ease-out, transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
           }

           #music-player-overlay.visible {
               opacity: 1;
               visibility: visible;
               transform: translateY(0);
           }

           .music-player-window {
               width: 70%;
               min-height: 420px;
               background-color: rgba(255, 255, 255, 0.6);
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border-radius: 25px;
               box-shadow: 0 8px 32px 0 rgba(25, 25, 25, 0.37);
               border: 1px solid rgba(255, 255, 255, 0.18);
               padding: 25px;
               display: flex;
               flex-direction: column;
               align-items: center;
               color: #1f1f1f;
               position: relative;
               justify-content: space-between;
               padding-bottom: 15px;
           }

           .music-player-top-actions {
               position: absolute;
               top: 15px;
               left: 15px;
               right: 15px;
               width: calc(100% - 30px);
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .top-left-cluster {
               display: flex;
               align-items: center;
               gap: 15px;
           }

           #music-return-btn,
           #music-exit-btn {
               background: none;
               border: none;
               font-size: 28px;
               font-weight: 300;
               cursor: pointer;
               color: #555;
               padding: 5px;
               line-height: 1;
           }

           #music-exit-btn {
               font-size: 24px;
               font-weight: 400;
           }

           .music-progress-bar-container {
               width: 100%;
               display: flex;
               align-items: center;
               gap: 10px;
               margin-top: 25px;
               margin-bottom: 10px;
           }

           .time-display {
               font-size: 11px;
               color: #888;
               width: 35px;
               text-align: center;
               flex-shrink: 0;
               font-family: 'SF Mono', 'Menlo', monospace;
           }

           .progress-bar {
               flex-grow: 1;
               height: 5px;
               background-color: #e5e5e5;
               border-radius: 2.5px;
               cursor: pointer;
           }

           .progress-bar-fill {
               width: 0%;
               height: 100%;
               background-color: #333;
               border-radius: 2.5px;
           }

           #music-lyrics-container {
               width: 100%;
               height: 192px;
               overflow: hidden;
               position: relative;
               -webkit-mask-image: linear-gradient(transparent, black 20%, black 80%, transparent);
               mask-image: linear-gradient(transparent, black 20%, black 80%, transparent);
           }

           #music-lyrics-list {
               display: flex;
               flex-direction: column;
               align-items: center;
               transition: transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
           }

           .lyric-line {
               padding: 4px 0;
               font-size: 14px;
               color: #666;
               text-align: center;
               line-height: 1.5;
               transition: all 0.5s ease;
               opacity: 0.7;
               transform: scale(0.95);
           }

           .lyric-line.active {
               font-size: 16px;
               color: #000;
               opacity: 1;
               transform: scale(1);
           }

           .music-player-controls-wrapper {
               width: 100%;
               display: flex;
               flex-direction: column;
               gap: 10px;
           }

           .music-controls {
               margin-top: 0;
           }

           #music-return-btn,
           #music-exit-btn,
           #music-playlist-btn {
               position: relative;
           }

           #music-return-btn {
               top: -2px;
           }

           #music-playlist-btn {
               top: -3px;
           }

           .playlist-item-actions {
               display: flex;
               align-items: center;
               gap: 15px;
           }

           .playlist-action-btn {
               font-size: 18px;
               color: #888;
               cursor: pointer;
               transition: color 0.2s;
           }

           .playlist-action-btn:hover {
               color: #000;
           }

           .delete-track-btn {
               font-size: 24px;
               color: #ff3b30;
           }

           .delete-track-btn:hover {
               color: #c00;
           }

           .lyrics-btn {
               font-weight: 500;
           }

           .message-bubble .avatar {
               width: 34px;
               height: 34px;
               border-radius: 20%;
               object-fit: cover;
               flex-shrink: 0;
           }

           .recalled-message-placeholder {
               align-self: center;
               padding: 4px 12px;
               margin: 5px 0;
               background-color: rgba(0, 0, 0, 0.1);
               color: var(--text-secondary);
               font-size: 12px;
               border-radius: 10px;
               text-align: center;
               max-width: 80%;
               cursor: pointer;
           }

           #phone-screen.dark-mode .recalled-message-placeholder {
               background-color: rgba(255, 255, 255, 0.15);
           }

           @keyframes recall-animation {
               from {
                   opacity: 1;
                   transform: scale(1);
               }

               to {
                   opacity: 0;
                   transform: scale(0.8);
               }
           }

           .message-wrapper.recalled-animation {
               animation: recall-animation 0.3s ease-out forwards;
           }

           .recalled-message-placeholder {
               white-space: nowrap;
               display: inline-block;
               padding: 4px 12px;
           }

           .world-book-group-container {
               border-bottom: 1px solid var(--border-color);
           }

           .world-book-group-container:first-child {
               border-top: 1px solid var(--border-color);
           }

           .world-book-group-header {
               display: flex;
               align-items: center;
               padding: 12px 15px;
               cursor: pointer;
               background-color: #f7f7f7;
           }

           .world-book-group-header .arrow {
               font-size: 14px;
               margin-right: 8px;
               transition: transform 0.2s ease;
           }

           .world-book-group-header.collapsed .arrow {
               transform: rotate(-90deg);
           }

           .world-book-group-header .group-name {
               font-weight: 600;
               font-size: 15px;
           }

           .world-book-group-content {
               max-height: 1000px;
               overflow: hidden;
               transition: max-height 0.3s ease-in-out;
           }

           .world-book-group-content.collapsed {
               max-height: 0;
           }

           #phone-screen.dark-mode .world-book-group-header {
               background-color: #1c1c1e;
           }

           .chat-list-item.pinned {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode .chat-list-item.pinned {
               background-color: #2c2c2e;
           }

           #chat-input-area {
               display: flex;
               flex-direction: column;
               flex-shrink: 0;
               background-color: var(--secondary-bg);
           }

           #chat-input-actions-top {
               flex-shrink: 0;
               padding-bottom: 8px;
           }

           #chat-input-main-row {
               flex-shrink: 0;
           }

           #chat-input-area {
               position: relative;
               z-index: 20;
               flex-shrink: 0;
               padding: 8px;
               background-color: rgba(247, 247, 247, 0.8);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               display: flex;
               flex-direction: column;
               gap: 5px;
           }

           #chat-at-mention-popup {
               bottom: 100%;
               left: 8px;
               right: 8px;
               width: auto;
               margin-bottom: 5px;
           }

           #announcement-board-modal .modal-content {
               height: 70%;
               background-color: #f0f2f5;
           }

           #announcement-board-content {
               padding: 15px;
               flex-grow: 1;
               overflow-y: auto;
               display: flex;
               flex-direction: column;
               gap: 15px;
           }

           #announcement-board-content .message-wrapper {
               max-width: 100%;
               align-self: center;
           }

           #announcement-board-content .timestamp {
               display: none;
           }

           .announcement-item-wrapper {
               position: relative;
               padding: 10px;
               background-color: white;
               border-radius: 12px;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
           }

           .announcement-item-actions {
               position: absolute;
               top: 15px;
               right: 15px;
               font-size: 20px;
               font-weight: bold;
               color: var(--text-secondary);
               cursor: pointer;
               padding: 5px;
               line-height: 1;
               border-radius: 50%;
           }

           .announcement-item-actions:hover {
               background-color: #f0f0f0;
           }

           .pinned-indicator {
               position: absolute;
               top: -8px;
               left: -8px;
               width: 28px;
               height: 28px;
               background-color: #ffc107;
               color: white;
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 16px;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
               border: 2px solid white;
           }

           .reposted-content-wrapper {
               background-color: #f7f7f8;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               padding: 10px;
               margin-top: 10px;
           }

           #phone-screen.dark-mode .reposted-content-wrapper {
               background-color: #2c2c2e;
               border-color: #38383a;
           }

           .reposted-content-wrapper .post-footer,
           .reposted-content-wrapper .post-feedback-icons,
           .reposted-content-wrapper .post-likes-section {
               display: none;
           }

           .reposted-content-wrapper .post-header {
               margin-bottom: 8px;
           }

           .reposted-content-wrapper .post-avatar {
               width: 32px;
               height: 32px;
           }

           .reposted-content-wrapper .post-nickname {
               font-size: 14px;
           }

           .location-share-card {
               width: 230px;
               border-radius: 10px;
               overflow: hidden;
               background-color: var(--secondary-bg);
               border: 1px solid #f0f0f0;
               box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
               cursor: pointer;
           }

           .card-text-area {
               padding: 12px;
               border-bottom: 1px solid #f0f0f0;
           }

           .card-text-primary {
               font-size: 16px;
               font-weight: 600;
               color: #222;
               margin-bottom: 4px;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .card-text-secondary {
               font-size: 12px;
               color: #a0a0a0;
           }

           .card-map-area {
               height: 100px;
               display: flex;
               justify-content: center;
               align-items: center;
               background-size: cover;
               background-position: center;
               background-color: #FFF0F5;
           }

           .message-bubble.user .location-share-card .card-map-area {
               background-color: #F0FFF8;
           }

           .card-pin-icon {
               font-size: 40px;
               color: #FF6B6B;
               text-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
           }

           @keyframes breathing-light {
               0% {
                   box-shadow: 0 0 6px rgba(0, 123, 255, 0.4);
               }

               50% {
                   box-shadow: 0 0 18px 4px rgba(0, 123, 255, 0.8);
               }

               100% {
                   box-shadow: 0 0 6px rgba(0, 123, 255, 0.4);
               }
           }

           .chat-list-item .avatar.is-acting {
               animation: breathing-light 2s ease-in-out infinite;
               border: 1.5px solid rgba(0, 123, 255, 0.7);
           }

           .comment-sticker-btn {
               background: none;
               border: none;
               padding: 5px;
               cursor: pointer;
               color: var(--text-secondary);
               transition: all 0.2s ease-in-out;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .comment-sticker-btn:hover {
               color: var(--text-primary);
           }

           .comment-sticker-btn svg {
               width: 22px;
               height: 22px;
               fill: none;
               stroke: currentColor;
               stroke-width: 2;
               stroke-linecap: round;
               stroke-linejoin: round;
           }

           #qzone-sticker-panel {
               position: absolute;
               width: 280px;
               height: 200px;
               background-color: rgba(255, 255, 255, 0.95);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border: 1px solid var(--border-color);
               border-radius: 12px;
               box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
               z-index: 1010;
               display: none;
               flex-direction: column;
               overflow: hidden;
           }

           #qzone-sticker-grid {
               flex-grow: 1;
               overflow-y: auto;
               padding: 10px;
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
               gap: 10px;
           }

           #qzone-sticker-grid .sticker-item {
               position: relative;
               aspect-ratio: 1 / 1;
               background-color: white;
               border-radius: 8px;
               background-size: contain;
               background-repeat: no-repeat;
               background-position: center;
               cursor: pointer;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
           }

           .comment-text .comment-sticker {
               max-width: 100px;
               max-height: 100px;
               display: block;
               background-color: transparent;
           }

           .comment-item .comment-text:has(.comment-sticker) {
               line-height: 1;
           }

           .change-frame-btn {
               padding: 6px 10px;
               border: 1px solid #ccc;
               background-color: #f0f0f0;
               border-radius: 5px;
               cursor: pointer;
               font-size: 13px;
               margin-left: 10px;
           }

           #avatar-frame-modal .modal-content {
               height: 70%;
           }

           #avatar-frame-modal .modal-body {
               padding: 0;
               display: flex;
               flex-direction: column;
           }

           .frame-tabs {
               display: flex;
               border-bottom: 1px solid var(--border-color);
               flex-shrink: 0;
           }

           .frame-tab {
               flex: 1;
               padding: 12px;
               text-align: center;
               font-weight: 500;
               cursor: pointer;
               color: var(--text-secondary);
               border-bottom: 2px solid transparent;
           }

           .frame-tab.active {
               color: var(--accent-color);
               border-bottom-color: var(--accent-color);
           }

           .frame-content {
               flex-grow: 1;
               overflow-y: auto;
               padding: 15px;
           }

           .frame-grid {
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
               gap: 15px;
           }

           .frame-item {
               aspect-ratio: 1 / 1;
               border: 2px solid transparent;
               border-radius: 10px;
               cursor: pointer;
               background-color: #f0f0f0;
               background-size: cover;
               background-position: center;
               padding: 5px;
               transition: all 0.2s ease;
               position: relative;
           }

           .frame-item.selected {
               border-color: var(--accent-color);
               transform: scale(1.05);
           }

           .frame-item .preview-avatar {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
           }

           .frame-item .preview-frame {
               position: absolute;
               top: -7px;
               left: 0;
               width: 100%;
               height: 100%;
           }

           .avatar-group {
               width: 34px;
               flex-shrink: 0;
               position: relative;
               transition: width 0.2s ease;
           }

           .avatar-group.has-frame {
               width: 34px;
           }

           .message-bubble .avatar {
               width: 34px;
               height: 34px;
               border-radius: 20%;
               object-fit: cover;
           }

           .avatar-with-frame {
               position: relative;
               width: 38px;
               height: 38px;
               margin: 0 auto;
               transition: all 0.2s ease;
           }

           .avatar-group.has-frame .avatar-with-frame {
               width: 43px;
               height: 43px;
           }

           .avatar-with-frame .avatar-img {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
               z-index: 1;
           }

           .avatar-with-frame .avatar-frame {
               position: absolute;
               width: 120%;
               height: 120%;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
               z-index: 2;
               pointer-events: none;
           }

           .message-bubble {
               flex: 1;
               min-width: 0;
               display: flex;
               align-items: flex-start;
               gap: 12px;
               max-width: 100%;
           }

           .message-bubble.user {
               flex-direction: row-reverse;
           }

           .message-bubble .content {
               flex: 1;
               min-width: 0;
               overflow-wrap: break-word;
               word-wrap: break-word;
               position: relative;
               font-size: var(--chat-font-size, 16px);
               padding: 8px 12px;
               line-height: 1.5;
           }

           .message-bubble .avatar-group {
               flex-shrink: 0 !important;
           }

           #chat-interface-screen .message-bubble .avatar-group.has-frame .avatar-with-frame {
               width: 34px !important;
               height: 34px !important;
           }

           #chat-interface-screen .message-bubble .avatar-with-frame .avatar-img {
               width: 100% !important;
               height: 100% !important;
           }

           .message-bubble.is-link-share .content,
           .message-bubble.is-transfer .content,
           .message-bubble.is-waimai-request .content,
           .message-bubble.is-red-packet .content,
           .message-bubble.is-poll .content,
           .message-bubble.is-location-share .content,
           .message-bubble.is-sticker .content,
           .message-bubble.is-ai-image .content {
               display: flex;
               justify-content: center;
               align-items: center;
           }

           #chat-list-screen .avatar-frame {
               display: none;
           }

           #chat-list-screen .avatar-group {
               width: 45px;
               height: 45px;
           }

           #chat-list-screen .avatar-group.has-frame .avatar-with-frame,
           #chat-list-screen .avatar-group.has-frame .avatar-img {
               width: 45px;
               height: 45px;
           }

           #chat-list-screen .avatar-img,
           #chat-list-screen .avatar {
               border-radius: 50%;
           }

           #chat-list .chat-list-item .avatar-group {
               margin-right: 15px !important;
           }

           #chat-list .chat-list-item .avatar {
               margin-right: 0;
           }

           .comment-item {
               cursor: pointer;
               transition: background-color 0.2s;
               display: flex;
               justify-content: space-between;
               align-items: flex-start;
               gap: 8px;
               padding: 4px 6px;
               margin: 0 -6px;
               border-radius: 4px;
           }

           .comment-item:hover {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode .comment-item:hover {
               background-color: #2c2c2e;
           }

           .comment-item .comment-text {
               flex-grow: 1;
               word-break: break-word;
           }

           .legacy-comment-item {
               line-height: 1.5;
               padding: 4px 6px;
               color: var(--text-secondary);
           }

           .message-bubble.is-link-share .content,
           .message-bubble.is-transfer .content,
           .message-bubble.is-waimai-request .content,
           .message-bubble.is-red-packet .content,
           .message-bubble.is-poll .content,
           .message-bubble.is-location-share .content,
           .message-bubble.is-sticker .content,
           .message-bubble.is-ai-image .content {
               display: flex;
               justify-content: center;
               align-items: center;
           }

           #chat-interface-screen .message-bubble .avatar-group.has-frame .avatar-with-frame {
               width: 34px !important;
               height: 34px !important;
           }

           #chat-interface-screen .message-bubble .avatar-with-frame .avatar-img {
               width: 100% !important;
               height: 100% !important;
           }

           .message-bubble.is-sticker,
           .message-bubble.is-voice-message,
           .message-bubble.is-transfer,
           .message-bubble.is-ai-image,
           .message-bubble.is-waimai-request,
           .message-bubble.is-red-packet,
           .message-bubble.is-poll,
           .message-bubble.is-link-share,
           .message-bubble.is-location-share {
               flex: initial;
               min-width: auto;
           }

           .message-bubble.is-sticker .content,
           .message-bubble.is-voice-message .content,
           .message-bubble.is-transfer .content,
           .message-bubble.is-ai-image .content,
           .message-bubble.is-waimai-request .content,
           .message-bubble.is-red-packet .content,
           .message-bubble.is-poll .content,
           .message-bubble.is-link-share .content,
           .message-bubble.is-location-share .content {
               flex: initial;
               padding: 0;
               background: transparent;
               box-shadow: none;
               border: none;
               backdrop-filter: none;
               -webkit-backdrop-filter: none;
           }

           #announcement-board-content .message-wrapper {
               align-self: flex-start !important;
           }

           #announcement-board-content .message-bubble.user {
               flex-direction: row !important;
           }

           #announcement-board-content .message-wrapper.user {
               flex-direction: row !important;
           }

           #chat-interface-screen>.header {
               position: absolute !important;
               top: 0;
               left: 0;
               width: 100%;
               z-index: 100 !important;
           }

           #chat-interface-screen #chat-messages {
               margin-top: 0 !important;
           }

           #music-player-overlay {
               z-index: 200 !important;
           }

           #chat-interface-screen {
               position: relative !important;
               height: 100%;
               width: 100%;
               overflow: hidden;
           }

           #chat-interface-screen>.header {
               position: absolute !important;
               top: 0;
               left: 0;
               right: 0;
               width: auto !important;
               z-index: 100 !important;
           }

           #chat-interface-screen #chat-input-area {
               position: absolute !important;
               bottom: 0;
               left: 0;
               right: 0;
               width: auto !important;
               z-index: 100 !important;
               padding-bottom: calc(8px + env(safe-area-inset-bottom));
           }

           #chat-interface-screen #chat-messages {
               height: 100% !important;
               width: 100% !important;
               overflow-y: auto !important;
               box-sizing: border-box !important;
               margin-top: 0 !important;
               padding-top: calc(120px + env(safe-area-inset-top)) !important;
               padding-bottom: calc(120px + env(safe-area-inset-bottom)) !important;
           }

           .post-deleted-placeholder {
               align-self: center;
               padding: 4px 12px;
               margin: 5px 0;
               background-color: rgba(0, 0, 0, 0.1);
               color: var(--text-secondary);
               font-size: 12px;
               border-radius: 10px;
               text-align: center;
               max-width: 80%;
               cursor: pointer;
           }

           #phone-screen.dark-mode .post-deleted-placeholder {
               background-color: rgba(255, 255, 255, 0.15);
           }

           .spoiler {
               background-color: #333;
               color: #333;
               padding: 0 4px;
               border-radius: 4px;
               cursor: pointer;
               transition: all 0.2s ease-in-out;
           }

           .spoiler:hover,
           .spoiler:active {
               background-color: #e0e0e0;
               color: inherit;
           }

           .memory-action-btn {
               background: none;
               border: none;
               cursor: pointer;
               padding: 5px;
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: background-color 0.2s;
           }

           .memory-action-btn svg {
               width: 18px;
               height: 18px;
               stroke: var(--text-secondary);
               transition: stroke 0.2s;
           }

           .memory-action-btn:hover {
               background-color: #e9ecef;
           }

           #phone-screen.dark-mode .memory-action-btn:hover {
               background-color: #38383a;
           }

           .memory-action-btn.edit-memory-btn:hover svg {
               stroke: var(--accent-color);
           }

           .memory-action-btn.delete-memory-btn:hover svg {
               stroke: #ff3b30;
           }

           #sticker-grid.management-mode .sticker-item::after {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               border: 3px solid transparent;
               border-radius: 10px;
               box-sizing: border-box;
               transition: border-color 0.2s;
           }

           #sticker-grid.management-mode .sticker-item.selected::after {
               border-color: var(--accent-color);
           }

           #sticker-grid.management-mode .sticker-item .delete-btn {
               display: block;
               background-color: rgba(0, 0, 0, 0.5);
               color: white;
               border: 1px solid white;
           }

           #sticker-action-bar {
               display: none;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
           }

           #sticker-action-bar button {
               width: 100%;
               padding: 12px;
               border-radius: 8px;
               border: none;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
           }

           #ai-response-editor-container {
               display: flex;
               flex-direction: column;
               gap: 15px;
           }

           .ai-response-editor-block {
               background-color: #f9f9f9;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               padding: 12px;
           }

           .ai-response-editor-block textarea {
               width: 100%;
               min-height: 80px;
               resize: vertical;
               border: 1px solid #ccc;
               border-radius: 6px;
               padding: 8px;
               font-size: 14px;
               font-family: monospace;
               box-sizing: border-box;
           }

           .ai-response-editor-block .format-helpers {
               margin-top: 8px;
               margin-bottom: 0;
           }

           .ai-response-editor-block .delete-block-btn {
               float: right;
               margin-top: -5px;
               background: none;
               border: none;
               color: #ff3b30;
               font-size: 20px;
               cursor: pointer;
           }

           #phone-screen.dark-mode .ai-response-editor-block {
               background-color: #2c2c2e;
               border-color: #38383a;
           }

           #phone-screen.dark-mode .ai-response-editor-block textarea {
               background-color: #1c1c1e;
               color: #f0f0f0;
               border-color: #4a4a4e;
           }

           .offline-dialogue {
               font-weight: 500;
           }

           .offline-description {
               display: block;
               color: inherit;
               font-style: normal;
               margin-top: 4px;
               white-space: pre-wrap;
               line-height: 1.6;
           }

           .offline-description em {
               color: var(--text-secondary);
           }

           #phone-screen.dark-mode .offline-description {
               color: inherit;
           }

           .offline-continuous {
               white-space: pre-wrap;
               line-height: 1.8;
               word-break: break-word;
           }

           .offline-continuous .offline-dialogue {
               font-weight: 500;
           }

           .offline-continuous em {
               color: var(--text-secondary);
               font-style: italic;
           }

           .message-bubble .content {
               transition: background-color 0.5s ease-out;
           }

           .message-bubble.highlighted .content {
               background-color: rgba(0, 123, 255, 0.2) !important;
           }

           #gomoku-overlay {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 350px;
               z-index: 50;
               pointer-events: none;
               overflow: hidden;
               display: none;
           }

           #gomoku-content-wrapper {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: transparent !important;
               backdrop-filter: none !important;
               box-shadow: none !important;
               display: flex;
               flex-direction: column;
               justify-content: center;
               align-items: center;
               gap: 15px;
               padding: 15px 0;
               box-sizing: border-box;
               transition: transform 0.3s ease-out;
               transform: translateY(-100%);
               pointer-events: auto;
           }

           #phone-screen.dark-mode #gomoku-content-wrapper {
               background-color: rgba(28, 28, 30, 0.9);
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
           }

           #gomoku-overlay.visible #gomoku-content-wrapper {
               transform: translateY(0);
           }

           #chat-messages {
               transition: padding-top 0.3s ease-out;
           }

           #gomoku-board {
               background-color: #e4b591;
               border-radius: 8px;
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
               cursor: pointer;
           }

           #gomoku-controls {
               width: 100%;
               text-align: center;
               flex-shrink: 0;
           }

           #close-gomoku-btn {
               padding: 6px 15px;
               border-radius: 15px;
               border: 1px solid var(--text-secondary);
               background-color: rgba(255, 255, 255, 0.5);
               color: var(--text-secondary);
               cursor: pointer;
               font-size: 13px;
           }

           #phone-screen.dark-mode #close-gomoku-btn {
               background-color: rgba(0, 0, 0, 0.2);
               border-color: var(--text-secondary);
           }

           #gomoku-overlay {
               pointer-events: none;
           }

           #gomoku-board,
           #gomoku-controls {
               pointer-events: auto;
           }

           #product-grid {
               flex-grow: 1;
               overflow-y: auto;
               display: grid;
               grid-template-columns: repeat(2, 1fr);
               gap: 10px;
               padding: 10px;
               padding-bottom: 80px;
           }

           .product-item {
               background-color: white;
               border-radius: 8px;
               box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
               display: flex;
               flex-direction: column;
               cursor: pointer;
               position: relative;
           }

           .product-image {
               width: 100%;
               aspect-ratio: 1 / 1;
               object-fit: cover;
           }

           .product-info {
               padding: 12px 10px;
               flex-grow: 1;
               display: flex;
               flex-direction: column;
           }

           .product-name {
               font-size: 13px;
               color: #333;
               line-height: 1.4;
               min-height: 36px;
           }

           .product-footer {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-top: 8px;
           }

           .product-price {
               font-size: 16px;
               font-weight: 700;
               color: #ff5722;
           }

           .product-price::before {
               content: '¥';
               font-size: 12px;
           }

           .add-to-cart-btn {
               padding: 6px 12px;
               border: none;
               border-radius: 15px;
               background: linear-gradient(90deg, #ff9800, #ff5722);
               color: white;
               font-size: 12px;
               font-weight: 500;
               cursor: pointer;
           }

           .product-management-overlay {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.5);
               display: none;
               flex-direction: column;
               justify-content: center;
               align-items: center;
               gap: 15px;
               z-index: 7;
           }

           .product-management-overlay button {
               padding: 8px 20px;
               border: 1px solid white;
               background-color: rgba(255, 255, 255, 0.2);
               color: white;
               border-radius: 15px;
               cursor: pointer;
           }

           .product-management-overlay .delete-product-btn {
               border-color: #ff8a80;
               color: #ff8a80;
           }

           #shopping-screen.management-mode .product-footer {
               display: none;
           }

           #cart-title {
               position: static;
               transform: none;
           }

           #cart-items-list {
               padding: 10px;
               display: flex;
               flex-direction: column;
               gap: 10px;
           }

           .cart-item {
               display: flex;
               align-items: flex-start;
               gap: 12px;
               background-color: white;
               padding: 12px;
               border-radius: 12px;
           }

           .cart-item-checkbox {
               margin-top: 28px;
           }

           .cart-item-image {
               width: 80px;
               height: 80px;
               object-fit: cover;
               border-radius: 8px;
               flex-shrink: 0;
           }

           .cart-item-info {
               flex-grow: 1;
               display: flex;
               flex-direction: column;
           }

           .cart-item-name {
               font-weight: 500;
               font-size: 14px;
               line-height: 1.4;
           }

           .cart-item-footer {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-top: 10px;
           }

           .cart-item-price {
               color: #ff5722;
               font-weight: bold;
               font-size: 16px;
           }

           .quantity-control {
               display: flex;
               align-items: center;
               gap: 4px;
           }

           .quantity-btn {
               width: 26px;
               height: 26px;
               border: none;
               background-color: #f7f8fa;
               border-radius: 4px;
               font-weight: 500;
               cursor: pointer;
               color: #666;
           }

           .quantity-display {
               font-weight: 500;
               min-width: 30px;
               text-align: center;
           }

           #cart-footer {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: white;
               border-top: 1px solid var(--border-color);
               box-sizing: border-box;
           }

           #cart-footer .select-all-label {
               display: flex;
               align-items: center;
               gap: 5px;
           }

           #cart-footer .cart-summary {
               text-align: right;
           }

           #cart-footer .cart-subtext {
               font-size: 11px;
               color: #999;
           }

           #checkout-btn {
               padding: 10px 25px;
               border: none;
               border-radius: 20px;
               background: linear-gradient(90deg, #ff9800, #ff5722);
               color: white;
               font-size: 15px;
               font-weight: 500;
               cursor: pointer;
           }

           .gift-card {
               width: 220px;
               box-sizing: border-box;
               border-radius: 12px;
               background-color: var(--secondary-bg);
               border: 1px solid #eee;
               padding: 12px;
               cursor: pointer;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);
           }

           .gift-header {
               display: flex;
               align-items: center;
               gap: 8px;
               padding-bottom: 8px;
               border-bottom: 1px solid #f0f0f0;
           }

           .gift-header-icon {
               width: 20px;
               height: 20px;
               color: #ff9800;
           }

           .gift-header-text {
               font-size: 15px;
               font-weight: 600;
               color: var(--text-primary);
           }

           .gift-items-preview {
               padding: 12px 0;
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .gift-preview-item {
               display: flex;
               align-items: center;
               gap: 8px;
           }

           .gift-preview-img {
               width: 32px;
               height: 32px;
               object-fit: cover;
               border-radius: 4px;
               flex-shrink: 0;
           }

           .gift-preview-name {
               flex-grow: 1;
               font-size: 13px;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .gift-preview-quantity {
               font-size: 12px;
               color: var(--text-secondary);
           }

           .gift-footer {
               font-size: 12px;
               color: var(--text-secondary);
               text-align: right;
           }

           #gift-receipt-body {
               font-family: 'Helvetica Neue', Arial, sans-serif;
               padding: 15px;
               background-color: #f7f8fa;
           }

           .receipt-header {
               text-align: center;
               padding-bottom: 15px;
               border-bottom: 1px solid #ddd;
           }

           .receipt-header h3 {
               margin: 0 0 5px 0;
               font-size: 20px;
           }

           .receipt-header p {
               margin: 0;
               font-size: 12px;
               color: #888;
           }

           .receipt-items-table {
               width: 100%;
               border-collapse: collapse;
               margin: 15px 0;
           }

           .receipt-items-table th,
           .receipt-items-table td {
               padding: 10px 5px;
               font-size: 13px;
           }

           .receipt-items-table thead th {
               border-bottom: 1px solid #333;
               text-align: left;
           }

           .receipt-items-table .item-name {
               width: 50%;
           }

           .receipt-items-table .item-qty {
               text-align: center;
           }

           .receipt-items-table .item-price,
           .receipt-items-table .item-subtotal {
               text-align: right;
           }

           .receipt-total {
               padding-top: 15px;
               border-top: 1px solid #333;
               text-align: right;
               font-size: 16px;
               font-weight: bold;
           }

           .receipt-footer {
               text-align: center;
               margin-top: 25px;
               font-size: 12px;
               color: #888;
           }

           .product-item {
               position: relative;
           }

           .product-management-overlay {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               background-color: rgba(0, 0, 0, 0.6);
               display: none;
               justify-content: center;
               align-items: center;
               gap: 15px;
               padding: 10px 0;
               border-radius: 0 0 8px 8px;
               z-index: 5;
               transition: opacity 0.2s;
           }

           #shopping-screen.management-mode .product-management-overlay {
               display: flex;
           }

           .product-management-overlay button {
               padding: 8px 20px;
               border: 1px solid white;
               background-color: rgba(255, 255, 255, 0.2);
               color: white;
               border-radius: 15px;
               cursor: pointer;
           }

           .product-management-overlay .delete-product-btn {
               border-color: #ff8a80;
               color: #ff8a80;
           }

           #shopping-screen.management-mode .add-to-cart-btn {
               display: none;
           }

           .message-bubble.is-card-like {
               flex: initial;
               min-width: auto;
           }

           .message-bubble.is-card-like .content {
               flex: initial;
               padding: 0;
               background: transparent;
           }

           #go-to-cart-btn {
               display: flex;
               align-items: center;
               gap: 4px;
           }

           #gift-recipient-list .contact-picker-item {
               display: flex;
               align-items: center;
               padding: 10px 15px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
           }

           #gift-recipient-list .contact-picker-item:last-child {
               border-bottom: none;
           }

           #gift-recipient-list .contact-picker-item .checkbox {
               width: 20px;
               height: 20px;
               border: 2px solid #ccc;
               border-radius: 50%;
               margin-right: 15px;
               transition: all 0.2s ease;
           }

           #gift-recipient-list .contact-picker-item.selected .checkbox {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           #gift-recipient-list .contact-picker-item .avatar {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               margin-right: 12px;
           }

           #gift-recipient-list .contact-picker-item .name {
               font-weight: 500;
           }

           #ai-heart-rate-display {
               display: none !important;
           }

           #global-lyrics-bar {
               position: absolute;
               z-index: 20;
               display: flex;
               align-items: center;
               font-size: 13px;
               font-weight: 500;
               color: var(--text-secondary);
               background-color: rgba(0, 0, 0, 0.05);
               padding: 4px 12px;
               border-radius: 12px;
               opacity: 0;
               visibility: hidden;
               transition: opacity 0.4s ease, visibility 0.4s ease, top 0.3s ease, bottom 0.3s ease, left 0.3s ease, right 0.3s ease, transform 0.3s ease;
               pointer-events: none;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               max-width: 65%;
           }

           #phone-screen.dark-mode #global-lyrics-bar {
               color: #a0a0a0;
               background-color: rgba(255, 255, 255, 0.1);
           }

           #global-lyrics-bar.visible {
               opacity: 1;
               visibility: visible;
           }

           #phone-screen.dark-mode #global-lyrics-bar {
               color: #a0a0a0;
               background-color: rgba(255, 255, 255, 0.1);
           }

           #world-book-screen {
               background-color: #f0f2f5;
               display: flex;
               flex-direction: column;
           }

           #phone-screen.dark-mode #world-book-screen {
               background-color: #000000;
           }

           #world-book-tabs {
               display: flex;
               overflow-x: auto;
               padding: 10px 15px 0 15px;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
               -ms-overflow-style: none;
               scrollbar-width: none;
           }

           #world-book-tabs::-webkit-scrollbar {
               display: none;
           }

           .world-book-tab {
               padding: 8px 16px;
               cursor: pointer;
               border: none;
               background-color: transparent;
               font-size: 15px;
               font-weight: 500;
               color: var(--text-secondary);
               border-bottom: 2px solid transparent;
               margin-bottom: -1px;
               transition: all 0.2s ease-in-out;
               white-space: nowrap;
           }

           .world-book-tab.active {
               color: var(--accent-color);
               border-bottom-color: var(--accent-color);
               font-weight: 600;
           }

           #phone-screen.dark-mode .world-book-tab.active {
               color: #ffffff;
           }

           #world-book-content-container {
               flex-grow: 1;
               overflow-y: auto;
           }

           .world-book-category-pane {
               display: none;
               grid-template-columns: repeat(2, 1fr);
               gap: 15px;
               padding: 15px;
           }

           .world-book-category-pane.active {
               display: grid;
           }

           .world-book-card {
               background-color: var(--secondary-bg);
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
               cursor: pointer;
               transition: transform 0.2s ease, box-shadow 0.2s ease;
               display: flex;
               flex-direction: column;
               gap: 8px;
               min-width: 0;
               word-break: break-all;
           }

           .world-book-card:hover {
               transform: translateY(-5px);
               box-shadow: 0 6px 12px rgba(0, 0, 0, 0.12);
           }

           #phone-screen.dark-mode .world-book-card {
               box-shadow: 0 2px 8px rgba(255, 255, 255, 0.05);
           }

           .world-book-card .card-title {
               font-weight: 600;
               font-size: 15px;
               color: var(--text-primary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .world-book-card .card-content-preview {
               font-size: 13px;
               color: var(--text-secondary);
               line-height: 1.5;
               display: -webkit-box;
               -webkit-line-clamp: 3;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           #rendering-rules-screen {
               background-color: #f0f2f5;
               display: flex;
               flex-direction: column;
           }

           #phone-screen.dark-mode #rendering-rules-screen {
               background-color: #000000;
           }

           #rules-tabs {
               display: flex;
               overflow-x: auto;
               padding: 10px 15px 0 15px;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
               -ms-overflow-style: none;
               scrollbar-width: none;
           }

           #rules-tabs::-webkit-scrollbar {
               display: none;
           }

           .rules-tab {
               padding: 8px 16px;
               cursor: pointer;
               border: none;
               background-color: transparent;
               font-size: 15px;
               font-weight: 500;
               color: var(--text-secondary);
               border-bottom: 2px solid transparent;
               margin-bottom: -1px;
               transition: all 0.2s ease-in-out;
               white-space: nowrap;
           }

           .rules-tab.active {
               color: var(--accent-color);
               border-bottom-color: var(--accent-color);
               font-weight: 600;
           }

           #phone-screen.dark-mode .rules-tab.active {
               color: #ffffff;
           }

           #rules-content-container {
               flex-grow: 1;
               overflow-y: auto;
           }

           .rules-category-pane {
               display: none;
               grid-template-columns: repeat(2, 1fr);
               gap: 15px;
               padding: 15px;
           }

           .rules-category-pane.active {
               display: grid;
           }

           .rule-card {
               background-color: var(--secondary-bg);
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
               cursor: pointer;
               transition: transform 0.2s ease, box-shadow 0.2s ease;
               display: flex;
               flex-direction: column;
               gap: 8px;
               border-left: 5px solid #6c757d;
           }

           .rule-card.enabled {
               border-left-color: #28a745;
           }

           .rule-card:hover {
               transform: translateY(-5px);
               box-shadow: 0 6px 12px rgba(0, 0, 0, 0.12);
           }

           #phone-screen.dark-mode .rule-card {
               box-shadow: 0 2px 8px rgba(255, 255, 255, 0.05);
           }

           .rule-card .card-title {
               font-weight: 600;
               font-size: 15px;
               color: var(--text-primary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .rule-card .card-content-preview {
               font-size: 12px;
               font-family: monospace;
               color: var(--text-secondary);
               background-color: #f0f2f5;
               padding: 5px 8px;
               border-radius: 4px;
               word-break: break-all;
           }

           #phone-screen.dark-mode .rule-card .card-content-preview {
               background-color: #2c2c2e;
           }

           .control-btn.regenerate-btn {
               background-color: rgba(255, 255, 255, 0.2);
               background-size: 55%;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4"/><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>');
           }

           .control-btn.propel-btn {
               background-color: rgba(255, 255, 255, 0.2);
               background-size: 55%;
               background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 19 22 12 13 5 13 19"></polygon><polygon points="2 19 11 12 2 5 2 19"></polygon></svg>');
           }

           .message-bubble.is-raw-html .content {
               padding: 0 !important;
               background: transparent !important;
               border: none !important;
               box-shadow: none !important;
           }

           #phone-screen {
               user-select: none;
               -webkit-user-select: none;
               -moz-user-select: none;
               -ms-user-select: none;
               -webkit-touch-callout: none;
           }

           #home-screen #clock-container,
           #home-screen #app-grid,
           #home-screen #home-widgets-container {
               display: none !important;
           }

           #home-screen {
               background: linear-gradient(135deg, #6DD5FA, #2980B9);
               background-size: cover;
               background-position: center;
               padding: 20px;
               padding-top: calc(20px + env(safe-area-inset-top));
               padding-bottom: calc(20px + env(safe-area-inset-bottom));
               box-sizing: border-box;
               display: flex;
               flex-direction: column;
               justify-content: space-between;
               align-items: center;
               height: 100%;
           }

           #main-content-area {
               width: 100%;
               display: flex;
               flex-direction: column;
               gap: 30px;
               align-items: center;
               margin-top: 20px;
           }

           #profile-widget {
               position: relative;
               width: 100%;
               max-width: 380px;
               flex-shrink: 0;
           }

           #profile-banner-img {
               display: block;
               width: 100%;
               height: 150px;
               object-fit: cover;
               border-radius: 24px 24px 0 0;
               position: relative;
               z-index: 1;
           }

           #profile-widget .profile-avatar-container {
               position: absolute;
               top: 80px;
               left: 50%;
               transform: translateX(-50%);
               width: 80px;
               height: 80px;
               border-radius: 50%;
               background-color: white;
               padding: 4px;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
               z-index: 3;
           }

           #profile-avatar-img {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
           }

           #profile-widget .profile-info {
               background-color: rgba(255, 255, 255, 0.9);
               border-radius: 24px;
               margin-top: -24px;
               padding-top: 44px;
               min-height: 120px;
               box-sizing: border-box;
               display: flex;
               flex-direction: column;
               justify-content: center;
               padding-left: 15px;
               padding-right: 15px;
               padding-bottom: 15px;
               text-align: center;
               color: #1c1c1e;
               position: relative;
               z-index: 2;
           }

           #profile-widget::before {
               display: none !important;
           }

           #profile-avatar-img {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
           }

           #profile-widget::before {
               display: none !important;
           }

           #profile-avatar-img {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
           }

           #profile-username {
               font-size: 18px;
               font-weight: 600;
               margin: 0 0 2px 0;
           }

           #profile-sub-username {
               font-size: 13px;
               color: #8a8a8a;
               margin: 0 0 10px 0;
           }

           #profile-bio {
               font-size: 14px;
               margin: 0 0 12px 0;
               color: #333;
           }

           #profile-location {
               font-size: 12px;
               color: #8a8a8a;
               margin: 0 auto;
               display: inline-flex;
               align-items: center;
               gap: 4px;
               background-color: rgba(0, 0, 0, 0.05);
               padding: 3px 9px;
               border-radius: 10px;
           }

           #desktop-layout {
               display: grid;
               grid-template-columns: 1fr 1.1fr;
               gap: 20px;
               width: 100%;
               align-items: start;
           }

           #desktop-widget-column {
               display: flex;
               flex-direction: column;
               gap: 12px;
           }

           .widget-header {
               font-size: 14px;
               font-weight: 500;
               color: rgba(255, 255, 255, 0.8);
               margin: 0 0 5px 5px;
           }

           .desktop-widget {
               background-color: rgba(255, 255, 255, 0.2);
               border: 1px solid rgba(255, 255, 255, 0.2);
               border-radius: 18px;
               padding: 12px 15px;
               color: #1f1f1f;
               font-weight: 500;
               font-size: 13px;
               display: flex;
               align-items: center;
           }

           .desktop-widget.text-only {
               background-color: transparent;
               border: none;
               padding: 0;
               box-shadow: none;
           }

           .desktop-widget.icon-left {
               justify-content: flex-start;
               gap: 10px;
           }

           .desktop-widget.icon-right {
               justify-content: flex-end;
               gap: 10px;
           }

           .desktop-widget img {
               width: 28px;
               height: 28px;
               border-radius: 50%;
               object-fit: cover;
           }

           .desktop-widget p,
           .desktop-widget span {
               margin: 0;
           }

           #desktop-app-container {
               display: grid;
               grid-template-columns: 1fr 1fr;
               gap: 25px;
               align-content: start;
           }

           #desktop-dock {
               background-color: rgba(255, 255, 255, 0.15);
               border-radius: 20px;
               padding: 15px 25px;
               display: flex;
               justify-content: center;
               gap: 30px;
               width: fit-content;
               flex-shrink: 0;
               margin-bottom: calc(20px + env(safe-area-inset-bottom));
           }

           .desktop-app-icon {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
               cursor: pointer;
               text-align: center;
           }

           .icon-bg-desktop {
               width: 55px;
               height: 55px;
               border-radius: 14px;
               background-color: #f0f2f5;
               justify-content: center;
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
               transition: transform 0.2s ease;
               overflow: hidden;
           }

           .icon-bg-desktop img {
               width: 100%;
               height: 100%;
               object-fit: cover;
               border-radius: 0;
           }

           .desktop-app-icon .label {
               color: #333;
               font-size: 13px;
               font-weight: 500;
           }

           .desktop-app-icon:active .icon-bg-desktop {
               transform: scale(0.9);
           }

           .editable-text:hover,
           .editable-image:hover {
               outline: 2px dashed rgba(255, 255, 255, 0.8);
               cursor: pointer;
               opacity: 0.9;
           }

           .editable-text,
           .editable-image {
               cursor: pointer;
               transition: all 0.2s ease-in-out;
           }

           .editable-text:hover,
           .editable-image:hover {
               outline: 2px dashed rgba(255, 255, 255, 0.8);
               opacity: 0.9;
               border-radius: 4px;
           }

           #profile-widget .profile-info {
               background: transparent !important;
               position: relative;
               z-index: 1;
           }

           #profile-widget .profile-info::before {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;
               background-color: rgba(255, 255, 255, 0.9);
               border-radius: 24px;
               mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
               -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
               z-index: -1;
           }

           #chat-settings-screen {
               display: flex;
               flex-direction: column;
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #chat-settings-screen {
               background-color: #000000;
           }

           #chat-settings-screen .form-container {
               flex-grow: 1;
               overflow-y: auto;
               padding-top: 100px;
               margin-top: -80px;
           }

           .search-result-item {
               display: flex;
               flex-direction: column;
               padding: 12px 18px;
               border-bottom: 1px solid var(--border-color);
               cursor: pointer;
               transition: background-color 0.2s;
           }

           .search-result-item:hover {
               background-color: rgba(0, 0, 0, 0.1);
           }

           #phone-screen.dark-mode .search-result-item:hover {
               background-color: rgba(255, 255, 255, 0.1);
           }

           .search-result-item .title {
               font-weight: 500;
               font-size: 15px;
               color: var(--text-primary);
           }

           .search-result-item .artist {
               font-size: 12px;
               color: var(--text-secondary);
               margin-top: 4px;
           }

           .search-result-item .source {
               font-size: 10px;
               color: var(--accent-color);
               background-color: rgba(0, 123, 255, 0.1);
               padding: 2px 6px;
               border-radius: 4px;
               font-weight: bold;
               margin-left: 8px;
           }

           #music-player-cover {
               width: 180px;
               height: 180px;
               border-radius: 15px;
               object-fit: cover;
               box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
               margin-bottom: 25px;
               transition: opacity 0.5s ease-in-out;
           }

           #music-visual-container {
               position: relative;
               width: 220px;
               height: 220px;
               margin-bottom: 25px;
               cursor: pointer;
           }

           #vinyl-view,
           #inline-lyrics-view {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               display: flex;
               justify-content: center;
               align-items: center;
               transition: opacity 0.5s ease, transform 0.5s ease;
           }

           #vinyl-view {
               background-color: #222;
               border-radius: 50%;
               padding: 18px;
               box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3),
                   inset 0 0 0 2px rgba(255, 255, 255, 0.05);
               background-image: repeating-radial-gradient(circle, #333, #333 1px, #222 1px, #222 2px);
               box-sizing: border-box;
           }

           #vinyl-view #music-player-cover {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
               box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
               margin: 0;
           }

           #inline-lyrics-view {
               opacity: 0;
               transform: scale(1.1);
               pointer-events: none;
               padding: 10px;
               box-sizing: border-box;
           }

           #music-visual-container.lyrics-active #vinyl-view {
               opacity: 0;
               transform: scale(0.9);
           }

           #music-visual-container.lyrics-active #inline-lyrics-view {
               opacity: 1;
               transform: scale(1);
               pointer-events: auto;
           }

           #inline-lyrics-view #music-lyrics-container {
               width: 100%;
               height: 100%;
           }

           #music-info-top {
               text-align: center;
               flex-shrink: 0;
               margin-bottom: 20px;
           }

           #music-player-song-title,
           #music-player-artist,
           #music-time-counter {
               margin-bottom: 5px;
           }

           #music-visual-container {
               margin-bottom: 15px;
           }

           @keyframes spin-vinyl {
               from {
                   transform: rotate(0deg);
               }

               to {
                   transform: rotate(360deg);
               }
           }

           #vinyl-view.spinning {
               animation: spin-vinyl 12s linear infinite;
           }

           #single-lyric-display {
               height: 40px;
               line-height: 40px;
               width: 100%;
               margin-top: 15px;
               text-align: center;
               font-size: 14px;
               color: #333;
               font-weight: 500;
               transition: opacity 0.3s ease;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           #music-visual-container.lyrics-active+#single-lyric-display {
               display: none;
           }

           #character-profile-modal {
               background-color: rgba(0, 0, 0, 0.3);
               backdrop-filter: blur(8px);
               -webkit-backdrop-filter: blur(8px);
           }

           .character-profile-content {
               width: 320px;
               height: 75vh;
               max-height: 580px;
               background-color: #f0f2f5;
               border-radius: 20px;
               box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
               display: flex;
               flex-direction: column;
               position: relative;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
               overflow: visible;
               padding-top: 40px;
           }

           .profile-history-icon-btn {
               /* <--- 核心修改1：从 ID (#) 改为类 (.) */
               /* 核心修改2：移除了 position, top, right, z-index 这些绝对定位属性 */
               width: 36px;
               height: 36px;
               background: none;
               border: none;
               cursor: pointer;
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: background-color 0.2s;
               padding: 0;
           }

           #profile-history-icon-btn:hover {
               background-color: rgba(0, 0, 0, 0.05);
           }

           .profile-history-icon-btn svg {
               width: 20px;
               height: 20px;
               stroke: #b0b0b0;
               stroke-width: 2;
           }

           #profile-main-content,
           #profile-thoughts-history-view {
               display: flex;
               flex-direction: column;
               width: 100%;
               height: 100%;
               box-sizing: border-box;
           }

           #profile-main-content {
               padding: 0 25px 25px 25px;
               gap: 20px;
               flex-grow: 1;
               overflow-y: auto;
           }

           .profile-header {
               display: flex;
               align-items: center;
               gap: 15px;
               flex-shrink: 0;
               margin-bottom: 10px;
           }

           #profile-avatar {
               width: 60px;
               height: 60px;
               border-radius: 12px;
               object-fit: cover;
           }

           .profile-info {
               display: flex;
               flex-direction: column;
           }

           #profile-name {
               font-size: 20px;
               font-weight: 600;
               color: #1f1f1f;
           }

           #profile-id {
               font-size: 14px;
               color: #8a8a8a;
           }

           .profile-section {
               background-color: #ffffff;
               border-radius: 16px;
               padding: 20px;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
               display: flex;
               flex-direction: column;
               gap: 12px;
               flex-shrink: 0;
           }

           .profile-section-header {
               display: flex;
               align-items: center;
               gap: 10px;
               padding-bottom: 12px;
               border-bottom: 1px solid #f0f0f0;
           }

           .profile-section-icon {
               font-size: 20px;
               opacity: 0.5;
           }

           .profile-section label {
               font-size: 15px;
               font-weight: 600;
               color: #555;
               margin: 0;
           }

           .profile-section p {
               font-size: 15px;
               color: #333;
               line-height: 1.7;
               margin: 0;
               white-space: pre-wrap;
           }

           #profile-thoughts-history-view {
               display: none;
               padding: 0 25px 25px 25px;
           }

           #profile-thoughts-history-view .profile-header {
               justify-content: space-between;
               padding-bottom: 15px;
           }

           #profile-thoughts-history-view .profile-header span {
               font-size: 18px;
               font-weight: 600;
           }

           #history-back-btn {
               width: 36px;
               height: 36px;
               background: none;
               border: none;
               cursor: pointer;
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: background-color 0.2s;
               padding: 0;
           }

           #history-back-btn:hover {
               background-color: rgba(0, 0, 0, 0.05);
           }

           #history-back-btn svg {
               width: 22px;
               height: 22px;
               stroke: #a0a0a0;
               stroke-width: 2.5;
           }

           #thoughts-history-list {
               flex-grow: 1;
               overflow-y: auto;
               padding-right: 5px;
               margin-right: -10px;
               display: flex;
               flex-direction: column;
               gap: 15px;
           }

           .thought-card {
               background-color: #ffffff;
               border-radius: 16px;
               padding: 15px 20px;
               border: 1px solid #eee;
           }

           .thought-header {
               font-size: 12px;
               color: #b0b0b0;
               margin-bottom: 12px;
               padding-bottom: 8px;
               border-bottom: 1px solid #f0f0f0;
           }

           .thought-content .label {
               display: flex;
               align-items: center;
               gap: 6px;
               font-weight: 600;
               color: #a0a0a0;
               font-size: 13px;
               margin-bottom: 6px;
           }

           .thought-content .label svg {
               width: 16px;
               height: 16px;
           }

           .thought-content .text {
               font-size: 14px;
               color: #555;
               line-height: 1.7;
               white-space: pre-wrap;
               padding-left: 22px;
           }

           .thought-content .jottings {
               margin-top: 15px;
           }

           #profile-main-content::-webkit-scrollbar,
           #thoughts-history-list::-webkit-scrollbar {
               display: none;
           }

           #profile-main-content,
           #thoughts-history-list {
               -ms-overflow-style: none;
               scrollbar-width: none;
           }

           .character-profile-content {
               background-color: #ffffff !important;
           }

           #character-profile-modal .jottings .label {
               display: none;
           }

           #character-profile-modal .thought-content .text {
               padding-left: 0;
           }

           #qzone-more-actions-btn {
               font-size: 24px;
               font-weight: bold;
               padding: 0 10px;
               border-radius: 50%;
               line-height: 1;
               position: relative;
               top: -2px;
               transition: background-color 0.2s;
           }

           #qzone-more-actions-btn:hover {
               background-color: rgba(0, 0, 0, 0.05);
           }

           #phone-screen.dark-mode #qzone-more-actions-btn:hover {
               background-color: rgba(255, 255, 255, 0.1);
           }

           #clear-posts-list {
               overflow-y: auto;
               flex-grow: 1;
           }

           .clear-posts-item {
               display: flex;
               align-items: center;
               padding: 12px 18px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
               transition: background-color 0.2s;
           }

           .clear-posts-item:hover {
               background-color: #f5f5f5;
           }

           .clear-posts-item .checkbox {
               width: 22px;
               height: 22px;
               border: 2px solid #ccc;
               border-radius: 50%;
               margin-right: 15px;
               transition: all 0.2s ease;
               display: flex;
               align-items: center;
               justify-content: center;
               color: white;
           }

           .clear-posts-item.selected .checkbox {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           .clear-posts-item.selected .checkbox::after {
               content: '✔';
               font-size: 14px;
               font-weight: bold;
           }

           .clear-posts-item .name {
               font-weight: 500;
           }

           .clear-posts-item.danger-option .name {
               color: #ff3b30;
               font-weight: 600;
           }

           .thought-card {
               position: relative;
           }

           .thought-delete-btn {
               position: absolute;
               top: 10px;
               right: 10px;
               width: 26px;
               height: 26px;
               border-radius: 50%;
               border: none;
               background-color: rgba(0, 0, 0, 0.05);
               color: var(--text-secondary);
               font-size: 20px;
               line-height: 26px;
               text-align: center;
               cursor: pointer;
               opacity: 0;
               transition: all 0.2s ease-in-out;
           }

           .thought-card:hover .thought-delete-btn {
               opacity: 1;
           }

           .thought-delete-btn:hover {
               background-color: #ff3b30;
               color: white;
           }

           .search-result-item {
               display: flex;
               align-items: center;
               padding: 12px 18px;
               border-bottom: 1px solid var(--border-color);
               cursor: pointer;
               transition: background-color 0.2s;
           }

           .search-result-item:hover {
               background-color: rgba(0, 0, 0, 0.05);
           }

           #phone-screen.dark-mode .search-result-item:hover {
               background-color: rgba(255, 255, 255, 0.1);
           }

           .search-result-item .search-result-info {
               flex-grow: 1;
               pointer-events: none;
           }

           .search-result-item .music-search-checkbox {
               width: 20px;
               height: 20px;
               margin-right: 15px;
               flex-shrink: 0;
           }

           #music-search-results-modal .modal-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           #music-search-results-modal .modal-footer {
               display: flex;
               justify-content: space-around;
           }

           #music-search-results-modal .modal-footer button {
               width: 45%;
           }

           .bg-upload-container {
               width: 100%;
               justify-content: center;
               gap: 15px;
           }

           .bg-upload-container .form-button-secondary {
               flex-grow: 1;
               flex-basis: 0;
               max-width: 180px;
               margin-top: 0;
               padding: 12px;
               font-size: 15px;
               font-weight: 600;
               border-radius: 8px;
               border: none;
               background-color: #e9e9eb;
               color: #1c1c1e;
               cursor: pointer;
               transition: background-color 0.2s, transform 0.1s;
           }

           .bg-upload-container .form-button-secondary:active {
               transform: scale(0.98);
           }

           #remove-global-bg-btn {
               background-color: #ffebee;
               color: #c62828;
           }

           #character-profile-modal .character-profile-content {
               position: relative;
               overflow: visible;
               padding-bottom: 35px;
           }

           #character-profile-modal .character-profile-content::before {
               content: '';
               position: absolute;
               top: -10px;
               left: 0;
               right: 0;
               height: 20px;
               background-image: radial-gradient(circle at 50% 0, transparent 8px, #f0f2f5 8px);
               background-size: 25px 20px;
               background-repeat: repeat-x;
           }

           #character-profile-modal .character-profile-content::after {
               content: '';
               position: absolute;
               bottom: -10px;
               left: 0;
               right: 0;
               height: 20px;
               background-image: radial-gradient(circle at 50% 100%, transparent 8px, #f0f2f5 8px);
               background-size: 25px 20px;
               background-repeat: repeat-x;
           }

           #character-profile-modal .character-profile-content {
               border-radius: 0;
               background-color: #ffffff;
           }

           #character-profile-modal .character-profile-content::before {
               background-image: radial-gradient(circle at 50% 0, transparent 8px, #ffffff 8px);
           }

           #character-profile-modal .character-profile-content::after {
               background-image: radial-gradient(circle at 50% 100%, transparent 8px, #ffffff 8px);
           }

           #character-profile-modal .thought-header {
               position: relative;
               width: 100%;
               padding-bottom: 15px;
               margin-bottom: 25px;
               border-bottom: 2px dashed #e0e0e0;
           }

           #character-profile-modal .thought-header::before {
               content: '';
               position: absolute;
               bottom: -11px;
               left: -35px;
               width: 20px;
               height: 20px;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.3);
           }

           #character-profile-modal .thought-header::after {
               content: '';
               position: absolute;
               bottom: -11px;
               right: -35px;
               width: 20px;
               height: 20px;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.3);
           }

           #character-profile-modal .thought-header {
               height: 140px;
               flex-shrink: 0;
               padding: 10px;
               padding-bottom: 25px;
               box-sizing: border-box;
               border-bottom: 2px dashed #e0e0e0;
               margin-bottom: 25px;
               position: relative;
               background-image: url('https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758340625111_qdqqd_zqr2cl.jpeg');
               background-size: cover;
               background-position: center top;
               border-radius: 0;
           }

           #profile-photo-slot {
               display: none;
           }

           #character-profile-modal #profile-main-content .thought-header {
               box-sizing: border-box;
               background-image: url('https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758340625111_qdqqd_zqr2cl.jpeg');
               background-size: cover;
               background-position: center top;
               border-bottom: 2px dashed #e0e0e0;
               margin-bottom: 15px;
               background-clip: content-box;
               -webkit-background-clip: content-box;
           }

           #character-profile-modal #profile-main-content .thought-header::before,
           #character-profile-modal #profile-main-content .thought-header::after {
               content: '';
               position: absolute;
               bottom: -11px;
               width: 20px;
               height: 20px;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.3);
           }

           #character-profile-modal #profile-main-content .thought-header::before {
               left: -35px;
           }

           #character-profile-modal #profile-main-content .thought-header::after {
               right: -35px;
           }

           #character-profile-modal #thoughts-history-list .thought-card .thought-header {
               height: auto;
               padding: 0;
               padding-bottom: 8px;
               margin-bottom: 12px;
               background-image: none;
               border: none;
               border-bottom: 1px solid #f0f0f0;
           }

           #character-profile-modal #thoughts-history-list .thought-card .thought-header::before,
           #character-profile-modal #thoughts-history-list .thought-card .thought-header::after {
               display: none !important;
           }

           #character-profile-modal #profile-main-content .label {
               display: flex !important;
           }

           #character-profile-modal #profile-main-content .text {
               font-family: "SimSun", "Songti SC", serif;
               font-size: 16px;
           }

           #character-profile-modal .thought-content .label {
               color: #000000 !important;
           }

           #character-profile-modal .thought-content .text {
               color: #000000 !important;
           }

           #character-profile-modal #profile-main-content {
               overflow-x: hidden;
           }

           #sticker-category-tabs {
               display: flex;
               overflow-x: auto;
               padding: 0 15px;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
               -ms-overflow-style: none;
               scrollbar-width: none;
           }

           #sticker-category-tabs::-webkit-scrollbar {
               display: none;
           }

           .sticker-category-tab {
               padding: 10px 16px;
               cursor: pointer;
               border: none;
               background-color: transparent;
               font-size: 14px;
               font-weight: 500;
               color: var(--text-secondary);
               border-bottom: 2px solid transparent;
               margin-bottom: -1px;
               transition: all 0.2s ease-in-out;
               white-space: nowrap;
           }

           .sticker-category-tab.active {
               color: var(--accent-color);
               border-bottom-color: var(--accent-color);
               font-weight: 600;
           }

           #phone-screen.dark-mode .sticker-category-tab.active {
               color: #ffffff;
           }

           #sticker-grid.management-mode .sticker-item::after {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               border: 3px solid transparent;
               border-radius: 10px;
               box-sizing: border-box;
               transition: border-color 0.2s;
               pointer-events: none;
           }

           #sticker-grid.management-mode .sticker-item.selected::after {
               border-color: var(--accent-color);
           }

           #sticker-grid.management-mode .sticker-item .delete-btn {
               display: block;
               background-color: rgba(0, 0, 0, 0.5);
               color: white;
               border: 1px solid white;
           }

           #sticker-action-bar {
               display: none;
               flex-shrink: 0;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               justify-content: space-between;
               align-items: center;
           }

           #sticker-action-bar .select-all-label {
               font-size: 16px;
               color: var(--text-primary);
               cursor: pointer;
           }

           #sticker-action-bar button {
               padding: 10px 25px;
               border-radius: 20px;
               border: none;
               font-size: 15px;
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
           }

           #character-selection-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #character-selection-screen {
               background-color: #000;
           }

           #character-grid {
               padding: 0;
               overflow-y: auto;
               flex-grow: 1;
           }

           .character-select-item {
               display: flex;
               flex-direction: row;
               align-items: center;
               cursor: pointer;
               padding: 12px 20px;
               border-bottom: 1px solid var(--border-color);
               gap: 15px;
               transition: background-color 0.2s;
           }

           .character-select-item:hover {
               background-color: #f5f5f5;
           }

           .character-select-item .avatar {
               width: 45px;
               height: 45px;
               border-radius: 50%;
               object-fit: cover;
               margin-bottom: 0;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
               transition: transform 0.2s ease;
               flex-shrink: 0;
           }

           .character-select-item .name {
               font-weight: 500;
               font-size: 16px;
               color: var(--text-primary);
           }

           #character-phone-screen {
               background-size: cover;
               background-position: center;
           }

           #myphone-screen {
               background-size: cover;
               background-position: center;
           }

           .char-screen {
               width: 100%;
               height: 100%;
               position: absolute;
               top: 0;
               left: 0;
               display: flex;
               flex-direction: column;
               overflow: hidden;
               opacity: 0;
               visibility: hidden;
               transition: opacity 0.3s, visibility 0.3s;
           }

           .char-screen.active {
               opacity: 1;
               visibility: visible;
               z-index: 2;
           }

           #char-home-screen {
               justify-content: flex-start;
               align-items: center;
               box-sizing: border-box;
               padding: 0 20px;
           }

           #char-clock-container {
               text-align: center;
               color: white;
               text-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
               margin-top: calc(60px + env(safe-area-inset-top));
               flex-shrink: 0;
               margin-bottom: 100px;
           }

           #char-main-time {
               font-size: 88px;
               font-weight: 600;
               letter-spacing: -2px;
               font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
           }

           #char-main-date {
               font-size: 22px;
               font-weight: normal;
           }

           #char-app-grid {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 20px;
               width: 100%;
           }

           #char-qq-screen,
           #char-memo-screen,
           #char-diary-screen,
           #char-usage-screen,
           #char-album-screen,
           #char-browser-screen,
           #char-taobao-screen {
               background-color: var(--secondary-bg);
           }

           .memo-item,
           .diary-item,
           .usage-item {
               padding: 15px 20px;
               border-bottom: 1px solid var(--border-color);
               cursor: pointer;
           }

           .memo-item .content,
           .diary-item .content {
               font-size: 16px;
               color: var(--text-primary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .diary-item .date,
           .usage-item .timestamp {
               font-size: 12px;
               color: var(--text-secondary);
               margin-bottom: 5px;
           }

           .usage-item .action {
               font-size: 15px;
               color: var(--text-primary);
           }

           #char-album-grid,
           #myphone-album-grid {
               display: grid;
               grid-template-columns: repeat(3, 1fr);
               gap: 5px;
               padding: 5px;
           }

           .char-photo-item {
               aspect-ratio: 1 / 1;
               background-size: cover;
               background-position: center;
               background-color: #e9ecef;
           }

           .char-browser-item {
               padding: 12px 20px;
               border-bottom: 1px solid var(--border-color);
           }

           .char-browser-item .title {
               font-weight: 500;
               font-size: 15px;
               color: var(--text-primary);
               margin-bottom: 4px;
           }

           .char-browser-item .url {
               font-size: 12px;
               color: var(--accent-color);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           #char-product-grid,
           #myphone-taobao-grid {
               display: grid;
               grid-template-columns: repeat(2, 1fr);
               gap: 10px;
               padding: 10px;
           }

           .char-product-item {
               background-color: var(--secondary-bg);
               border-radius: 8px;
               box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
               display: flex;
               flex-direction: column;
           }

           .char-product-item .product-image {
               width: 100%;
               aspect-ratio: 1 / 1;
               object-fit: cover;
               border-radius: 8px 8px 0 0;
           }

           .char-product-item .product-info {
               padding: 12px 10px;
               flex-grow: 1;
           }

           .char-product-item .product-name {
               font-size: 13px;
               color: #333;
               line-height: 1.4;
               min-height: 36px;
           }

           .char-product-item .product-price {
               font-size: 16px;
               font-weight: 700;
               color: #ff5722;
               margin-top: 8px;
           }

           .char-product-item .product-price::before {
               content: '¥';
               font-size: 12px;
           }

           #char-qq-screen .list-container {
               padding: 0;
           }

           #transcript-modal-body {
               display: flex;
               flex-direction: column;
               gap: 20px;
               padding: 15px;
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #transcript-modal-body {
               background-color: #000000;
           }

           #chat-list .chat-list-item,
           #char-chat-list .chat-list-item {
               display: flex;
               align-items: center;
               gap: 15px;
           }

           #chat-list .chat-list-item .avatar-group,
           #char-chat-list .chat-list-item .avatar-group {
               flex-shrink: 0;
           }

           #chat-list .chat-list-item .info,
           #char-chat-list .chat-list-item .info {
               flex-grow: 1;
               min-width: 0;
           }

           #char-qq-conversation-screen .list-container,
           #myphone-qq-conversation-screen .list-container {
               display: flex;
               flex-direction: column;
               gap: 20px;
               padding: 15px;
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #char-qq-conversation-screen .list-container,
           #phone-screen.dark-mode #myphone-qq-conversation-screen .list-container {
               background-color: #000000;
           }

           #char-qq-screen,
           #char-memo-screen,
           #char-diary-screen,
           #char-usage-screen,
           #char-album-screen,
           #char-browser-screen,
           #char-taobao-screen,
           #char-browser-article-screen,
           #char-wallet-screen {
               background-color: var(--secondary-bg);
           }

           #char-memo-detail-content {
               width: 100%;
               height: 100%;
               border: none;
               background-color: transparent;
               font-size: 16px;
               line-height: 1.7;
               padding: 15px 20px;
               box-sizing: border-box;
               resize: none;
               outline: none;
               font-family: inherit;
               color: var(--text-primary);
           }

           #char-memo-detail-screen {
               background-color: var(--secondary-bg);
           }

           #char-memo-detail-screen .header {
               background-color: var(--secondary-bg);
               border-bottom: 1px solid var(--border-color);
               padding-bottom: 10px;
           }

           #char-memo-detail-title {
               position: absolute;
               left: 50%;
               transform: translateX(-50%);
               font-weight: 600;
           }

           #char-memo-detail-screen .form-container {
               padding: 0;
           }

           #char-memo-detail-content {
               background-color: var(--secondary-bg);
               padding: 15px 20px;
               font-size: 17px;
               line-height: 1.7;
               color: var(--text-primary);
           }

           #char-diary-detail-screen {
               background-color: #FDFBF5;
           }

           #phone-screen.dark-mode #char-diary-detail-screen {
               background-color: #2c2c2e;
           }

           #char-diary-detail-content-wrapper {
               padding: 0;
               overflow-y: auto;
           }

           #char-diary-detail-content {
               padding: 25px 20px;
               font-family: Georgia, 'Times New Roman', Times, serif;
               font-size: 16px;
               line-height: 1.8;
               color: #383838;
           }

           #phone-screen.dark-mode #char-diary-detail-content {
               color: #e0e0e0;
           }

           #char-diary-detail-content>p:first-of-type {
               font-size: 20px;
               font-weight: 600;
               margin-bottom: 20px;
               text-align: center;
           }

           #char-diary-detail-content strong {
               font-weight: 600;
           }

           #char-diary-detail-content .spoiler {
               background-color: #333;
               color: #333;
               padding: 0 4px;
               border-radius: 4px;
               cursor: pointer;
               transition: all 0.2s ease-in-out;
           }

           #char-diary-detail-content .spoiler:hover {
               background-color: #e0e0e0;
               color: inherit;
           }

           @import url('https://fonts.googleapis.com/css2?family=Zhi+Mang+Xing&display=swap');

           #char-diary-detail-content .diary-highlight {
               background-color: #FFFACD;
               padding: 1px 4px;
               border-radius: 3px;
               margin: 0 2px;
           }

           #char-diary-detail-content .diary-underline {
               border-bottom: 2px dotted #FFB6C1;
               text-decoration: none;
               padding-bottom: 1px;
           }

           #char-diary-detail-content .diary-emphasis {
               color: #DB7093;
               font-weight: bold;
           }

           #char-diary-detail-content .diary-handwritten {
               font-family: 'Zhi Mang Xing', cursive;
               font-size: 1.1em;
               color: #1a1a1a;
           }

           #char-diary-detail-content .diary-messy {
               font-family: 'Zhi Mang Xing', cursive;
               font-size: 1.1em;
               color: #1a1a1a;
               transform: rotate(-2deg);
               display: inline-block;
               margin: 0 2px;
           }

           #char-diary-detail-content .diary-censored {
               background-color: #222;
               color: #222;
               user-select: none;
               padding: 0 3px;
               border-radius: 2px;
           }

           .diary-censored:hover,
           .diary-censored:active {
               background-color: #E0E0E0;
               color: inherit;
               cursor: pointer;
           }

           #char-amap-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #char-amap-screen {
               background-color: #000000;
           }

           #char-amap-list {
               padding: 15px;
               display: flex;
               flex-direction: column;
               gap: 18px;
           }

           .char-amap-item {
               background-color: var(--secondary-bg);
               border-radius: 12px;
               padding: 15px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
               display: flex;
               flex-direction: column;
           }

           .amap-item-header {
               display: flex;
               align-items: flex-start;
               gap: 12px;
               border-bottom: 1px solid var(--border-color);
               padding-bottom: 12px;
               margin-bottom: 12px;
           }

           .amap-item-icon {
               font-size: 24px;
               color: var(--accent-color);
               margin-top: 2px;
           }

           .amap-item-info {
               flex-grow: 1;
           }

           .amap-item-title {
               font-weight: 600;
               font-size: 16px;
               margin-bottom: 4px;
           }

           .amap-item-address {
               font-size: 13px;
               color: var(--text-secondary);
           }

           .amap-item-body {
               display: flex;
               flex-direction: column;
               gap: 10px;
           }

           .amap-item-comment {
               font-size: 14px;
               line-height: 1.6;
               white-space: pre-wrap;
           }

           .amap-item-photo {
               width: 100%;
               height: 150px;
               border-radius: 8px;
               background-size: cover;
               background-position: center;
               cursor: pointer;
           }

           .amap-item-footer {
               font-size: 12px;
               color: var(--text-secondary);
               margin-top: 10px;
               text-align: right;
           }

           #char-usage-list {
               padding: 10px 0;
           }

           .char-usage-item {
               display: flex;
               align-items: center;
               gap: 15px;
               padding: 10px 20px;
               transition: background-color 0.2s;
           }

           .char-usage-item:hover {
               background-color: rgba(0, 0, 0, 0.03);
           }

           .usage-item-icon {
               width: 40px;
               height: 40px;
               border-radius: 8px;
               object-fit: cover;
               flex-shrink: 0;
               background-color: #e9ecef;
           }

           .usage-item-info {
               flex-grow: 1;
           }

           .usage-item-name {
               font-weight: 500;
               font-size: 16px;
           }

           .usage-item-category {
               font-size: 12px;
               color: var(--text-secondary);
           }

           .usage-item-time {
               font-size: 15px;
               color: var(--text-secondary);
               font-weight: 500;
               flex-shrink: 0;
           }

           #char-music-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #char-music-screen {
               background-color: #000000;
           }

           #char-music-list {
               padding: 0;
           }

           .char-music-item {
               display: flex;
               align-items: center;
               gap: 12px;
               padding: 10px 20px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
           }

           .char-music-item:hover {
               background-color: rgba(0, 0, 0, 0.03);
           }

           .music-item-cover {
               width: 50px;
               height: 50px;
               border-radius: 8px;
               object-fit: cover;
               flex-shrink: 0;
           }

           .music-item-info {
               flex-grow: 1;
               overflow: hidden;
           }

           .music-item-name {
               font-weight: 500;
               font-size: 16px;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .music-item-artist {
               font-size: 12px;
               color: var(--text-secondary);
           }

           #char-music-player-modal .modal-content {
               width: 400px !important;
               height: auto !important;
               max-height: 90vh;
               background-color: #f7f8fa !important;
               border-radius: 12px !important;
               box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1) !important;
               color: #333 !important;
               display: flex;
               flex-direction: column;
           }

           #char-music-player-modal .char-player-header {
               flex-shrink: 0;
               padding: 12px 15px;
               border-bottom: 1px solid #e5e5e5;
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-weight: 600;
           }

           #char-music-player-modal .char-player-close-btn {
               background: none;
               border: none;
               font-size: 20px;
               color: #aaa;
               cursor: pointer;
           }

           #char-music-player-modal .char-player-close-btn:hover {
               color: #333;
           }

           #char-music-player-modal .char-player-body {
               padding: 30px 35px 20px 35px;
               text-align: center;
           }

           #char-music-player-modal #char-music-cover {
               width: 220px;
               height: 220px;
               border-radius: 10px;
               box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
               margin-bottom: 20px;
               object-fit: cover;
           }

           #char-music-player-modal .char-player-progress-bar-container {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-bottom: 15px;
           }

           #char-music-player-modal .char-player-progress-bar {
               flex-grow: 1;
               height: 4px;
               background-color: #e0e0e0;
               border-radius: 2px;
               cursor: pointer;
           }

           #char-music-player-modal #char-music-progress-fill {
               width: 0%;
               height: 100%;
               background-color: #555;
               border-radius: 2px;
           }

           #char-music-player-modal .char-player-controls {
               display: flex;
               align-items: center;
               justify-content: center;
               gap: 20px;
           }

           #char-music-player-modal .char-player-controls .control-btn {
               background: none;
               border: none;
               color: #555;
               cursor: pointer;
               transition: color 0.2s;
               padding: 5px;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           #char-music-player-modal .char-player-controls .control-btn:hover {
               color: #000;
           }

           #char-music-player-modal .char-player-controls .control-btn.play {
               width: 50px;
               height: 50px;
               background-color: #f0f1f3;
               border-radius: 50%;
               color: #333;
           }

           #char-music-player-modal .char-player-controls .control-btn.mode {
               font-size: 14px;
               font-weight: 500;
               width: 50px;
           }

           #char-music-player-modal #char-music-lyrics {
               flex-grow: 1;
               overflow-y: auto;
               padding: 0 35px 25px 35px;
               font-size: 14px;
               line-height: 2;
               color: #888;
               text-align: center;
           }

           #char-music-player-modal #char-music-lyrics p.active {
               color: #000;
               font-weight: 600;
           }

           #char-music-player-modal #char-music-lyrics::-webkit-scrollbar {
               display: none;
           }

           #char-music-player-modal #char-music-lyrics {
               -ms-overflow-style: none;
               scrollbar-width: none;
           }

           @keyframes spin-vinyl {
               from {
                   transform: rotate(0deg);
               }

               to {
                   transform: rotate(360deg);
               }
           }

           #char-music-player-modal .modal-content {
               width: 340px !important;
               height: auto !important;
               background-color: #f0f1f3 !important;
               border-radius: 12px !important;
               box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1) !important;
               color: #333 !important;
               display: flex;
               flex-direction: column;
               padding: 20px;
               position: relative;
           }

           #char-music-player-modal .modal-header {
               display: none !important;
           }

           #char-music-player-modal .char-player-close-btn {
               position: absolute;
               top: 15px;
               right: 15px;
               background: none;
               border: none;
               font-size: 24px;
               font-weight: 300;
               color: #aaa;
               cursor: pointer;
               line-height: 1;
               z-index: 10;
           }

           #char-music-player-modal .char-player-body {
               display: flex;
               flex-direction: column;
               align-items: center;
               flex-grow: 1;
           }

           #char-music-player-modal .char-player-song-info {
               text-align: center;
               margin-bottom: 25px;
           }

           #char-music-player-modal #char-music-player-title {
               font-size: 20px;
               font-weight: 600;
               margin: 0 0 5px 0;
           }

           #char-music-player-modal #char-music-artist {
               font-size: 14px;
               color: #888;
               margin: 0;
           }

           #char-music-player-modal #char-vinyl-container {
               width: 210px;
               height: 210px;
               border-radius: 50%;
               background-color: #222;
               padding: 15px;
               box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2),
                   inset 0 0 0 2px rgba(255, 255, 255, 0.05);
               background-image: repeating-radial-gradient(circle, #333, #333 1px, #222 1px, #222 2px);
               box-sizing: border-box;
               margin-bottom: 25px;
           }

           #char-music-player-modal #char-vinyl-container.spinning {
               animation: spin-vinyl 12s linear infinite;
           }

           #char-music-player-modal #char-music-cover {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
           }

           #char-music-player-modal #char-lyric-placeholder {
               color: #aaa;
               font-size: 18px;
               letter-spacing: 5px;
               margin-bottom: 25px;
           }

           #char-music-player-modal .char-player-footer {
               width: 100%;
               margin-top: auto;
           }

           #char-music-player-modal .char-player-progress-bar-container {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-bottom: 10px;
           }

           #char-music-player-modal .char-player-progress-bar {
               flex-grow: 1;
               height: 4px;
               background-color: #e0e0e0;
               border-radius: 2px;
               cursor: pointer;
           }

           #char-music-player-modal #char-music-progress-fill {
               width: 0%;
               height: 100%;
               background-color: #555;
               border-radius: 2px;
           }

           #char-music-player-modal .char-player-controls {
               display: flex;
               align-items: center;
               justify-content: center;
               gap: 20px;
           }

           #char-music-player-modal .char-player-controls .control-btn {
               background: none;
               border: none;
               color: #555;
               cursor: pointer;
               transition: color 0.2s;
               padding: 5px;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           #char-music-player-modal .char-player-controls .control-btn:hover {
               color: #000;
           }

           #char-music-player-modal .char-player-controls .control-btn.play {
               width: 50px;
               height: 50px;
               background-color: #e0e1e3;
               border-radius: 50%;
               color: #333;
           }

           #char-music-player-modal .char-player-controls .control-btn.mode {
               font-size: 14px;
               font-weight: 500;
               width: 50px;
           }

           #char-music-player-modal #char-music-lyrics {
               /* display: none; */
           }

           @keyframes spin-vinyl {
               from {
                   transform: rotate(0deg);
               }

               to {
                   transform: rotate(360deg);
               }
           }

           #char-music-player-modal .modal-content {
               width: 340px !important;
               height: auto !important;
               background-color: #f0f1f3 !important;
               border-radius: 12px !important;
               box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1) !important;
               color: #333 !important;
               display: flex;
               flex-direction: column;
               padding: 20px;
               position: relative;
           }

           #char-music-player-modal .modal-header {
               display: none !important;
           }

           #char-music-player-modal .char-player-close-btn {
               position: absolute;
               top: 15px;
               right: 15px;
               background: none;
               border: none;
               font-size: 24px;
               font-weight: 300;
               color: #aaa;
               cursor: pointer;
               line-height: 1;
               z-index: 10;
           }

           #char-music-player-modal .char-player-body {
               display: flex;
               flex-direction: column;
               align-items: center;
               flex-grow: 1;
           }

           #char-music-player-modal .char-player-song-info {
               text-align: center;
               margin-bottom: 25px;
           }

           #char-music-player-modal #char-music-player-title {
               font-size: 20px;
               font-weight: 600;
               margin: 0 0 5px 0;
           }

           #char-music-player-modal #char-music-artist {
               font-size: 14px;
               color: #888;
               margin: 0;
           }

           #char-music-player-modal #char-vinyl-container {
               width: 210px;
               height: 210px;
               border-radius: 50%;
               background-color: #222;
               padding: 15px;
               box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2),
                   inset 0 0 0 2px rgba(255, 255, 255, 0.05);
               background-image: repeating-radial-gradient(circle, #333, #333 1px, #222 1px, #222 2px);
               box-sizing: border-box;
               margin-bottom: 25px;
           }

           #char-music-player-modal #char-vinyl-container.spinning {
               animation: spin-vinyl 12s linear infinite;
           }

           #char-music-player-modal #char-music-cover {
               width: 100%;
               height: 100%;
               border-radius: 50%;
               object-fit: cover;
           }

           #char-music-player-modal #char-music-lyrics {
               width: 100%;
               height: 50px;
               overflow: hidden;
               position: relative;
               margin-bottom: 25px;
               font-size: 14px;
               line-height: 25px;
               color: #888;
               text-align: center;
               transition: all 0.3s ease;
           }

           #char-music-player-modal #char-music-lyrics p {
               margin: 0;
               transition: all 0.3s ease;
           }

           #char-music-player-modal #char-music-lyrics p.active {
               color: #000;
               font-weight: 600;
               font-size: 16px;
           }

           #char-music-player-modal .char-player-footer {
               width: 100%;
               margin-top: auto;
           }

           #char-music-player-modal .char-player-progress-bar-container {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-bottom: 10px;
           }

           #char-music-player-modal .char-player-progress-bar {
               flex-grow: 1;
               height: 4px;
               background-color: #e0e0e0;
               border-radius: 2px;
               cursor: pointer;
           }

           #char-music-player-modal #char-music-progress-fill {
               width: 0%;
               height: 100%;
               background-color: #555;
               border-radius: 2px;
           }

           #char-music-player-modal .char-player-controls {
               display: flex;
               align-items: center;
               justify-content: center;
               gap: 20px;
           }

           #char-music-player-modal .char-player-controls .control-btn {
               background: none;
               border: none;
               color: #555;
               cursor: pointer;
               transition: color 0.2s;
               padding: 5px;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           #char-music-player-modal .char-player-controls .control-btn:hover {
               color: #000;
           }

           #char-music-player-modal .char-player-controls .control-btn.play {
               width: 50px;
               height: 50px;
               background-color: #e0e1e3;
               border-radius: 50%;
               color: #333;
           }

           #char-music-player-modal .char-player-controls .control-btn.mode {
               font-size: 14px;
               font-weight: 500;
               width: 50px;
           }

           #chat-list .chat-list-item {
               gap: 15px !important;
               justify-content: flex-start !important;
           }

           #chat-list .chat-list-item .avatar-group {
               margin-right: 0 !important;
           }

           #douban-screen {
               background-color: #F6F6F1;
           }

           #phone-screen.dark-mode #douban-screen {
               background-color: #1a1a1a;
           }

           #douban-posts-list {
               padding: 0;
               display: flex;
               flex-direction: column;
           }

           .douban-post-item {
               background-color: var(--secondary-bg);
               padding: 12px 15px;
               border: none;
               box-shadow: none;
               border-bottom: 1px solid var(--border-color);
               cursor: pointer;
               transition: background-color 0.2s;
           }

           .douban-post-item:hover {
               background-color: #f9f9f9;
           }

           #phone-screen.dark-mode .douban-post-item:hover {
               background-color: #2c2c2e;
           }

           .douban-post-header {
               display: flex;
               align-items: center;
               gap: 10px;
               margin-bottom: 12px;
           }

           .douban-post-avatar {
               width: 32px;
               height: 32px;
               border-radius: 50%;
               object-fit: cover;
           }

           .douban-author-info {
               flex-grow: 1;
           }

           .douban-author-name {
               font-weight: 500;
               color: var(--text-primary);
               font-size: 14px;
           }

           .douban-group-name {
               font-size: 12px;
               color: #007722;
               font-weight: 500;
           }

           .douban-post-title {
               font-size: 16px;
               font-weight: 600;
               margin-bottom: 8px;
               color: var(--text-primary);
           }

           .douban-post-content {
               font-size: 14px;
               color: #555;
               line-height: 1.7;
               white-space: pre-wrap;
               word-break: break-word;
               display: -webkit-box;
               -webkit-line-clamp: 4;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           #phone-screen.dark-mode .douban-post-content {
               color: #dcdcdc;
           }

           .douban-post-footer {
               margin-top: 15px;
               padding-top: 10px;
               border-top: 1px solid #f0f0f0;
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 13px;
               color: var(--text-secondary);
           }

           .douban-post-actions {
               display: flex;
               gap: 20px;
           }

           .douban-post-actions span {
               display: flex;
               align-items: center;
               gap: 6px;
               color: var(--text-secondary);
           }

           .douban-post-actions svg {
               width: 18px;
               height: 18px;
               fill: currentColor;
               position: relative;
               top: -1px;
           }

           .douban-feather-btn {
               font-size: 24px;
               padding: 0;
               width: 38px;
               height: 38px;
               line-height: 38px;
               text-align: center;
               border-radius: 50%;
               border: none;
               cursor: pointer;
               display: flex;
               justify-content: center;
               align-items: center;
               flex-shrink: 0;
               margin-right: 8px;
               background-color: #f0f2f5;
               color: #555;
               transition: background-color 0.2s;
           }

           .douban-feather-btn:hover {
               background-color: #e2e6ea;
           }

           .douban-feather-btn svg {
               width: 20px;
               height: 20px;
           }

           #douban-post-detail-screen {
               background-color: #F6F6F1;
           }

           #phone-screen.dark-mode #douban-post-detail-screen {
               background-color: #1a1a1a;
           }

           #douban-detail-content-wrapper {
               background-color: var(--secondary-bg);
               padding: 0;
               padding-bottom: 80px;
           }

           #douban-post-detail-body {
               padding: 20px 18px 25px 18px;
               border-bottom: 1px solid #f0f0f0;
           }

           #phone-screen.dark-mode #douban-post-detail-body {
               border-bottom-color: #38383a;
           }

           .douban-post-title {
               font-size: 18px;
               font-weight: 600;
               margin-bottom: 15px;
               line-height: 1.5;
           }

           .douban-detail-content {
               white-space: pre-wrap;
               line-height: 1.8;
               font-size: 15px;
               color: #333;
           }

           #phone-screen.dark-mode .douban-detail-content {
               color: #dcdcdc;
           }

           .douban-comments-section {
               margin-top: 0;
               padding: 15px 18px;
           }

           .douban-comments-section h4 {
               font-size: 14px;
               font-weight: 500;
               color: var(--text-secondary);
               margin: 0 0 15px 0;
               padding-bottom: 10px;
               border-bottom: 1px solid #f0f0f0;
           }

           #phone-screen.dark-mode .douban-comments-section h4 {
               border-bottom-color: #38383a;
           }

           .douban-comment-item {
               display: flex;
               gap: 12px;
               padding: 15px 0;
               border-bottom: 1px solid #f0f0f0;
           }

           .douban-comment-item:last-child {
               border-bottom: none;
           }

           #phone-screen.dark-mode .douban-comment-item {
               border-bottom-color: #38383a;
           }

           .douban-comment-avatar {
               width: 32px;
               height: 32px;
               border-radius: 50%;
               flex-shrink: 0;
           }

           .douban-comment-body {
               flex-grow: 1;
           }

           .douban-comment-author {
               font-weight: 500;
               font-size: 14px;
               color: var(--text-primary);
           }

           .douban-comment-text {
               font-size: 14px;
               color: #555;
               margin-top: 6px;
               line-height: 1.7;
               word-break: break-word;
           }

           #phone-screen.dark-mode .douban-comment-text {
               color: #b0b0b0;
           }

           #douban-comment-footer {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               padding: 10px 18px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               box-sizing: border-box;
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
           }

           #douban-send-comment-btn {
               background-color: #007722;
           }

           #douban-screen .header .header-actions {
               flex-shrink: 0;
               display: flex;
               align-items: center;
           }

           .header .action-btn svg {
               width: 24px;
               height: 24px;
               display: block;
           }

           .header .action-btn {
               min-width: 30px;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .header .header-left-actions {
               display: flex;
               align-items: center;
               gap: 15px;
           }

           .char-photo-item {
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 8px;
               box-sizing: border-box;
           }

           .char-photo-description {
               font-size: 13px;
               color: var(--text-secondary);
               text-align: center;
               line-height: 1.5;
               display: -webkit-box;
               -webkit-box-orient: vertical;
               -webkit-line-clamp: 5;
               overflow: hidden;
               word-break: break-all;
           }

           .char-product-description-overlay {
               width: 100%;
               aspect-ratio: 1 / 1;
               background-color: #f7f8fa;
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 15px;
               box-sizing: border-box;
               border-bottom: 1px solid #eee;
               border-radius: 8px 8px 0 0;
           }

           .char-product-description-overlay .char-photo-description,
           .char-browser-image-description {
               font-size: 14px;
               color: var(--text-secondary);
               text-align: center;
               line-height: 1.6;
               display: -webkit-box;
               -webkit-box-orient: vertical;
               -webkit-line-clamp: 6;
               overflow: hidden;
               word-break: break-all;
           }

           .char-browser-image-description {
               padding: 40px 20px;
           }

           .char-product-status {
               font-size: 12px;
               color: #8a8a8a;
               background-color: #f0f2f5;
               padding: 3px 8px;
               border-radius: 10px;
           }

           #search-history-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #search-history-screen {
               background-color: #000000;
           }

           #search-results-list {
               flex-grow: 1;
               overflow-y: auto;
           }

           .date-separator {
               text-align: center;
               color: var(--text-secondary);
               font-size: 12px;
               padding: 10px 0;
               font-weight: 500;
           }

           #phone-screen.dark-mode #search-bar input {
               background-color: #1c1c1e;
               color: #ffffff;
               border-color: #38383a;
           }

           #home-screen {
               flex-direction: column;
               padding: 0;
           }

           #home-screen-pages-container {
               flex-grow: 1;
               width: 100%;
               overflow: hidden;
               position: relative;
           }

           #home-screen-pages {
               display: flex;
               width: 300%;
               height: 100%;
               transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }

           .home-screen-page {
               width: 33.333%;
               height: 100%;
               padding: 20px;
               padding-top: calc(20px + env(safe-area-inset-top));
               padding-bottom: 0;
               box-sizing: border-box;
               display: flex;
               flex-direction: column;
               align-items: center;
           }

           #home-screen-pagination {
               display: flex;
               justify-content: center;
               gap: 8px;
               padding: 10px 0;
               padding-bottom: calc(10px + env(safe-area-inset-bottom) / 2);
               flex-shrink: 0;
           }

           .pagination-dot {
               width: 8px;
               height: 8px;
               border-radius: 50%;
               background-color: rgba(255, 255, 255, 0.4);
               transition: all 0.3s ease;
           }

           .pagination-dot.active {
               background-color: white;
               transform: scale(1.1);
           }

           .draggable-button-item {
               padding: 8px 12px;
               background-color: var(--secondary-bg);
               border: 1px solid var(--border-color);
               border-radius: 20px;
               cursor: grab;
               display: flex;
               align-items: center;
               gap: 6px;
               font-size: 14px;
               font-weight: 500;
               transition: background-color 0.2s, box-shadow 0.2s;
               user-select: none;
           }

           .draggable-button-item:active {
               cursor: grabbing;
           }

           .draggable-button-item svg {
               width: 18px;
               height: 18px;
               stroke-width: 2;
           }

           .draggable-button-item.dragging {
               opacity: 0.5;
               background-color: #e0e0e0;
           }

           .draggable-button-item.drag-over {
               background-color: #d0eaff;
               box-shadow: 0 0 0 2px var(--accent-color);
           }

           .draggable-button-item.dragging {
               opacity: 0.5;
               background-color: #e0e0e0;
               position: relative;
               z-index: 10;
           }

           #button-order-editor {
               -webkit-user-select: none;
               -moz-user-select: none;
               -ms-user-select: none;
               user-select: none;
           }

           .scrollable-content-preview {
               max-height: 35vh;
               overflow-y: auto;
               background-color: #f0f2f5;
               padding: 10px 15px;
               border-radius: 8px;
               text-align: left;
               white-space: pre-wrap;
               border: 1px solid var(--border-color);
           }

           .wizard-step {
               display: none;
               flex-direction: column;
               width: 100%;
               height: 100%;
           }

           .wizard-step.active {
               display: flex;
           }

           #data-clear-char-list .clear-posts-item,
           #data-clear-type-list .clear-posts-item {
               padding: 12px 18px;
           }

           #data-clear-wizard-modal .modal-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           #data-clear-wizard-modal .modal-header label {
               font-size: 14px;
               font-weight: normal;
               display: flex;
               align-items: center;
               gap: 5px;
               cursor: pointer;
           }

           #tutorial-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #tutorial-screen {
               background-color: #000000;
           }

           .entry-content-container {
               display: none;
               margin-top: 8px;
           }

           .toggle-content-btn {
               background: none;
               border: 1px solid #ccc;
               color: var(--text-secondary);
               font-size: 12px;
               padding: 2px 8px;
               border-radius: 5px;
               cursor: pointer;
           }

           #update-notice-modal {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.4);
               display: none;
               align-items: center;
               justify-content: center;
               z-index: 2000;
               opacity: 0;
               transition: opacity 0.3s ease;
           }

           #update-notice-modal.visible {
               display: flex;
               opacity: 1;
           }

           .update-notice-content {
               background-color: var(--secondary-bg);
               width: 300px;
               border-radius: 14px;
               box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
               display: flex;
               flex-direction: column;
               transform: scale(0.95);
               transition: transform 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28);
           }

           #update-notice-modal.visible .update-notice-content {
               transform: scale(1);
           }

           .update-notice-body {
               padding: 20px;
               font-size: 15px;
               line-height: 1.6;
               color: #333;
               max-height: 60vh;
               overflow-y: auto;
           }

           .update-notice-footer {
               border-top: 1px solid #dbdbdb;
               display: flex;
           }

           .update-notice-footer button {
               flex: 1;
               background: none;
               border: none;
               padding: 14px;
               font-size: 17px;
               cursor: pointer;
               color: var(--accent-color);
           }

           .update-notice-footer button:first-child {
               border-right: 1px solid #dbdbdb;
               font-weight: 600;
           }

           #message-actions-modal .custom-modal-footer {
               flex-wrap: wrap;
               padding: 10px;
               gap: 10px;
               justify-content: flex-start;
           }

           #message-actions-modal .custom-modal-footer button:not(#cancel-message-action-btn) {
               flex-grow: 1;
               flex-basis: 75px;
               border: none;
               background-color: #f0f2f5;
               border-radius: 8px;
               padding: 12px 5px;
               font-size: 16px;
               font-weight: 500;
           }

           #message-actions-modal #cancel-message-action-btn {
               width: 100%;
               flex-basis: 100%;
               margin-top: 8px;
               border-radius: 8px;
               background-color: #f0f2f5;
               font-weight: 600;
           }

           input,
           textarea,
           select {
               font-size: 16px !important;
           }

           #favorite-diary-btn.active svg {
               fill: #ffc107;
               color: #ffc107;
           }

           .favorite-item-card .diary-title {
               font-weight: 600;
               display: block;
               margin-bottom: 8px;
               font-size: 15px;
           }

           .favorite-item-card .diary-content-preview {
               font-size: 13px;
               opacity: 0.8;
               line-height: 1.6;
               display: -webkit-box;
               -webkit-line-clamp: 3;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           .favorite-item-card .diary-content-preview {
               font-size: 13px;
               opacity: 0.8;
               line-height: 1.6;
               display: -webkit-box;
               -webkit-line-clamp: 3;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           #npc-list-view {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #npc-list-view {
               background-color: #000;
           }

           #chat-lock-content {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 15px;
           }

           .spectator-actions-container {
               display: flex;
               gap: 12px;
               align-items: center;
           }

           #chat-lock-content .lock-action-btn.secondary {
               background-color: transparent;
               color: var(--accent-color);
               border: 1px solid var(--accent-color);
               padding: 8px 18px;
               font-size: 14px;
           }

           .spectator-actions-container .lock-action-btn.secondary svg {
               width: 20px;
               height: 20px;
               stroke: currentColor;
           }

           .music-player-window {
               position: relative;
               background-color: rgba(255, 255, 255, 0.75);
           }

           .music-player-window::before {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-image: var(--music-bg-image);
               background-size: cover;
               background-position: center;
               filter: blur(15px) brightness(0.8);
               z-index: -1;
               border-radius: inherit;
               transition: background-image 0.5s ease-in-out;
           }

           .music-player-window.bg-clear::before {
               filter: none;
           }

           #toggle-blur-btn {
               background: none;
               border: none;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               color: #333;
               width: 44px;
               height: 44px;
               display: flex;
               justify-content: center;
               align-items: center;
               transition: all 0.2s ease;
               border-radius: 50%;
               background-color: rgba(0, 0, 0, 0.05);
           }

           #toggle-blur-btn.active {
               background-color: var(--accent-color);
               color: white;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
           }

           .music-player-window.fullscreen {
               width: 100%;
               height: 100%;
               max-height: 100%;
               border-radius: 0;
               transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }

           #music-player-overlay.fullscreen-active {
               padding-top: 0;
               align-items: stretch;
           }

           #toggle-fullscreen-btn {
               background: none;
               border: none;
               font-size: 22px;
               cursor: pointer;
               color: #555;
               padding: 5px;
               line-height: 1;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: color 0.2s;
           }

           #toggle-fullscreen-btn:hover {
               color: #000;
           }

           #toggle-fullscreen-btn .icon-minimize {
               display: none;
           }

           .music-player-window.fullscreen #toggle-fullscreen-btn .icon-maximize {
               display: none;
           }

           .music-player-window.fullscreen #toggle-fullscreen-btn .icon-minimize {
               display: block;
           }

           #music-player-avatar-display {
               display: none;
               width: 100%;
               padding: 15px 20px;
               box-sizing: border-box;
               justify-content: space-between;
               align-items: center;
               border-bottom: 1px solid rgba(0, 0, 0, 0.1);
               margin-bottom: 10px;
           }

           .music-player-window.fullscreen #music-player-avatar-display.visible {
               display: flex;
           }

           .participant-display-avatar {
               width: 50px;
               height: 50px;
               border-radius: 50%;
               object-fit: cover;
               box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
           }

           #show-avatars-btn {
               background: none;
               border: none;
               cursor: pointer;
               padding: 5px;
               display: none;
               align-items: center;
               justify-content: center;
               opacity: 0.6;
               transition: opacity 0.2s;
           }

           .music-player-window.fullscreen #show-avatars-btn {
               display: flex;
           }

           #show-avatars-btn:hover {
               opacity: 1;
           }

           #show-avatars-btn.active {
               opacity: 1;
           }

           .douban-settings-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .douban-settings-item label {
               margin-bottom: 0;
               flex-grow: 1;
           }

           .douban-settings-controls {
               display: flex;
               align-items: center;
               gap: 8px;
               flex-shrink: 0;
           }

           .douban-settings-controls input {
               width: 60px;
               text-align: center;
           }

           #time-zone-search-input {
               width: 100%;
               padding: 10px 12px;
               margin-bottom: 8px;
               border: 1px solid var(--border-color);
               border-radius: 6px;
               box-sizing: border-box;
               font-size: 16px;
           }

           #phone-screen.dark-mode #time-zone-search-input {
               background-color: #1c1c1e;
               color: #ffffff;
               border-color: #38383a;
           }

           #werewolf-game-screen {
               background-color: #2c2c2e;
               color: white;
           }

           #werewolf-player-grid {
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
               gap: 15px;
               padding: 15px;
               flex-shrink: 0;
               border-bottom: 1px solid #444;
           }

           .werewolf-player-avatar {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 6px;
               position: relative;
           }

           .werewolf-player-avatar img {
               width: 60px;
               height: 60px;
               border-radius: 50%;
               border: 2px solid #888;
               transition: all 0.3s;
           }

           .werewolf-player-avatar .player-name {
               font-size: 12px;
               font-weight: 500;
               text-shadow: 0 1px 2px black;
           }

           .werewolf-player-avatar.dead img {
               filter: grayscale(100%);
               border-color: #ff3b30;
           }

           .werewolf-player-avatar.dead .player-name {
               color: #ff3b30;
               text-decoration: line-through;
           }

           #werewolf-log {
               padding: 15px;
               background: none;
               display: flex;
               flex-direction: column;
               gap: 12px;
           }

           .werewolf-log-entry {
               background-color: rgba(255, 255, 255, 0.08);
               padding: 8px 12px;
               border-radius: 8px;
               font-size: 14px;
               line-height: 1.6;
           }

           .werewolf-log-entry.system {
               text-align: center;
               color: #ffc107;
               font-style: italic;
               background-color: rgba(255, 193, 7, 0.1);
           }

           .werewolf-log-entry .speaker {
               font-weight: bold;
           }

           #werewolf-action-bar {
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(0, 0, 0, 0.3);
               flex-shrink: 0;
               text-align: center;
           }

           #werewolf-next-step-btn {
               width: 100%;
           }

           #werewolf-role-card {
               background: linear-gradient(135deg, #4a4a4a, #2a2a2a);
               border: 1px solid #666;
               border-radius: 12px;
               padding: 20px;
               color: white;
           }

           #werewolf-role-name {
               font-size: 22px;
               font-weight: bold;
               color: #ffc107;
               margin-bottom: 10px;
           }

           #werewolf-role-description {
               font-size: 14px;
               line-height: 1.6;
           }

           .werewolf-selection-item {
               display: flex;
               align-items: center;
               padding: 12px 18px;
               cursor: pointer;
               border-bottom: 1px solid var(--border-color);
           }

           .werewolf-selection-item.selected {
               background-color: var(--accent-color);
               color: white;
           }

           .werewolf-selection-item img {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               margin-right: 15px;
           }

           .werewolf-selection-item .name {
               font-weight: 500;
           }

           #werewolf-game-screen #werewolf-action-bar {
               background-color: rgba(0, 0, 0, 0.3);
               border-top: 1px solid rgba(255, 255, 255, 0.1);
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
           }

           #werewolf-game-screen #werewolf-user-input {
               flex-grow: 1;
               border: none;
               padding: 10px 15px;
               border-radius: 20px;
               background-color: rgba(255, 255, 255, 0.1);
               color: #f0f0f0;
               font-size: 16px;
               resize: none;
               height: 40px;
               box-sizing: border-box;
           }

           #werewolf-game-screen #werewolf-user-input::placeholder {
               color: #8d8d92;
           }

           #werewolf-game-screen #input-actions-wrapper button {
               height: 40px;
               padding: 0 15px;
               border-radius: 20px;
               border: none;
               color: white;
               font-weight: 600;
               cursor: pointer;
               flex-shrink: 0;
           }

           #werewolf-game-screen #werewolf-wait-reply-btn {
               background-color: #555;
           }

           #werewolf-game-screen #werewolf-finish-speech-btn {
               background-color: #c62828;
           }

           #sticker-search-container {
               padding: 10px 15px;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
           }

           #sticker-search-input {
               width: 100%;
               padding: 10px 15px;
               font-size: 16px;
               border: 1px solid var(--border-color);
               border-radius: 18px;
               background-color: #f0f2f5;
               box-sizing: border-box;
               outline: none;
               -webkit-appearance: none;
           }

           #sticker-search-input:focus {
               border-color: var(--accent-color);
               background-color: var(--secondary-bg);
           }

           #phone-screen.dark-mode #sticker-search-input {
               background-color: #2c2c2e;
               color: #f0f0f0;
               border-color: #38383a;
           }

           #phone-screen.dark-mode #sticker-search-input:focus {
               background-color: #38383a;
           }

           .message-bubble .content {
               transition: background-color 0.5s ease-out;
           }

           .message-bubble.highlighted .content {
               background-color: rgba(0, 123, 255, 0.2) !important;
           }

           .loader-container {
               display: flex;
               justify-content: center;
               align-items: center;
               padding: 10px 0;
               width: 100%;
               height: 44px;
               box-sizing: border-box;
           }

           .spinner {
               width: 24px;
               height: 24px;
               border: 3px solid rgba(0, 0, 0, 0.1);
               border-top-color: var(--accent-color);
               border-radius: 50%;
               animation: spin 1s linear infinite;
           }

           #phone-screen.dark-mode .spinner {
               border: 3px solid rgba(255, 255, 255, 0.2);
               border-top-color: #fff;
           }

           #reading-overlay {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               z-index: 150;
               display: flex;
               justify-content: center;
               align-items: center;
               pointer-events: none;
               display: none;
           }

           #reading-window {
               width: 90%;
               max-width: 340px;
               height: 60vh;
               max-height: 480px;
               background-color: rgba(255, 255, 255, 0.7);
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border-radius: 18px;
               box-shadow: 0 8px 32px rgba(31, 38, 135, 0.2);
               border: 1px solid rgba(255, 255, 255, 0.18);
               display: flex;
               flex-direction: column;
               pointer-events: auto;
               position: absolute;
               transition: transform 0.3s ease, opacity 0.3s ease, visibility 0s 0.3s;
           }

           #phone-screen.dark-mode #reading-window {
               background-color: rgba(40, 40, 42, 0.7);
           }

           .reading-header {
               cursor: move;
               user-select: none;
               -webkit-user-select: none;
               flex-shrink: 0;
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 12px 15px;
               border-bottom: 1px solid var(--border-color);
               gap: 10px;
               flex-wrap: nowrap;
           }

           #reading-title {
               font-weight: 600;
               flex: 1;
               min-width: 0;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .reading-controls {
               flex-shrink: 0;
           }

           .reading-controls button {
               background: none;
               border: none;
               color: var(--text-secondary);
               padding: 4px 8px;
               border-radius: 4px;
               cursor: pointer;
               font-size: 14px;
               transition: background-color 0.2s;
           }

           .reading-controls button:hover {
               background-color: rgba(0, 0, 0, 0.1);
           }

           #minimize-reading-btn {
               font-weight: bold;
               font-size: 16px;
               line-height: 1;
           }

           #reading-window.minimized {
               transform: scale(0.8);
               opacity: 0;
               pointer-events: none;
               visibility: hidden;
           }

           #reading-restore-btn {
               position: absolute;
               top: 50%;
               right: 15px;
               transform: translateY(-50%);
               width: 50px;
               height: 50px;
               background-color: rgba(255, 255, 255, 0.8);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 28px;
               cursor: move;
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
               pointer-events: auto;
               z-index: 160;
               transition: transform 0.2s;
           }

           #reading-restore-btn:active {
               transform: translateY(-50%) scale(0.95);
           }

           #phone-screen.dark-mode #reading-restore-btn {
               background-color: rgba(50, 50, 52, 0.8);
           }

           #reading-content {
               flex-grow: 1;
               overflow-y: auto;
               padding: 15px;
               font-size: 15px;
               line-height: 1.8;
               white-space: pre-wrap;
               word-break: break-word;
           }

           .reading-footer {
               flex-shrink: 0;
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 12px 15px;
               border-top: 1px solid var(--border-color);
           }

           #page-indicator {
               font-size: 14px;
               color: var(--text-secondary);
               cursor: pointer;
               transition: color 0.2s;
           }

           #page-indicator:hover {
               color: var(--accent-color);
           }

           .reading-footer button {
               padding: 6px 15px;
               border-radius: 15px;
               border: none;
               background-color: var(--accent-color);
               color: white;
               cursor: pointer;
           }

           .reading-footer button:disabled {
               background-color: #ccc;
           }

           #phone-screen.dark-mode .reading-footer button:disabled {
               background-color: #555;
           }

           #reading-library-search-container {
               padding: 10px 15px;
               border-bottom: 1px solid var(--border-color);
               flex-shrink: 0;
           }

           #reading-library-search-input {
               width: 100%;
               padding: 10px 12px;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               box-sizing: border-box;
               font-size: 16px;
               -webkit-appearance: none;
           }

           #phone-screen.dark-mode #reading-library-search-input {
               background-color: #2c2c2e;
               color: #f0f0f0;
               border-color: #38383a;
           }

           .voice-message-body {
               display: flex;
               align-items: center;
               cursor: pointer;
               min-width: 80px;
               max-width: 220px;
               padding: 8px 12px;
           }

           .message-bubble.user .voice-message-body {
               color: #1a3d00;
               flex-direction: row-reverse;
           }

           .message-bubble.ai .voice-message-body {
               color: var(--text-primary);
           }

           .voice-play-btn {
               width: 28px;
               height: 28px;
               border-radius: 50%;
               border: none;
               background-color: rgba(0, 0, 0, 0.1);
               color: currentColor;
               font-size: 16px;
               display: flex;
               align-items: center;
               justify-content: center;
               cursor: pointer;
               flex-shrink: 0;
               transition: background-color 0.2s;
           }

           /* 录音按钮样式 */
           #voice-record-btn {
               transition: all 0.3s ease;
           }

           #voice-record-btn:hover {
               transform: scale(1.1);
           }

           #voice-record-btn:active {
               transform: scale(0.95);
           }

           .voice-play-btn:hover {
               background-color: rgba(0, 0, 0, 0.2);
           }

           .voice-spinner {
               width: 20px;
               height: 20px;
               border: 2px solid rgba(0, 0, 0, 0.2);
               border-top-color: var(--accent-color);
               border-radius: 50%;
               animation: spin 1s linear infinite;
               display: none;
               margin: 4px;
           }

           .voice-duration {
               font-size: 14px;
               font-weight: 500;
               margin: 0 10px;
               flex-shrink: 0;
           }

           .message-bubble.user .voice-duration {
               color: #3e6224;
           }

           #product-category-tabs {
               display: flex;
               overflow-x: auto;
               padding: 10px 15px 0 15px;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
               -ms-overflow-style: none;
               scrollbar-width: none;
           }

           #product-category-tabs::-webkit-scrollbar {
               display: none;
           }

           .product-category-tab {
               padding: 8px 16px;
               cursor: pointer;
               border: none;
               background-color: transparent;
               font-size: 15px;
               font-weight: 500;
               color: var(--text-secondary);
               border-bottom: 2px solid transparent;
               margin-bottom: -1px;
               transition: all 0.2s ease-in-out;
               white-space: nowrap;
               flex-shrink: 0;
           }

           .product-category-tab.active {
               color: #FF5722;
               border-bottom-color: #FF5722;
               font-weight: 600;
           }

           #phone-screen.dark-mode .product-category-tab.active {
               color: #FF8A65;
               border-bottom-color: #FF8A65;
           }

           #product-category-tabs {
               overflow-x: auto;
               white-space: nowrap;
               -webkit-overflow-scrolling: touch;
               scrollbar-width: none;
               -ms-overflow-style: none;
           }

           #product-category-tabs::-webkit-scrollbar {
               display: none;
           }

           .product-category-tab {
               flex-shrink: 0;
           }

           #shopping-screen.management-mode .product-item {
               cursor: pointer;
           }

           #shopping-screen.management-mode .product-management-overlay {
               display: none;
           }

           #shopping-screen.management-mode .product-item::before {
               content: '';
               position: absolute;
               top: 10px;
               right: 10px;
               width: 22px;
               height: 22px;
               border: 2px solid #ccc;
               border-radius: 50%;
               background-color: rgba(255, 255, 255, 0.7);
               transition: all 0.2s ease;
               z-index: 6;
           }

           #shopping-screen.management-mode .product-item.selected::before {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
               content: '✔';
               color: white;
               font-size: 14px;
               text-align: center;
               line-height: 22px;
           }

           #shopping-screen.management-mode .product-item:not(.selected) {
               opacity: 0.8;
           }

           #shopping-action-bar {
               position: absolute;
               bottom: 0;
               left: 0;
               right: 0;
               width: auto;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               box-sizing: border-box;
               z-index: 5;
               display: none;
               justify-content: space-between;
               align-items: center;
           }

           #shopping-action-bar .select-all-label {
               display: flex;
               align-items: center;
               gap: 8px;
               font-size: 16px;
               color: var(--text-primary);
               cursor: pointer;
           }

           #shopping-action-bar .action-bar-btn {
               padding: 10px 25px;
               border-radius: 20px;
               border: none;
               font-size: 15px;
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
           }

           .polaroid-widget-container {
               width: 100%;
               display: flex;
               flex-direction: column;
               align-items: center;
               margin-bottom: 30px;
               flex-shrink: 0;
               margin-top: 20px;
           }

           .polaroid-photos {
               display: flex;
               justify-content: center;
               align-items: center;
               gap: 5px;
           }

           .polaroid-photo {
               background-color: white;
               padding: 8px 8px 15px 8px;
               border-radius: 4px;
               box-shadow: 0 5px 12px rgba(0, 0, 0, 0.2);
               transition: transform 0.25s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.25s;
               width: 80px;
               flex-shrink: 0;
           }

           .polaroid-photo:hover {
               transform: scale(1.1) rotate(0deg) !important;
               box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
               z-index: 10;
           }

           .polaroid-photo img {
               width: 100%;
               display: block;
               aspect-ratio: 1 / 1;
               object-fit: cover;
           }

           .polaroid-widget-title {
               margin-top: 15px;
               font-size: 13px;
               font-weight: 500;
               color: white;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
           }

           #page-2-app-container {
               display: grid;
               grid-template-columns: 155px 1fr;
               gap: 15px;
               width: 100%;
               padding-top: 20px;
               align-items: start;
           }

           .app-subgrid {
               display: grid;
               grid-template-columns: 1fr 1fr;
               gap: 15px;
           }

           .large-widget {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
           }

           .large-widget-img {
               width: 100%;
               aspect-ratio: 1 / 1;
               border-radius: 22px;
               object-fit: cover;
               box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
           }

           .large-widget-label {
               color: white;
               font-size: 13px;
               font-weight: 500;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
           }

           .small-widget {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
           }

           .small-widget-icon-wrapper {
               width: 55px;
               height: 55px;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .small-widget-img {
               width: 100%;
               height: 100%;
               object-fit: cover;
               border-radius: 14px;
           }

           .small-widget-label {
               color: white;
               font-size: 13px;
               font-weight: 500;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
           }

           #page-2-app-container .small-widget-label {
               color: #000 !important;
               text-shadow: none !important;
           }

           #phone-screen.dark-mode #char-diary-list .list-item .item-title,
           #phone-screen.dark-mode #char-diary-list .list-item .item-content,
           #phone-screen.dark-mode #char-memo-list .list-item .item-title,
           #phone-screen.dark-mode #char-memo-list .list-item .item-content,
           #phone-screen.dark-mode #char-browser-history .char-browser-item .title,
           #phone-screen.dark-mode #char-usage-list .usage-item-name,
           #phone-screen.dark-mode #char-music-list .music-item-name {
               color: #f0f0f0;
           }

           #phone-screen.dark-mode #char-diary-list .list-item .item-content,
           #phone-screen.dark-mode #char-browser-history .char-browser-item .url,
           #phone-screen.dark-mode #char-usage-list .usage-item-category,
           #phone-screen.dark-mode #char-music-list .music-item-artist {
               color: #a0a0a0;
           }

           #phone-screen.dark-mode #char-diary-detail-content .diary-highlight {
               background-color: rgba(255, 223, 100, 0.2);
               color: #FFD700;
           }

           #phone-screen.dark-mode #char-diary-detail-content .diary-underline {
               border-bottom-color: #FF85B3;
           }

           #phone-screen.dark-mode #char-diary-detail-content .diary-emphasis {
               color: #FF85B3;
           }

           #phone-screen.dark-mode #char-diary-detail-content .diary-handwritten,
           #phone-screen.dark-mode #char-diary-detail-content .diary-messy {
               color: #dcdcdc;
           }

           #phone-screen.dark-mode .spoiler {
               background-color: #444;
               color: #444;
           }

           #phone-screen.dark-mode .spoiler:hover,
           #phone-screen.dark-mode .spoiler:active {
               background-color: #555;
               color: #fff;
           }

           #avatar-frame-modal .frame-grid.management-mode .frame-item {
               cursor: pointer;
           }

           #avatar-frame-modal .frame-grid.management-mode .frame-item:has(.delete-btn)::after {
               content: '';
               position: absolute;
               top: -2px;
               left: -2px;
               width: calc(100% + 4px);
               height: calc(100% + 4px);
               border: 3px solid transparent;
               border-radius: 12px;
               box-sizing: border-box;
               transition: border-color 0.2s;
               pointer-events: none;
           }

           #avatar-frame-modal .frame-grid.management-mode .frame-item.selected::after {
               border-color: var(--accent-color);
           }

           #frame-action-bar {
               display: none;
               flex-shrink: 0;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               justify-content: space-between;
               align-items: center;
           }

           #frame-action-bar .select-all-label {
               font-size: 16px;
               color: var(--text-primary);
               cursor: pointer;
           }

           #frame-action-bar .action-bar-btn {
               padding: 10px 25px;
               border-radius: 20px;
               border: none;
               font-size: 15px;
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
           }

           #favorite-memo-btn.active svg {
               fill: #ffc107;
               color: #ffc107;
           }

           .favorite-item-card .memo-title {
               font-weight: 600;
               display: block;
               margin-bottom: 8px;
               font-size: 15px;
           }

           #chat-interface-screen .back-btn {
               position: relative;
           }

           .back-btn .unread-indicator {
               position: absolute;
               top: -2px;
               right: -10px;
               min-width: 18px;
               height: 18px;
               padding: 0 5px;
               background-color: #ff3b30;
               color: white;
               font-size: 11px;
               font-weight: bold;
               line-height: 18px;
               text-align: center;
               border-radius: 9px;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
               display: none;
               z-index: 20;
               transform: scale(0.8);
           }

           #phone-screen.dark-mode .back-btn .unread-indicator {
               border: 1px solid #333;
           }

           #favorite-article-btn.active svg {
               fill: #ffc107;
               color: #ffc107;
           }

           .modal,
           #custom-modal-overlay,
           #transfer-modal,
           #battery-alert-modal,
           #photo-viewer-modal,
           #character-profile-modal,
           #update-notice-modal {
               background-color: transparent !important;
               backdrop-filter: none !important;
               -webkit-backdrop-filter: none !important;
           }

           #character-profile-modal .jottings .label {
               display: flex !important;
           }

           #total-image-size-display {
               /* <--- 在这里添加了 ID */
               display: flex;
               justify-content: space-between;
               align-items: center;
               font-size: 14px;
               color: var(--text-secondary);
               margin-bottom: 15px;
               padding: 8px 12px;
               background-color: #f0f2f5;
               border-radius: 8px;
               border: 1px solid var(--border-color);
           }

           #phone-screen.dark-mode #total-image-size-display {
               /* <--- 在这里添加了 ID */
               background-color: #2c2c2e;
               border-color: #38383a;
           }

           #total-image-size-display #image-size-label {
               /* <--- 新增 */
               font-weight: 500;
           }

           #total-image-size-display #image-size-value,
           #token-count-display #token-count-value,
           #message-count-display #message-count-value {
               /* <--- 新增 */
               font-weight: 600;
               color: var(--text-primary);
           }

           /* ▼▼▼ RealImag多图布局样式 ▼▼▼ */
           /* 多图容器 */
           .post-images-grid {
               display: grid;
               gap: 8px;
               /* 图片之间的固定间距 */
               margin-top: 10px;
           }

           /* 单张图片 - 大图，等比例缩放 */
           .post-images-grid.grid-1 {
               grid-template-columns: 1fr;
               justify-items: start;
           }

           .post-images-grid.grid-1 .realimag-image,
           .post-images-grid.grid-1 .naiimag-image {
               max-width: 280px;
               max-height: 280px;
               width: auto;
               height: auto;
           }

           /* 2张图片 - 横向并排，等比例缩放 */
           .post-images-grid.grid-2 {
               grid-template-columns: auto auto;
               gap: 5px;
               justify-content: start;
           }

           .post-images-grid.grid-2 .realimag-image,
           .post-images-grid.grid-2 .naiimag-image {
               max-width: 135px;
               max-height: 135px;
               width: auto;
               height: auto;
           }

           /* 3张图片 - 横向排列，等比例缩放 */
           .post-images-grid.grid-3 {
               grid-template-columns: repeat(3, 1fr);
               gap: 5px;
           }

           .post-images-grid.grid-3 .realimag-image {
               max-width: 130px;
               max-height: 130px;
               width: auto;
               height: auto;
           }

           /* 4张图片 - 2x2方格，等比例缩放 */
           .post-images-grid.grid-4 {
               grid-template-columns: repeat(2, 1fr);
               gap: 5px;
           }

           .post-images-grid.grid-4 .realimag-image {
               max-width: 195px;
               max-height: 195px;
               width: auto;
               height: auto;
           }

           /* 5张图片 - 上2下3，等比例缩放 */
           .post-images-grid.grid-5 {
               display: grid;
               grid-template-columns: repeat(6, 1fr);
               gap: 5px;
           }

           .post-images-grid.grid-5 .realimag-image:nth-child(1),
           .post-images-grid.grid-5 .realimag-image:nth-child(2) {
               grid-column: span 3;
               max-width: 195px;
               max-height: 195px;
               width: auto;
               height: auto;
           }

           .post-images-grid.grid-5 .realimag-image:nth-child(n+3) {
               grid-column: span 2;
               max-width: 130px;
               max-height: 130px;
               width: auto;
               height: auto;
           }

           /* 6张图片 - 3x2网格，等比例缩放 */
           .post-images-grid.grid-6 {
               grid-template-columns: repeat(3, 1fr);
               gap: 5px;
           }

           .post-images-grid.grid-6 .realimag-image {
               max-width: 130px;
               max-height: 130px;
               width: auto;
               height: auto;
           }

           /* 7-9张图片 - 3x3九宫格，等比例缩放 */
           .post-images-grid.grid-7,
           .post-images-grid.grid-8,
           .post-images-grid.grid-9 {
               grid-template-columns: repeat(3, 1fr);
               gap: 5px;
           }

           .post-images-grid.grid-7 .realimag-image,
           .post-images-grid.grid-8 .realimag-image,
           .post-images-grid.grid-9 .realimag-image {
               max-width: 130px;
               max-height: 130px;
               width: auto;
               height: auto;
           }

           /* 图片基础样式 - 完整显示，等比例缩放，不裁剪 */
           .post-images-grid .realimag-image,
           .post-images-grid .naiimag-image {
               object-fit: contain;
               border-radius: 8px;
               cursor: pointer;
               transition: transform 0.2s;
           }

           .post-images-grid .realimag-image:hover,
           .post-images-grid .naiimag-image:hover {
               transform: scale(1.05);
           }

           /* ▲▲▲ RealImag多图布局样式结束 ▲▲▲ */
           /* 【修复】解决夜间模式下浏览器和足迹页面文字颜色不正确的问题 */
           #phone-screen.dark-mode #browser-content {
               color: #dcdcdc;
               /* 浏览器文章正文颜色 */
           }

           #phone-screen.dark-mode #browser-content .article-title {
               color: #ffffff;
               /* 浏览器文章标题颜色 */
           }

           #phone-screen.dark-mode #browser-content .article-meta {
               color: #8d8d92;
               /* 浏览器文章元数据（来源）颜色 */
               border-bottom-color: #38383a;
           }

           #phone-screen.dark-mode .amap-item-title {
               color: #f0f0f0;
               /* 足迹 - 地点标题颜色 */
           }

           #phone-screen.dark-mode .amap-item-comment {
               color: #dcdcdc;
               /* 足迹 - 评论内容颜色 */
           }

           /* 【修复】CPhone 浏览器详情页在夜间模式下的文字颜色 */
           #phone-screen.dark-mode #char-article-content {
               color: #dcdcdc;
               /* 设置为浅灰色，使其在深色背景上可见 */
           }

           #char-article-content {
               color: #333;
               /* CPhone 浏览器文章正文 - 白天模式默认颜色 */
           }

           #open-nai-gallery-btn svg path {
               fill: currentColor;
               stroke: none;
           }

           #nai-gallery-panel {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               height: 65%;
               /* 画廊面板高度 */
               background-color: rgba(242, 242, 247, 0.85);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border-top: 1px solid var(--border-color);
               border-radius: 20px 20px 0 0;
               z-index: 200;
               display: flex;
               flex-direction: column;
               transform: translateY(100%);
               transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
               visibility: hidden;
           }

           #nai-gallery-panel.visible {
               transform: translateY(0);
               visibility: visible;
           }

           #nai-gallery-panel-header {
               padding: 10px 20px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               flex-shrink: 0;
               border-bottom: 1px solid var(--border-color);
           }

           #nai-gallery-panel-header .title {
               font-weight: 600;
           }

           #nai-gallery-panel-header .panel-btn {
               font-size: 16px;
               padding: 5px 10px;
               cursor: pointer;
               color: var(--accent-color);
           }

           #nai-gallery-grid {
               flex-grow: 1;
               overflow-y: auto;
               padding: 15px;
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
               gap: 15px;
           }

           .nai-gallery-item {
               position: relative;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 6px;
               cursor: pointer;
               /* 移除了背景、阴影等属性，因为它们将移到子元素上 */
           }

           /* 新增：NAI的图片容器，样式模仿 .sticker-image-container */
           .nai-image-container {
               position: relative;
               /* 用于定位内部的 controls */
               width: 100%;
               aspect-ratio: 1 / 1;
               background-color: white;
               border-radius: 10px;
               background-size: contain;
               /* 核心修改：保持图片完整 */
               background-repeat: no-repeat;
               background-position: center;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
               overflow: hidden;
               /* 隐藏溢出的 controls */
           }

           /* 新增：NAI的文字标签，样式模仿 .sticker-name */
           .nai-gallery-name {
               font-size: 12px;
               color: var(--text-secondary);
               width: 100%;
               text-align: center;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .nai-image-container .nai-gallery-controls {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               padding: 4px;
               background: rgba(0, 0, 0, 0.4);
               display: none;
               /* 仅在管理模式下显示 */
               justify-content: space-around;
               align-items: center;
           }

           .nai-gallery-controls button {
               background: none;
               border: none;
               color: white;
               cursor: pointer;
               padding: 2px;
           }

           .nai-gallery-controls svg {
               width: 16px;
               height: 16px;
           }

           #nai-gallery-grid.management-mode .nai-gallery-controls {
               display: flex;
           }

           #nai-gallery-grid.management-mode .nai-gallery-item::after {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               border: 4px solid transparent;
               border-radius: 10px;
               box-sizing: border-box;
               transition: border-color 0.2s;
               pointer-events: none;
           }

           #nai-gallery-grid.management-mode .nai-gallery-item.selected::after {
               border-color: var(--accent-color);
           }

           #nai-gallery-action-bar {
               display: none;
               flex-shrink: 0;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               justify-content: space-between;
               align-items: center;
               gap: 10px;
               /* <-- 新增了间距 */
           }

           #nai-gallery-action-bar .select-all-label {
               font-size: 16px;
               color: var(--text-primary);
               cursor: pointer;
               flex-grow: 1;
               /* <-- 新增，让“全选”占据剩余空间 */
           }

           #nai-gallery-action-bar .action-bar-btn {
               padding: 10px 15px;
               /* <-- 修改了内边距 */
               border-radius: 20px;
               border: none;
               font-size: 14px;
               /* <-- 修改了字号 */
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
               flex-shrink: 0;
               /* <-- 新增，防止按钮被压缩 */
           }

           /* 适配暗黑模式 */
           #phone-screen.dark-mode #nai-gallery-panel {
               background-color: rgba(28, 28, 30, 0.85);
               border-top-color: #38383a;
           }

           #phone-screen.dark-mode #nai-gallery-panel-header {
               border-bottom-color: #38383a;
           }

           #phone-screen.dark-mode #nai-gallery-grid {
               background-color: #000;
           }

           #phone-screen.dark-mode #nai-gallery-action-bar {
               background-color: rgba(28, 28, 30, 0.9);
               border-top-color: #38383a;
           }

           #phone-screen.dark-mode #nai-gallery-action-bar .select-all-label {
               color: #f0f0f0;
           }

           /* --- NAI 图片重新生成按钮 (V3 - 悬停显示修复版) --- */
           .nai-image-wrapper {
               position: relative;
               /* 关键：必须有这行，用于按钮定位！ */
               display: inline-block;
               line-height: 0;
           }

           .nai-regenerate-btn {
               position: absolute;
               bottom: 10px;
               /* 从底部偏移 10px */
               right: 10px;
               /* 从右侧偏移 10px */
               width: 32px;
               height: 32px;
               background-color: rgba(0, 0, 0, 0.6);
               backdrop-filter: blur(5px);
               -webkit-backdrop-filter: blur(5px);
               border: 1px solid rgba(255, 255, 255, 0.2);
               border-radius: 50%;
               color: white;
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 0;

               /* 核心修复：默认设置为透明，即隐藏 */
               opacity: 0;

               transition: opacity 0.2s ease-in-out;
               z-index: 5;
           }

           /* 核心修复：当鼠标悬停在 *图片包裹层* 上时，才显示按钮 */
           .nai-image-wrapper:hover .nai-regenerate-btn {
               opacity: 0.85;
               /* 悬停时显示 */
           }

           /* 按钮本身的悬停效果（变亮） */
           .nai-regenerate-btn:hover {
               opacity: 1 !important;
               /* 确保悬停在按钮上时更亮 */
               background-color: rgba(0, 0, 0, 0.8);
           }

           .nai-regenerate-btn svg {
               width: 16px;
               height: 16px;
           }

           /* 加载中状态 */
           .nai-regenerate-btn.loading {
               pointer-events: none;
               opacity: 1;
               /* 加载时强制显示 */
           }

           .nai-regenerate-btn.loading svg {
               animation: spin 1s linear infinite;
           }

           /* 修复暗黑模式下的样式 */
           #phone-screen.dark-mode .nai-regenerate-btn {
               background-color: rgba(30, 30, 30, 0.7);
               border-color: rgba(255, 255, 255, 0.2);
           }

           /* --- NAI 图片重新生成按钮 结束 --- */
           /* ▼▼▼ 【新功能】手机外框样式 (374x674px 精确版) ▼▼▼ */

           /* 1. 手机外框的背景 (你想要的白色) */
           body.frame-mode-active {
               background-color: #f0f2f5;
               /* 保持白色背景 */
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 20px;
               box-sizing: border-box;
               overflow: hidden;
           }

           /* 在暗黑模式下，背景则为浅灰色 */
           body.dark-mode.frame-mode-active {
               background-color: #f0f2f5;
           }

           /* 2. 手机外框本身 (使用你计算的精确尺寸) */
           body.frame-mode-active #phone-screen {
               /* 总宽度: 374px
      总高度: 674px
      (这会使内部内容区域精确为 350x650px)
    */
               width: 374px;
               height: 700px;

               /* 12px 的黑色边框 */
               border: 12px solid #ffffff;

               /* 适配的圆角 */
               border-radius: 54px;

               /* 移除内边距 (padding) 来匹配你的计算 */
               /* padding: 0; (移除) */

               /* 覆盖全屏样式 */
               min-height: auto;
               max-width: 100%;
               max-height: 95vh;
               /* 最大高度，防止溢出 */
               box-shadow: inset 0 0 0 1px #000, 0 10px 35px rgba(0, 0, 0, 0.1);
               box-sizing: border-box;
               position: relative;
               overflow: hidden;
           }

           /* 3. 屏幕内部的圆角遮罩 */
           body.frame-mode-active #phone-screen::before {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;

               /* 内部圆角 (比 54px 小 12px) */
               border-radius: 42px;

               /* 移除内边框，因为它不再需要 */
               /* border: 0; (移除) */

               pointer-events: none;
               z-index: 1000;

               /* 添加一个非常细微的内阴影，模拟屏幕玻璃感 */
               box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
           }

           /* 4. 模拟灵动岛 (Dynamic Island) */
           body.frame-mode-active #phone-screen::after {
               content: '';
               position: absolute;
               top: 22px;
               left: 50%;
               transform: translateX(-50%);
               /* 调整为更协调的灵动岛尺寸 (已缩小) */
               width: 100px;
               /* <-- 已从 120px 减小 */
               height: 25px;
               /* <-- 已从 28px 减小 */
               background-color: #000;
               border-radius: 12.5px;
               /* <-- 调整圆角以保持形状 */
               z-index: 1002;
           }

           /* [新增] 当手机外框激活时，等比缩小主屏幕和CPhone/MYPhone内容以适应屏幕 (V3 - 最终布局修复版) */
           body.frame-mode-active #home-screen-pages-container,
           body.frame-mode-active #char-clock-container,
           body.frame-mode-active #char-app-grid,
           body.frame-mode-active #myphone-layout-container {
               transform: scale(0.9);
               transform-origin: top center;
               transition: transform 0.3s ease, margin-top 0.3s ease, margin-bottom 0.3s ease;
               /* 添加过渡效果 */
           }

           /* EPhone 主屏幕的布局修正 */
           body.frame-mode-active #home-screen-pages-container {
               margin-bottom: -55px;
           }

           body.frame-mode-active #home-screen-pagination {
               transform: scale(0.9);
           }

           body.frame-mode-active #desktop-dock {
               transform: scale(0.9);
               margin-bottom: -5px;
           }

           /* ▼▼▼ CPhone 布局的核心修正 ▼▼▼ */
           body.frame-mode-active #char-clock-container {
               /* 替换默认的大间距，给一个适合框内视图的上边距 */
               margin-top: 60px;
               /* 大幅减小下边距，把下面的App图标拉上来 */
               margin-bottom: 50px;
           }

           body.frame-mode-active #char-app-grid {
               /* 移除之前过于激进的负边距，让它自然排列在时钟下方 */
               margin-top: 0;
           }

           /* ▼▼▼ MYPhone 布局的核心修正 ▼▼▼ */
           body.frame-mode-active #myphone-layout-container {
               /* 适配框内视图的上下边距 */
               margin-top: 60px;
               margin-bottom: 50px;
           }

           /* ▲▲▲ 修正结束 ▲▲▲ */
           #dynamic-island-content {
               position: absolute;
               top: 22px;
               /* 与手机外框的刘海伪元素位置完全重合 */
               left: 50%;
               transform: translateX(-50%);
               width: 120px;
               /* 默认宽度，与刘海一致 */
               height: 28px;
               /* 默认高度，与刘海一致 */
               background-color: #000;
               border-radius: 14px;
               z-index: 1003;
               /* 确保在刘海伪元素之上 */

               display: flex;
               align-items: center;
               padding: 3px;
               box-sizing: border-box;

               /* 核心动画：宽度、透明度的变化都带过渡效果 */
               transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);

               /* 默认状态：完全透明，不可见，不响应点击 */
               opacity: 0;
               pointer-events: none;
               visibility: hidden;
               overflow: hidden;
               /* 隐藏内部溢出的内容 */
           }

           /* 2. 当音乐播放时，灵动岛“展开” */
           /* 规则 1: 在有框模式下，调整回刘海的位置并展开 */
           body.frame-mode-active #phone-screen.dynamic-island-active #dynamic-island-content {
               opacity: 1;
               visibility: visible;
               pointer-events: auto;
               width: 190px;
               top: 22px;
               /* 覆盖默认值，对齐刘海 */
           }

           /* 规则 2: 在无框模式下，在顶部展开 */
           body:not(.frame-mode-active) #phone-screen.dynamic-island-active #dynamic-island-content {
               opacity: 1;
               visibility: visible;
               pointer-events: auto;
               width: 190px;
               /* (这里会使用我们在第6303行设置的新top值) */
           }

           /* 3. 同时，隐藏掉原来的刘海伪元素，防止重叠 */
           body.frame-mode-active #phone-screen.dynamic-island-active::after {
               opacity: 0;
           }

           /* 4. 岛内的专辑封面 */
           #island-album-art {
               width: 22px;
               /* 高度28px - 上下各3px内边距 = 22px */
               height: 22px;
               border-radius: 50%;
               object-fit: cover;
               margin-right: 8px;
               flex-shrink: 0;
               /* 防止被压缩 */
           }

           /* 5. 歌词的容器，用于裁剪滚动文字 */
           #island-lyric-container {
               flex-grow: 1;
               /* 占据剩余所有空间 */
               overflow: hidden;
               /* 【关键】裁剪掉超出部分的歌词 */
               white-space: nowrap;
               /* 【关键】强制歌词不换行 */
           }

           #island-lyric-container.center-content {
               display: flex;
               justify-content: center;
           }

           /* 6. 歌词文字本身 */
           #island-lyric-text {
               color: #aeaeae;
               /* 柔和的灰色 */
               font-size: 13px;
               font-weight: 500;
               display: inline-block;
               /* 动画需要 */
               transition: opacity 0.2s ease-in-out;
           }

           /* 您可以在 L2910 附近找到 .frame-mode-active 的相关样式
   然后在这附近添加下面的新规则
*/

           body.frame-mode-active #main-content-area {
               /* * 在这里修改您想要的距离。
     * 原本是 30px，您可以改成 40px 或 50px 来增大间距。
     * * 请注意：在有框模式下，整个主页被 transform: scale(0.9) 缩小了，
     * 所以您设置 50px，视觉上看起来会是 45px。
     */
               gap: 10px;
           }

           /* 仅在有框模式下，修改组件距离顶部的间距 */
           body.frame-mode-active #main-content-area {
               /* * 原本是 20px。
     * 您可以改成 0px 来让它更靠上，
     * 或者改成 40px 来让它更靠下。
     */
               margin-top: 0px;
           }

           /* 仅在有框模式下，调整【第二页】的间距 */
           body.frame-mode-active .home-screen-page:nth-child(2) .polaroid-widget-container {

               /* 1. 修改这个来调整 [拍立得] 与 [屏幕顶部] 的距离 (原为 20px) */
               /* 您可以改成 0px 或 10px 来让它更靠上 */
               margin-top: 0px;

               /* 2. 修改这个来调整 [拍立得] 与 [下方应用/小组件] 的距离 (原为 30px) */
               /* 您可以改成 40px 或 50px 来增大它们之间的间距 */
               margin-bottom: 10px;
           }

           /* 【修复】在有框模式下，增加聊天页面头部的顶部内边距，以避开灵动岛 */
           body.frame-mode-active #chat-interface-screen>.header {
               /* * 灵动岛区域大约在 22px + 25px = 47px 结束。
     * 我们可以设置 55px 或 60px 来给它留出一些呼吸空间。
     */
               padding-top: 48px !important;
           }

           body:not(.frame-mode-active) #phone-screen.dynamic-island-active #chat-interface-screen>.header {
               padding-top: 48px !important;
           }

           /* --- 歌词循环滚动 (Marquee) 动画 --- */

           /* 1. 默认状态：居中 (用于短歌词) */
           #island-lyric-container.center-content {
               display: flex;
               justify-content: center;
           }

           #island-lyric-container.center-content #island-lyric-text.scrolling {
               animation: none;
               /* 短歌词不需要滚动 */
           }

           #island-lyric-container.center-content #island-lyric-text span+span {
               display: none;
               /* 短歌词只显示一个 */
           }

           /* 2. 滚动容器：内部有两个span */
           #island-lyric-text.scrolling {
               /* 使用 --marquee-duration 变量作为动画时长，从JS传入 */
               animation: marquee var(--marquee-duration, 10s) linear infinite;
               display: block;
               /* 必须是 block 才能应用 transform */
               width: fit-content;
               /* 确保宽度由内容撑开 */
           }

           /* 3. 两个span并排 */
           #island-lyric-text.scrolling span {
               display: inline-block;
               padding-right: 50px;
               /* 两个歌词之间的间距 */
               white-space: nowrap;
           }

           /* 4. 定义动画 */
           @keyframes marquee {
               0% {
                   transform: translateX(0%);
               }

               100% {
                   /* * 滚动 50% 的宽度。
         * 因为我们的总宽度是两个 <span>，所以滚动 50% 
         * 意味着第一个 <span> 刚好完全移出，第二个 <span> 完美接上。
         */
                   transform: translateX(-50%);
               }
           }

           /* 【新功能】分离状态栏 / 真·全屏模式 v2.0 */

           /* 当 body 标签拥有 detach-mode-active 类时，应用以下样式 */
           body.detach-mode-active #phone-screen {
               /* 核心修改1：保持固定定位，但只定义三边 */
               position: fixed;
               left: 0;
               right: 0;
               bottom: 0;

               /* 核心修改2：这是最关键的一步！
       让元素的顶部从“安全区域的底部”开始，而不是屏幕的绝对顶部。
       env(safe-area-inset-top) 会自动获取刘海或状态栏的高度。*/
               top: env(safe-area-inset-top);

               /* 核心修改3：移除固定的 height 属性，让 top 和 bottom 自动决定高度 */
               height: auto;
               width: auto;
               /* 同样移除固定的 width */

               /* 移除手机外框样式，实现真正的全屏感 */
               border-radius: 0;
               border: none;
               box-shadow: none;

               /* 其他布局属性保持不变 */
               overflow: hidden;
               display: flex;
               flex-direction: column;
               background-color: var(--secondary-bg);
           }

           /* 在此模式下，隐藏模拟的刘海和屏幕圆角遮罩，因为我们要显示物理的 */
           body.detach-mode-active #phone-screen::after,
           body.detach-mode-active #phone-screen::before {
               display: none;
           }

           /* 【全局修复】将Dock栏和分页点的位置固定在更低的位置，忽略底部安全区 */
           #home-screen-pagination {
               /* 移除 calc 和 env() */
               padding-bottom: 10px;
           }

           #desktop-dock {
               /* 移除 calc 和 env() */
               margin-bottom: 20px;
           }

           /* ======================================= */
           /* ▼▼▼ 【新功能】简洁聊天界面 (Minimal Chat UI) ▼▼▼ */
           /* ======================================= */

           /* 1. 默认隐藏“+”号展开按钮 */
           #chat-expand-btn {
               display: none;
               flex-shrink: 0;
               width: 40px;
               /* 与发送按钮同高 */
               height: 40px;
               font-size: 28px;
               font-weight: 300;
               line-height: 38px;
               /* 垂直居中 */
               padding: 0;
               background-color: var(--secondary-bg);
               color: var(--text-primary);
               border: 1px solid var(--border-color);
               transition: transform 0.3s ease, background-color 0.2s, color 0.2s;
           }

           /* 2. 当简洁模式开启时 (body上会有这个class) */
           body.minimal-chat-ui-active #chat-input-actions-top {
               /* 默认隐藏工具栏 */
               display: none;
           }

           body.minimal-chat-ui-active #chat-input-main-row {
               /* 确保“+”按钮和输入框底对齐 */
               align-items: flex-end;
           }

           body.minimal-chat-ui-active #chat-expand-btn {
               /* 显示“+”按钮 */
               display: flex;
               justify-content: center;
               align-items: center;
           }

           body.minimal-chat-ui-active #chat-input {
               /* 修复“+”按钮出现后，输入框没有自动适应宽度的问题 */
               flex-grow: 1;
           }

           /* 3. 当用户点击“+”号，工具栏展开时 (body上会临时添加这个class) */
           body.minimal-chat-ui-active.chat-actions-expanded #chat-input-actions-top {
               /* 重新显示工具栏 */
               display: flex;
           }

           body.minimal-chat-ui-active.chat-actions-expanded #chat-expand-btn {
               /* “+”号旋转45度变成“x”号 */
               transform: rotate(45deg);
               background-color: #f0f2f5;
               color: #8a8a8a;
           }

           #phone-screen.dark-mode body.minimal-chat-ui-active.chat-actions-expanded #chat-expand-btn {
               background-color: #3e3e42;
               color: #8d8d92;
           }

           /* 4. 暗黑模式下的“+”按钮 */
           #phone-screen.dark-mode #chat-expand-btn {
               background-color: #3e3e42;
               color: #f0f0f0;
               border: 1px solid #38383a;
           }

           /* ▲▲▲ 简洁聊天界面样式结束 ▲▲▲ */


           /* 1. 当简洁模式开启 (且工具栏折叠时)，减小聊天列表的底部内边距 */
           body.minimal-chat-ui-active #chat-interface-screen #chat-messages {
               /* 原本是 150px，我们把它缩小到 80px，刚好容纳单行输入框 */
               padding-bottom: calc(80px + env(safe-area-inset-bottom)) !important;
               /* 确保过渡平滑 */
               transition: padding-bottom 0.3s ease;
           }

           /* 2. 当简洁模式开启 (且工具栏展开时)，恢复原来的内边距 */
           body.minimal-chat-ui-active.chat-actions-expanded #chat-interface-screen #chat-messages {
               /* 恢复 150px，为展开的图标行腾出空间 */
               padding-bottom: calc(120px + env(safe-area-inset-bottom)) !important;
           }

           /* --- 新增：功能锁定样式 --- */
           .locked-feature {
               opacity: 0.7;
               /* 让按钮看起来有点灰 */
               position: relative;
               /* 为图标定位 */
               cursor: help;
               /* 鼠标悬停时显示帮助图标 */
           }



           /* 在暗黑模式下让锁更清晰 */
           #phone-screen.dark-mode .locked-feature::after {
               background-color: rgba(0, 0, 0, 0.5);
           }

           /* 【新功能】PIN码激活弹窗样式 */
           #pin-modal-overlay {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.4);
               display: none;
               /* 默认隐藏 */
               justify-content: center;
               align-items: center;
               z-index: 2000;
           }

           #pin-modal-overlay.visible {
               display: flex;
               /* 激活时显示 */
           }

           #pin-modal-content .form-group {
               margin-bottom: 15px;
           }

           /* 解决您无法复制的问题：让这个输入框看起来像个显示框，但内容可选 */
           #pin-device-id-display {
               -webkit-user-select: text;
               /* 兼容 Safari */
               user-select: text;
               /* 标准 */
               cursor: text;
               background-color: #f0f2f5;
               color: #555;
               border: 1px dashed #ccc;
               font-size: 14px !important;
               /* 确保字体大小正确 */
               padding: 10px !important;
           }

           #phone-screen.dark-mode #pin-device-id-display {
               background-color: #2c2c2e;
               color: #f0f0f0;
               border-color: #38383a;
           }

           #character-profile-modal .thought-content .text:has(div),
           #character-profile-modal .thought-content .text:has(table) {
               padding: 0 !important;
               font-family: inherit !important;
               /* 恢复默认字体，让卡片自己控制 */
               font-size: inherit !important;
               line-height: normal !important;
               /* 恢复正常的行高 */
               color: inherit !important;
               background: none !important;
               white-space: normal !important;
               /* 允许卡片正常换行和布局 */
           }

           .quick-reply-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px 20px;
               border-bottom: 1px solid var(--border-color);
               flex-shrink: 0;
               /* 防止在flex布局中被压缩 */
           }

           .quick-reply-item:last-child {
               border-bottom: none;
           }

           .quick-reply-text {
               font-size: 16px;
               color: var(--text-primary);
               cursor: pointer;
               flex-grow: 1;
               /* 占据主要空间 */
               padding-right: 15px;
               /* 和按钮保持距离 */
               word-break: break-all;
               /* 修复长文本溢出 */
               white-space: pre-wrap;
               /* 支持换行符显示 */
           }

           .quick-reply-text:hover {
               color: var(--accent-color);
           }

           .quick-reply-actions {
               display: flex;
               gap: 10px;
               flex-shrink: 0;
               /* 防止按钮被压缩 */
           }

           .quick-reply-edit-btn,
           .quick-reply-delete-btn {
               background: none;
               border: none;
               padding: 5px;
               cursor: pointer;
               color: var(--text-secondary);
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: all 0.2s;
           }

           .quick-reply-edit-btn:hover {
               background-color: #e9e9eb;
               color: var(--accent-color);
           }

           .quick-reply-delete-btn:hover {
               background-color: #ffebee;
               color: #ff3b30;
           }

           #phone-screen.dark-mode .quick-reply-item {
               border-bottom-color: #38383a;
           }

           #phone-screen.dark-mode .quick-reply-text:hover {
               color: #58a6ff;
           }

           #phone-screen.dark-mode .quick-reply-edit-btn:hover {
               background-color: #3a3a3c;
               color: #58a6ff;
           }

           #phone-screen.dark-mode .quick-reply-delete-btn:hover {
               background-color: #5c1f24;
               color: #ff8080;
           }

           /* 确保 modal-body 可以滚动 */
           #quick-reply-modal .modal-body {
               overflow-y: auto;
           }

           #char-music-player-modal #char-music-lyrics {
               /* display: none;  <-- 删除这一行，或者改为下面这样: */
               display: block;
               width: 100%;
               height: 60px;
               /* 给个固定高度 */
               overflow: hidden;
               position: relative;
               margin-bottom: 20px;
               font-size: 14px;
               line-height: 20px;
               color: #888;
               text-align: center;
               transition: all 0.3s ease;
               mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent);
               -webkit-mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent);
           }

           .char-player-minimize-btn {
               position: absolute;
               top: 15px;
               right: 85px;
               /* 放在关闭按钮左边 */
               background: none;
               border: none;
               color: #aaa;
               cursor: pointer;
               line-height: 1;
               z-index: 10;
               padding: 5px;
               /* 给予点击区域 */
               display: flex;
               /* 用于居中SVG */
               align-items: center;
               /* 用于居中SVG */
               justify-content: center;
               /* 用于居中SVG */
           }

           .char-player-minimize-btn:hover {
               color: #333;
           }

           /* 3. 添加悬浮恢复球样式 */
           #char-music-restore-btn {
               position: absolute;
               top: 120px;
               right: 15px;
               width: 45px;
               height: 45px;
               background: transparent;
               /* 1. 改为完全透明 */
               backdrop-filter: none;
               /* 2. 移除毛玻璃 */
               -webkit-backdrop-filter: none;
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               box-shadow: none;
               /* 3. 移除阴影 */
               z-index: 900;
               /* 确保在最上层 */
               cursor: pointer;
               animation: float-music 3s ease-in-out infinite;
               border: none;
               /* 4. 移除边框 */
           }

           @keyframes float-music {

               0%,
               100% {
                   transform: translateY(0);
               }

               50% {
                   transform: translateY(-5px);
               }
           }

           .video-call-top-bar #minimize-call-btn {
               position: absolute;
               left: 20px;
               top: 48px;
               /* 适配顶部的 padding-top */
               background: none;
               border: none;
               color: white;
               font-size: 20px;
               cursor: pointer;
               padding: 5px;
               z-index: 11;
               opacity: 0.7;
               transition: opacity 0.2s;
               pointer-events: auto;
           }

           .video-call-top-bar #minimize-call-btn:hover {
               opacity: 1;
           }

           #video-call-restore-btn {
               position: absolute;
               top: 120px;
               /* 默认显示位置，和音乐按钮错开一点 */
               right: 15px;
               width: 45px;
               height: 45px;
               background-color: #4cd964;
               /* 绿色，代表通话中 */
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
               z-index: 900;
               /* 确保在最上层 */
               cursor: pointer;
               animation: pulse 1.5s infinite;
               /* 复用充电/来电的呼吸动画 */
               border: 2px solid rgba(255, 255, 255, 0.3);
           }

           .nai-image-wrapper {
               position: relative;
               display: inline-block;
               line-height: 0;
           }

           /* DING: 在这里添加新规则 */
           .bubble-image-controls {
               position: absolute;
               bottom: 10px;
               right: 10px;
               display: flex;
               gap: 8px;
               z-index: 5;
           }

           /* DING: 找到约 10235 行的 .nai-regenerate-btn 规则并将其修改为： */
           .nai-regenerate-btn,
           .nai-upload-imgbb-btn {
               position: static;
               width: 32px;
               height: 32px;
               background-color: rgba(0, 0, 0, 0.6);
               backdrop-filter: blur(5px);
               -webkit-backdrop-filter: blur(5px);
               border: 1px solid rgba(255, 255, 255, 0.2);
               border-radius: 50%;
               color: white;
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 0;


               opacity: 0;

               transition: opacity 0.2s ease-in-out;
           }

           /* DING: 找到约 10260 行的 hover 规则并修改选择器： */
           .nai-image-wrapper:hover .nai-regenerate-btn,
           .nai-image-wrapper:hover .nai-upload-imgbb-btn {
               opacity: 1;
           }

           /* DING: 找到约 10266 行的 hover 规则并修改选择器： */
           .nai-regenerate-btn:hover,
           .nai-upload-imgbb-btn:hover {
               opacity: 1;
               background-color: rgba(0, 0, 0, 0.8);
           }

           /* DING: 找到约 10272 行的 loading 规则并修改选择器： */
           .nai-regenerate-btn.loading,
           .nai-upload-imgbb-btn.loading {
               pointer-events: none;
               opacity: 1;
           }

           .nai-regenerate-btn.loading svg,
           .nai-upload-imgbb-btn.loading svg,
           .nai-save-local-btn.loading svg {
               /* DING: 同样修改这里 */
               animation: spin 1s linear infinite;
           }

           /* DING: 在 .nai-image-wrapper 规则后添加 */
           .bubble-image-wrapper {
               position: relative;
               display: inline-block;
               /* 确保 wrapper 包裹图片 */
               line-height: 0;
               /* 移除图片下的空隙 */
           }

           /* DING: 在 .bubble-image-controls 规则 (约 10243 行) 后添加 */
           .bubble-image-controls.user-controls {
               left: 10px;
               /* DING: 用户按钮在左侧 */
               right: auto;
           }

           /* DING: 在 .nai-regenerate-btn, .nai-upload-imgbb-btn 规则 (约 10250 行) 后添加 */
           .user-upload-imgbb-btn {
               position: static;
               width: 32px;
               height: 32px;
               background-color: rgba(0, 0, 0, 0.6);
               backdrop-filter: blur(5px);
               -webkit-backdrop-filter: blur(5px);
               border: 1px solid rgba(255, 255, 255, 0.2);
               border-radius: 50%;
               color: white;
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 0;
               opacity: 0;
               /* DING: 默认显示 */
               transition: opacity 0.2s ease-in-out;
           }

           /* DING: 在 .nai-image-wrapper:hover ... 规则 (约 10271 行) 后添加 */
           .user-image-wrapper:hover .user-upload-imgbb-btn {
               opacity: 1;
           }

           /* DING: 在 .nai-regenerate-btn:hover, ... 规则 (约 10277 行) 后添加 */
           .user-upload-imgbb-btn:hover {
               opacity: 1;
               background-color: rgba(0, 0, 0, 0.8);
           }

           /* DING: 在 .nai-regenerate-btn.loading, ... 规则 (约 10283 行) 后添加 */
           .user-upload-imgbb-btn.loading {
               pointer-events: none;
               opacity: 1;
           }

           .user-upload-imgbb-btn.loading svg {
               animation: spin 1s linear infinite;
           }

           #nai-gallery-tabs {
               display: flex;
               justify-content: center;
               position: absolute;
               left: 50%;
               transform: translateX(-50%);
               background-color: rgba(128, 128, 128, 0.15);
               border-radius: 8px;
               padding: 2px;
           }

           .nai-gallery-tab {
               padding: 5px 25px;
               border-radius: 7px;
               font-size: 14px;
               font-weight: 500;
               color: var(--text-secondary);
               cursor: pointer;
               transition: all 0.2s ease-in-out;
           }

           .nai-gallery-tab.active {
               background-color: var(--secondary-bg);
               color: var(--text-primary);
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
           }

           #phone-screen.dark-mode .nai-gallery-tabs {
               background-color: rgba(80, 80, 80, 0.5);
           }

           #phone-screen.dark-mode .nai-gallery-tab.active {
               background-color: #3e3e42;
           }

           /* NAI画廊 - 页面和网格容器 */
           #nai-gallery-grid-container {
               flex-grow: 1;
               position: relative;
               overflow: hidden;
               /* 隐藏未激活的页面 */
           }

           .nai-gallery-page {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               overflow-y: auto;
               padding: 15px;
               box-sizing: border-box;

               display: grid;
               /* 两个页面都使用 grid 布局 */
               grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
               gap: 15px;
               align-content: flex-start;
               /* 确保内容从顶部开始排列 */

               /* 默认隐藏 */
               opacity: 0;
               visibility: hidden;
               transition: opacity 0.2s ease, visibility 0.2s;
           }

           .nai-gallery-page.active {
               opacity: 1;
               visibility: visible;
               z-index: 1;
           }

           /* 移除旧的 #nai-gallery-grid 布局，因为它现在被 .nai-gallery-page 替代了 */
           #nai-gallery-grid {
               padding: 0;
               display: contents;
               /* 让旧ID失效，布局由父级 .nai-gallery-page 控制 */
           }

           .nai-gallery-page.management-mode .nai-image-container {
               position: relative;
               /* 关键：为伪元素提供定位锚点 */
           }

           /* 选中项的蓝色半透明遮罩 */
           .nai-gallery-page.management-mode .nai-gallery-item.selected .nai-image-container::after {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;
               background-color: rgba(0, 122, 255, 0.4);
               /* 半透明蓝色 */
               border: 3px solid #007aff;
               /* 蓝色实线边框 */
               box-sizing: border-box;
               border-radius: 8px;
               /* 匹配 .nai-image-container 的圆角 */
               z-index: 1;
           }

           /* 选中项右上角的“✔”对勾 */
           .nai-gallery-page.management-mode .nai-gallery-item.selected .nai-image-container::before {
               content: '✔';
               /* 使用 Unicode 对勾 */
               position: absolute;
               top: 6px;
               right: 6px;
               width: 22px;
               height: 22px;
               background-color: #007aff;
               /* 蓝色背景 */
               color: white;
               /* 白色对勾 */
               border-radius: 50%;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 14px;
               font-weight: bold;
               z-index: 2;
               /* 确保在遮罩之上 */
               border: 2px solid white;
               /* 白色描边，更清晰 */
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
           }

           #playlist-action-bar {
               display: none;
               flex-shrink: 0;
               padding: 10px 15px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               background-color: rgba(247, 247, 247, 0.9);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 1px solid var(--border-color);
               justify-content: space-between;
               align-items: center;
           }

           #playlist-action-bar .select-all-label {
               font-size: 16px;
               color: var(--text-primary);
               cursor: pointer;
           }

           #playlist-action-bar .action-bar-btn {
               padding: 10px 20px;
               border-radius: 20px;
               border: none;
               font-size: 15px;
               font-weight: 600;
               cursor: pointer;
               background-color: #007bff;
               color: white;
           }

           /* 播放列表选择模式样式 */
           #music-playlist-panel.management-mode .playlist-item-checkbox {
               display: block;
               margin-right: 10px;
               flex-shrink: 0;
               width: 18px;
               height: 18px;
           }

           #music-playlist-panel.management-mode .playlist-item-actions {
               display: none;
               /* 管理模式下隐藏歌曲的单独操作按钮 */
           }

           #music-playlist-panel.management-mode .playlist-item.selected {
               background-color: rgba(0, 123, 255, 0.2);
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #playlist-action-bar {
               background-color: rgba(28, 28, 30, 0.9);
               border-top-color: #38383a;
           }

           #phone-screen.dark-mode #playlist-action-bar .select-all-label {
               color: #f0f0f0;
           }

           #phone-screen.dark-mode #music-playlist-panel.management-mode .playlist-item.selected {
               background-color: rgba(0, 123, 255, 0.3);
           }

           .playlist-header>span {
               position: absolute;
               left: 50%;
               transform: translateX(-50%);
               font-weight: 600;
           }

           /* 2. 确保左右两侧的按钮容器不会遮挡标题 */
           .playlist-header>div {
               z-index: 1;
               /* 保持按钮在标题的“空间”之上 */
           }

           /* 3. 定义我们新添加的左侧按钮容器 */
           .playlist-header .header-left-actions {
               display: flex;
               align-items: center;
               gap: 10px;
               /* “返回”和“管理”之间的间距 */
               z-index: 1;
           }

           /* 4. 让“管理”/“完成”按钮看起来更像一个辅助操作，而不是导航 */
           .playlist-header #manage-playlist-btn {
               font-weight: 400;
               /* 正常字重 */
               font-size: 15px;
               /* 稍小一点 */
               color: var(--accent-color);
               /* 保持高亮色 */
           }

           /* 5. （可选）修复暗黑模式下的颜色 */
           #phone-screen.dark-mode .playlist-header #manage-playlist-btn {
               color: #f0f0f0;
           }

           #phone-screen.dark-mode .playlist-header .panel-btn {
               color: #f0f0f0;
           }

           #sticker-action-bar button {
               width: auto;
               /* 修改：不再是100%宽度 */
               padding: 10px 20px;
               /* 修改：使用内边距来自动调整宽度 */
               border-radius: 20px;
               /* 修改：改为圆角按钮，更美观 */
               border: none;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
               background-color: #ff3b30;
               color: white;
           }


           #sticker-action-bar #export-selected-stickers-btn {
               background-color: #007bff;
               /* 导出按钮设为蓝色 */
           }

           #sticker-action-bar #delete-selected-stickers-btn {
               background-color: #ff3b30;
               /* 删除按钮保持红色 */
           }

           /* Bilibili 列表样式 */
           #char-bilibili-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #char-bilibili-screen {
               background-color: #000;
           }

           .bilibili-item {
               display: flex;
               gap: 10px;
               padding: 10px;
               background-color: var(--secondary-bg);
               border-radius: 8px;
               margin-bottom: 10px;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
               cursor: pointer;
               transition: transform 0.1s;
           }

           .bilibili-item:active {
               transform: scale(0.98);
           }

           .bili-cover {
               width: 120px;
               height: 75px;
               background-size: cover;
               background-position: center;
               border-radius: 6px;
               flex-shrink: 0;
               position: relative;
               background-color: #ddd;
           }

           .bili-duration {
               position: absolute;
               bottom: 4px;
               right: 4px;
               background-color: rgba(0, 0, 0, 0.6);
               color: white;
               font-size: 10px;
               padding: 1px 4px;
               border-radius: 4px;
           }

           .bili-info {
               flex-grow: 1;
               display: flex;
               flex-direction: column;
               justify-content: space-between;
           }

           .bili-title {
               font-size: 14px;
               font-weight: 500;
               line-height: 1.4;
               color: var(--text-primary);
               display: -webkit-box;
               -webkit-line-clamp: 2;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           .bili-author {
               font-size: 12px;
               color: var(--text-secondary);
           }

           /* 搜索框适配 */
           #char-bilibili-search-input:focus {
               border-color: #FB7299;
               outline: none;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #char-bilibili-player-screen .list-container {
               background-color: #1c1c1e;
           }

           #lock-screen {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               z-index: 3000;
               /* 确保在最上层 */
               background-color: #000;
               background-size: cover;
               background-position: center;
               color: white;
               display: flex;
               flex-direction: column;
               overflow: hidden;
               transition: transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.3s ease;
               visibility: hidden;
               opacity: 0;
               transform: translateY(-100%);
               /* 默认藏在上面或者隐藏 */
           }

           #lock-screen.active {
               visibility: visible;
               opacity: 1;
               transform: translateY(0);
           }

           #lock-screen.unlocking {
               transform: translateY(-100%);
               opacity: 0;
           }

           #lock-screen-content {
               width: 100%;
               height: 100%;
               backdrop-filter: blur(0px);
               transition: backdrop-filter 0.3s;
               display: flex;
               flex-direction: column;
               align-items: center;
               padding-top: 60px;
               box-sizing: border-box;
               background: rgba(0, 0, 0, 0.2);
               /* 轻微遮罩让文字更清晰 */
           }

           #lock-screen.input-mode #lock-screen-content {
               backdrop-filter: blur(20px);
               background: rgba(0, 0, 0, 0.4);
           }

           .lock-icon {
               font-size: 20px;
               margin-bottom: 10px;
               opacity: 0;
               transition: opacity 0.3s;
           }

           #lock-screen.input-mode .lock-icon {
               opacity: 0;
           }

           .lock-time-container {
               text-align: center;
               transition: transform 0.3s, opacity 0.3s;
           }

           #lock-screen.input-mode .lock-time-container {
               transform: scale(0.8) translateY(-20px);
               opacity: 0;
               /* 输入密码时隐藏时间 */
               pointer-events: none;
           }

           #lock-date {
               font-size: 18px;
               font-weight: 500;
               margin-bottom: 5px;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
           }

           #lock-time {
               font-size: 80px;
               font-weight: 600;
               line-height: 1;
               letter-spacing: -2px;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
               text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
           }

           /* 密码输入区域 */
           #lock-password-area {
               flex-grow: 1;
               display: flex;
               flex-direction: column;
               align-items: center;
               justify-content: center;
               width: 100%;
               margin-top: 20px;
               animation: fadeIn 0.3s ease;
           }

           .lock-instruction {
               font-size: 16px;
               margin-bottom: 20px;
               font-weight: 500;
           }

           .lock-dots {
               display: flex;
               gap: 15px;
               margin-bottom: 30px;
           }

           .dot {
               width: 12px;
               height: 12px;
               border-radius: 50%;
               border: 1px solid white;
               box-sizing: border-box;
               transition: background-color 0.2s;
           }

           .dot.filled {
               background-color: white;
           }

           .lock-keypad {
               display: grid;
               grid-template-columns: repeat(3, 1fr);
               column-gap: 25px;
               row-gap: 15px;
               margin-bottom: 20px;
           }

           .key {
               width: 75px;
               height: 75px;
               border-radius: 50%;
               background-color: rgba(255, 255, 255, 0.15);
               backdrop-filter: blur(10px);
               display: flex;
               flex-direction: column;
               align-items: center;
               justify-content: center;
               font-size: 32px;
               font-weight: 400;
               line-height: 1;
               cursor: pointer;
               transition: background-color 0.1s;
               user-select: none;
           }

           .key:active {
               background-color: rgba(255, 255, 255, 0.4);
           }

           .key span {
               font-size: 10px;
               font-weight: 600;
               letter-spacing: 2px;
               margin-top: 2px;
               opacity: 0.8;
           }

           .key.empty {
               background: transparent;
               cursor: default;
           }

           .key.delete {
               background: transparent;
               font-size: 24px;
           }

           .lock-cancel-btn {
               margin-top: 20px;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
           }

           /* 底部滑动条 */
           #lock-swipe-area {
               position: absolute;
               bottom: 25px;
               /* 调整这个值来控制离底边的距离 */
               left: 0;
               width: 100%;
               height: 30px;
               display: flex;
               justify-content: center;
               align-items: center;
               z-index: 20;
               cursor: grab;

           }

           @keyframes swipe-hint {

               0%,
               100% {
                   transform: translateY(0);
                   opacity: 0.8;
               }

               50% {
                   transform: translateY(-10px);
                   opacity: 1;
               }
           }

           /* 确保横条样式正确 */
           .swipe-bar {
               width: 130px;
               height: 5px;
               background-color: white;
               border-radius: 100px;
               box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
           }

           @keyframes shake {

               0%,
               100% {
                   transform: translateX(0);
               }

               20%,
               60% {
                   transform: translateX(-10px);
               }

               40%,
               80% {
                   transform: translateX(10px);
               }
           }

           .shake-animation {
               animation: shake 0.4s ease;
           }

           /* --- 聊天设置页 (Chat Settings) QQ风格重构 --- */

           /* 背景色 */
           #chat-settings-screen {
               background-color: #f2f2f7 !important;
               /* 浅灰底色 */
           }

           #phone-screen.dark-mode #chat-settings-screen {
               background-color: #000 !important;
           }

           /* 容器 */
           .settings-container {
               padding: 16px;
               padding-top: calc(80px + env(safe-area-inset-top));
               padding-bottom: calc(20px + env(safe-area-inset-bottom));
               overflow-y: auto;
               height: 100%;
               box-sizing: border-box;
           }

           /* 分组卡片 */
           .settings-section {
               background-color: #ffffff;
               border-radius: 12px;
               margin-bottom: 16px;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.02);

               /* 【核心修复】：移除 overflow: hidden，允许下拉框溢出 */
               /* overflow: hidden;  <-- 删除这行 */
               position: relative;
               /* 确保内部定位正常 */
           }

           #phone-screen.dark-mode .settings-section {
               background-color: #1c1c1e;
           }

           /* 手动处理圆角，替代 overflow: hidden */
           .settings-section>.settings-item:first-child,
           .settings-section>.settings-item-block:first-child {
               border-top-left-radius: 12px;
               border-top-right-radius: 12px;
           }

           .settings-section>.settings-item:last-child,
           .settings-section>.settings-item-block:last-child {
               border-bottom-left-radius: 12px;
               border-bottom-right-radius: 12px;
               border-bottom: none;
               /* 去除最后一条线 */
           }

           /* 单行设置项 */
           .settings-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 14px 16px;
               background-color: #fff;
               border-bottom: 0.5px solid #ebedf0;
               min-height: 24px;
               transition: background-color 0.2s;
               position: relative;
               /* 确保点击反馈正常 */
           }

           #phone-screen.dark-mode .settings-item {
               background-color: #1c1c1e;
               border-bottom-color: #2c2c2e;
           }

           /* 可点击项反馈 */
           .settings-item.clickable:active {
               background-color: #f5f5f5;
           }

           #phone-screen.dark-mode .settings-item.clickable:active {
               background-color: #2c2c2e;
           }

           /* 块级设置项 (用于多行内容) */
           .settings-item-block {
               padding: 14px 16px;
               background-color: #fff;
               border-bottom: 0.5px solid #ebedf0;
               display: flex;
               flex-direction: column;
               gap: 8px;
               position: relative;
           }

           #phone-screen.dark-mode .settings-item-block {
               background-color: #1c1c1e;
               border-bottom-color: #2c2c2e;
           }

           /* 标签文本 */
           .settings-item label,
           .settings-item-block label {
               font-size: 16px;
               color: #000;
               font-weight: 400;
               margin: 0;
               flex-shrink: 0;
           }

           #phone-screen.dark-mode .settings-item label,
           #phone-screen.dark-mode .settings-item-block label {
               color: #fff;
           }

           /* 描述文本 (小字) */
           .settings-desc {
               font-size: 12px;
               color: #8a8a8a;
               margin-top: 2px;
           }

           /* 右侧区域 (输入框、按钮等) */
           .settings-right {
               display: flex;
               align-items: center;
               gap: 10px;
               flex-grow: 1;
               justify-content: flex-end;
               min-width: 0;
               /* 防止溢出 */
           }

           /* 输入框样式 (无边框，右对齐) */
           .settings-item input[type="text"],
           .settings-item input[type="number"] {
               text-align: right;
               border: none;
               background: transparent;
               font-size: 15px;
               color: #666;
               width: 100%;
               padding: 0;
               outline: none;
           }

           #phone-screen.dark-mode .settings-item input {
               color: #aaa;
           }

           .settings-item input::placeholder {
               color: #ccc;
           }

           /* 文本域样式 */
           .settings-textarea {
               width: 100%;
               border: 1px solid #f0f0f0;
               background-color: #f9f9f9;
               border-radius: 8px;
               padding: 10px;
               font-size: 14px;
               resize: vertical;
               box-sizing: border-box;
               color: #333;
           }

           #phone-screen.dark-mode .settings-textarea {
               background-color: #2c2c2e;
               border-color: #38383a;
               color: #eee;
           }

           /* 头像预览 */
           .settings-avatar {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               object-fit: cover;
               border: 1px solid #eee;
           }

           /* 纯文本按钮 (蓝色小字) */
           .settings-text-btn {
               background: none;
               border: none;
               color: #007bff;
               font-size: 14px;
               padding: 4px 8px;
               cursor: pointer;
           }

           .settings-text-btn:active {
               opacity: 0.7;
           }

           /* 块级按钮 (灰色背景) */
           .settings-full-btn {
               width: 100%;
               padding: 10px;
               background-color: #f5f5f7;
               color: #333;
               border: none;
               border-radius: 8px;
               font-size: 14px;
               font-weight: 500;
               cursor: pointer;
           }

           #phone-screen.dark-mode .settings-full-btn {
               background-color: #2c2c2e;
               color: #fff;
           }

           /* 下拉框 */
           .settings-select {
               padding: 6px 20px 6px 10px;
               border-radius: 6px;
               border: none;
               background-color: #f2f2f7;
               font-size: 14px;
               color: #333;
               appearance: none;
               -webkit-appearance: none;
               /* 这里可以加个箭头图标base64 */
           }

           #phone-screen.dark-mode .settings-select {
               background-color: #3a3a3c;
               color: #fff;
           }

           /* 数字输入框 (小) */
           .settings-num-input {
               width: 60px !important;
               text-align: center !important;
               background-color: #f2f2f7 !important;
               border-radius: 6px;
               padding: 4px !important;
           }

           #phone-screen.dark-mode .settings-num-input {
               background-color: #3a3a3c !important;
               color: #fff !important;
           }

           /* 头部右侧按钮 */
           .header .save-btn {
               font-size: 16px;
               background-color: #4cd964;
               /* 绿色完成按钮 */
               color: white !important;
               padding: 5px 12px;
               border-radius: 6px;
               font-weight: 500;
           }

           /* 头像操作区 */
           .avatar-action-wrapper {
               display: flex;
               align-items: center;
               gap: 8px;
           }

           /* 背景预览图 */
           .settings-bg-preview {
               width: 30px;
               height: 50px;
               object-fit: cover;
               border-radius: 4px;
               border: 1px solid #eee;
               display: none;
               /* JS 控制显示 */
           }

           /* 修复多选框在设置页的样式 */
           .settings-item-block .custom-multiselect .select-box {
               background-color: #f5f5f7;
               border: none;
           }

           #phone-screen.dark-mode .settings-item-block .custom-multiselect .select-box {
               background-color: #2c2c2e;
           }

           /* 【核心修复】：多选下拉框层级问题 */
           .checkboxes-container {
               z-index: 1000 !important;
               /* 确保在最上层 */
               background-color: #ffffff;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
               border-radius: 8px;
               max-height: 200px;
               /* 限制高度 */
               overflow-y: auto;
           }

           #phone-screen.dark-mode .checkboxes-container {
               background-color: #2c2c2e;
               border: 1px solid #38383a;
           }

           /* 横向滚动列表 (群成员) */
           .horizontal-scroll-list {
               display: flex;
               overflow-x: auto;
               gap: 10px;
               padding-bottom: 5px;
           }

           .horizontal-scroll-list .member-editor {
               flex-shrink: 0;
           }

           /* 气泡主题选择器美化 */
           .theme-selector label {
               display: inline-flex;
               align-items: center;
               font-size: 14px;
               color: #333;
               cursor: pointer;
               padding: 4px 8px;
               background-color: #f5f5f7;
               border-radius: 6px;
               transition: background-color 0.2s;
           }

           #phone-screen.dark-mode .theme-selector label {
               background-color: #2c2c2e;
               color: #fff;
           }

           .theme-selector label:has(input:checked) {
               background-color: #e7f3ff;
               /* 选中态高亮 */
               color: #007bff;
               font-weight: 500;
           }

           #phone-screen.dark-mode .theme-selector label:has(input:checked) {
               background-color: #0a84ff33;
               color: #0a84ff;
           }

           .theme-selector input[type="radio"] {
               margin-right: 6px;
               accent-color: #007bff;
           }

           /* --- 核心修复：强制纠正“注入心声”的布局 --- */
           #inject-thought-group {
               display: flex !important;
               /* 强制左右横向排列，覆盖 JS 的 block */
               justify-content: space-between;
               /* 左右撑开 */
               align-items: center;
               /* 垂直居中 */
           }

           /* 针对该选项下的文字区域，防止被压缩 */
           #inject-thought-group>div:first-child {
               flex: 1;
               /* 占据左侧所有空间 */
               padding-right: 10px;
               /* 和开关保持距离 */
           }

           /* --- 头像设置栏专用样式修复 --- */

           /* 让右侧容器占满剩余空间 */
           .settings-right.full-width {
               flex: 1;
               width: 100%;
               margin-left: 15px;
               /* 让头像和左边标签保持一点距离 */
           }

           /* 头像操作区容器：两端对齐 */
           .avatar-action-wrapper {
               display: flex;
               align-items: center;
               justify-content: space-between;
               /* 关键：头像靠左，按钮靠右 */
               width: 100%;
           }

           /* 按钮组容器 */
           .avatar-btn-group {
               display: flex;
               gap: 8px;
               /* 按钮之间的间距 */
           }

           /* 新的实体小按钮样式 (有框框了！) */
           .settings-mini-btn {
               background-color: #f2f2f7;
               /* 浅灰背景 */
               border: 1px solid #e5e5ea;
               /* 淡淡的边框 */
               color: #333;
               padding: 5px 12px;
               border-radius: 6px;
               /* 圆角 */
               font-size: 13px;
               font-weight: 500;
               cursor: pointer;
               transition: all 0.2s;
               line-height: 1.2;
           }

           /* 按钮悬停效果 */
           .settings-mini-btn:active {
               background-color: #e5e5ea;
               transform: scale(0.95);
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .settings-mini-btn {
               background-color: #3a3a3c;
               border-color: #48484a;
               color: #fff;
           }

           #phone-screen.dark-mode .settings-mini-btn:active {
               background-color: #48484a;
           }

           /* 修复头像大小，确保不会过大 */
           .settings-avatar {
               width: 44px;
               height: 44px;
               border-radius: 6px;
               /* 微信风格的小圆角，或者50%变成圆形 */
               object-fit: cover;
               border: 1px solid #eee;
               flex-shrink: 0;
           }

           #phone-screen.dark-mode .settings-avatar {
               border-color: #333;
           }

           /* --- 1. 修复顶部空白过大的问题 --- */
           .settings-container {
               /* 原来是 80px，改为 10px 即可，因为 header 已经占据了空间 */
               padding-top: 10px !important;
               /* 保持底部 padding */
               padding-bottom: calc(20px + env(safe-area-inset-bottom));
           }

           /* --- 2. 优化头像右侧按钮的间距和样式 --- */

           /* 按钮组容器：稍微缩小按钮之间的距离 */
           .avatar-btn-group {
               display: flex;
               gap: 6px;
               /* 从 8px 减小到 6px，更紧凑 */
               align-items: center;
           }

           /* 按钮样式微调：让按钮更精致 */
           .settings-mini-btn {
               /* 稍微减小内边距，让按钮不那么“胖” */
               padding: 4px 10px !important;

               /* 字体稍微调小一点点，更显精致 */
               font-size: 12px !important;

               /* 增加一点边框颜色深度，更有质感 */
               border: 1px solid #d1d1d6 !important;

               /* 稍微缩小圆角 */
               border-radius: 4px !important;

               /* 确保背景色 */
               background-color: #fff !important;

               /* 确保文字颜色 */
               color: #333 !important;

               /* 防止换行 */
               white-space: nowrap;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .settings-mini-btn {
               background-color: #2c2c2e !important;
               border-color: #48484a !important;
               color: #fff !important;
           }

           /* 头部样式微调：确保 Header 和 内容的连接处自然 */
           #chat-settings-screen .header {
               /* 确保头部背景色与 body 一致或为白色，去除多余阴影 */
               background-color: #f2f2f7 !important;
               border-bottom: none !important;
               /* 去掉分割线，看起来更像原生设置页 */
               box-shadow: none !important;
               padding-bottom: 0 !important;
               /* 减小头部下方的留白 */
           }

           #phone-screen.dark-mode #chat-settings-screen .header {
               background-color: #000 !important;
           }

           .settings-mini-btn {
               /* 强制去掉旧代码可能残留的外边距，解决间距不一致问题 */
               margin: 0 !important;

               /* 改为浅灰色背景，让按钮在白色卡片上更显眼，更有“框”的感觉 */
               background-color: #f5f5f7 !important;

               /* 稍微加深一点边框 */
               border: 1px solid #e0e0e0 !important;

               /* 稍微增加内边距，不那么挤 */
               padding: 6px 12px !important;
           }

           /* 2. 统一调整按钮之间的间距 */
           .avatar-btn-group {
               /* 增大间距，不再“贴着” */
               gap: 12px !important;
           }

           /* 暗黑模式下的适配 */
           #phone-screen.dark-mode .settings-mini-btn {
               background-color: #2c2c2e !important;
               border-color: #3a3a3c !important;
           }

           /* --- 终极修复 V2：完美解决显隐冲突与布局问题 --- */

           /* 1. 基础布局：去掉 display 的 !important */
           /* 这样当 JS 设置 display: none 时，元素就能正常隐藏了 */
           .settings-item {
               display: flex;
               align-items: center !important;
               justify-content: space-between !important;
               flex-direction: row !important;
           }

           /* 2. 关键拦截：当 JS 把它设为显示(block)时，强制转为 flex */
           /* 解释：JS 默认会用 display: block 来显示元素，这会导致换行。
   我们用属性选择器捕获这种情况，并强制改为 flex 布局 */
           .settings-item[style*="display: block"],
           .settings-item[style*="display:block"] {
               display: flex !important;
           }

           /* 3. 修复“按钮贴边”问题 (保持不变) */
           .settings-right.full-width {
               width: auto !important;
               flex: 1;
               margin-left: 15px;
               padding-right: 4px !important;
           }

           /* 4. 确保头像操作区布局 (保持不变) */
           .avatar-action-wrapper {
               width: 100%;
               box-sizing: border-box;
               display: flex;
               align-items: center;
               justify-content: space-between;
           }

           /* --- 终极圆角修复方案 --- */

           /* 1. 全局强制卡片圆角裁剪 */
           /* 这会让所有卡片（包括时区设置那一组）的头尾自动变成圆角，无论内部是否有隐藏元素 */
           .settings-section {
               overflow: hidden !important;
               border-radius: 12px !important;
           }

           /* 2. 特例豁免：只有包含“自定义多选下拉框”的卡片才允许内容溢出 */
           /* 这是为了防止“关联世界书”或“挂载记忆”的下拉菜单被卡片边缘切断 */
           /* 注意：时区设置使用的是原生下拉框，不受 overflow 影响，所以不需要豁免 */
           .settings-section:has(.custom-multiselect) {
               overflow: visible !important;
           }

           /* 3. 针对上述“豁免”的卡片，手动修补首尾圆角 */
           /* 因为允许溢出了，所以必须手动给第一个和最后一个元素加圆角 */
           .settings-section:has(.custom-multiselect)>div:first-child {
               border-top-left-radius: 12px !important;
               border-top-right-radius: 12px !important;
           }

           .settings-section:has(.custom-multiselect)>div:last-child {
               border-bottom-left-radius: 12px !important;
               border-bottom-right-radius: 12px !important;
               border-bottom: none !important;
           }

           /* --- 核心修复：给嵌套在透明容器里的“注入心声”补圆角 --- */

           /* 当卡片允许溢出时，如果第一个孩子是包裹容器，
   那么包裹容器里的第一个 .settings-item 必须有顶部圆角 */
           .settings-section:has(.custom-multiselect)>div:first-child>.settings-item:first-child {
               border-top-left-radius: 12px !important;
               border-top-right-radius: 12px !important;
           }

           /* --- 补充修复：群聊模式下的顶部圆角 --- */
           /* 如果第一个孩子（单聊设置）隐藏了，那么第二个孩子（群聊设置）就是视觉上的第一个，
   它也需要圆角。CSS无法直接检测 display:none，
   所以我们直接给“群聊后台活动”也加上条件性的圆角 */
           #group-background-activity-group {
               /* 只有当它上面那个兄弟隐藏时才需要圆角，但在纯CSS里很难判断。
       这里做一个权衡：如果它是该组第一个可见元素，赋予它圆角 */
               border-top-left-radius: 12px;
               border-top-right-radius: 12px;
           }

           /* --- 修复群聊模式下“我的人设”直角问题 --- */

           /* 当 AI人设被 JS 设置为隐藏(display: none)时，
   紧随其后的 我的人设 必须变成顶部圆角 */
           #ai-persona-group[style*="none"]+#my-persona-group {
               border-top-left-radius: 12px !important;
               border-top-right-radius: 12px !important;
           }

           /* --- 修复群成员管理在特殊情况下的圆角 --- */
           /* 如果群聊中 我的人设 也是隐藏的（虽然一般不会），兜底给群成员管理加圆角 */
           #my-persona-group[style*="none"]+#group-members-group {
               border-top-left-radius: 12px !important;
               border-top-right-radius: 12px !important;
           }

           /* 多选模式下的头部图标样式调整 */
           #chat-interface-screen .selection-controls .header-actions {
               gap: 8px;
               /* [修改] 减小图标之间的间距 (原 15px) */
           }

           #chat-interface-screen .selection-controls .action-btn {
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 6px;
               /* [修改] 稍微调整点击区域 */
               cursor: pointer;
               transition: opacity 0.2s;
               /* [新增] 限制按钮本身的大小，防止过大 */
               width: 32px;
               height: 32px;
               border-radius: 50%;
               /* 保持圆形 */
           }

           #chat-interface-screen .selection-controls .action-btn:hover {
               opacity: 0.7;
               background-color: rgba(0, 0, 0, 0.05);
               /* 鼠标悬停时的轻微背景 */
           }

           #chat-interface-screen .selection-controls .action-btn svg {
               width: 18px;
               /* [修改] 减小图标宽度 (原 24px) */
               height: 18px;
               /* [修改] 减小图标高度 (原 24px) */
               stroke-width: 2;
               /* 确保线条粗细适中 */
           }

           /* 暗黑模式适配 (保持不变，只是为了完整性列出) */
           #phone-screen.dark-mode #chat-interface-screen .selection-controls .action-btn:hover {
               background-color: rgba(255, 255, 255, 0.1);
           }

           /* --- 新增：专门针对左侧取消按钮的样式 --- */
           #chat-interface-screen .selection-controls #selection-cancel-btn {
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 6px;
               cursor: pointer;

               /* 限制大小为 32px，与右侧保持一致 */
               width: 32px;
               height: 32px;
               border-radius: 50%;
               transition: opacity 0.2s;

               /* 确保没有额外的文字大小干扰 */
               font-size: 0;
           }

           #chat-interface-screen .selection-controls #selection-cancel-btn:hover {
               background-color: rgba(0, 0, 0, 0.05);
           }

           /* 缩小内部的 SVG 图标 */
           #chat-interface-screen .selection-controls #selection-cancel-btn svg {
               width: 18px;
               height: 18px;
               stroke-width: 2.5;
               /* 稍微加粗一点，因为图标变小了 */
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #chat-interface-screen .selection-controls #selection-cancel-btn:hover {
               background-color: rgba(255, 255, 255, 0.1);
           }

           #contact-picker-screen .header #cancel-contact-picker-btn {
               font-size: 16px;
               /* 将字体改回正常的 16px */
               width: auto;
               /* 取消图标专用的固定宽度，让文字自然撑开 */
               font-weight: normal;
               /* 不需要太粗 */
               padding: 0 5px;
               /* 增加一点点击区域 */
           }

           /* --- iOS Settings UI Transformation --- */

           /* --- iOS Settings UI Transformation --- */

           /* 背景色 */
           #api-settings-screen.ios-settings-screen {
               background-color: #f2f2f7 !important;
           }

           #phone-screen.dark-mode #api-settings-screen.ios-settings-screen {
               background-color: #000 !important;
           }

           /* 头部调整 */
           #api-settings-screen .header {
               background-color: #f2f2f7 !important;
               border-bottom: none !important;
               box-shadow: none !important;
           }

           #phone-screen.dark-mode #api-settings-screen .header {
               background-color: #000 !important;
           }

           /* 滚动容器 */
           .ios-scroll-container {
               padding: 20px 16px;
               overflow-y: auto;
               height: 100%;
               box-sizing: border-box;
           }

           /* 分组标题 */
           .settings-header {
               font-size: 13px;
               color: #6d6d72;
               margin: 24px 0 8px 16px;
               text-transform: uppercase;
           }

           #phone-screen.dark-mode .settings-header {
               color: #8d8d93;
           }

           /* 描述文本 */
           .settings-desc {
               font-size: 13px;
               color: #6d6d72;
               margin: 8px 16px 0 16px;
               line-height: 1.4;
           }

           /* 卡片分组 (Settings Section) */
           .settings-section {
               background-color: #ffffff;
               border-radius: 10px;
               overflow: hidden;
               /* 关键：切圆角 */
               margin-bottom: 20px;
           }

           #phone-screen.dark-mode .settings-section {
               background-color: #1c1c1e;
           }

           /* 列表项 (Settings Item) */
           .settings-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 11px 16px;
               /* iOS 标准高度 */
               background-color: #fff;
               border-bottom: 0.5px solid #c6c6c8;
               min-height: 44px;
               box-sizing: border-box;
           }

           #phone-screen.dark-mode .settings-item {
               background-color: #1c1c1e;
               border-bottom-color: #38383a;
           }

           /* 去掉每组最后一个元素的下边框 */
           .settings-section>.settings-item:last-child {
               border-bottom: none;
           }

           /* 针对隐藏的详情块 (如 ImgBB, NovelAI) */
           #novelai-details,
           #imgbb-settings-details,
           #catbox-settings-details,
           #github-settings-details {
               background-color: #f9f9f9;
               /* 稍微深一点区分层级 */
           }

           #phone-screen.dark-mode #novelai-details,
           #phone-screen.dark-mode #imgbb-settings-details,
           #phone-screen.dark-mode #catbox-settings-details,
           #phone-screen.dark-mode #github-settings-details {
               background-color: #252527;
           }

           /* 标签文本 */
           .settings-item label {
               font-size: 17px;
               color: #000;
               flex-shrink: 0;
               margin: 0;
           }

           #phone-screen.dark-mode .settings-item label {
               color: #fff;
           }

           /* 右侧控件区域 */
           .settings-right {
               display: flex;
               align-items: center;
               justify-content: flex-end;
               flex-grow: 1;
               margin-left: 16px;
               min-width: 0;
           }

           /* 输入框 & 选择框 (无边框风格) */
           .settings-item input[type="text"],
           .settings-item input[type="password"],
           .settings-item input[type="number"],
           .settings-select {
               width: 100%;
               border: none;
               background: transparent;
               text-align: right;
               font-size: 17px;
               color: #3c3c4399;
               /* iOS 灰色占位符色 */
               padding: 0;
               outline: none;
           }

           /* 有值时的颜色 */
           /* --- 修复 1: 将输入框和选择框的文字颜色改为黑色 --- */
           .settings-item input:not(:placeholder-shown),
           .settings-select {
               color: #000000 !important;
               /* 改为黑色 */
           }

           /* 暗黑模式下改为白色 */
           #phone-screen.dark-mode .settings-item input:not(:placeholder-shown),
           #phone-screen.dark-mode .settings-select {
               color: #ffffff !important;
           }

           /* 占位符颜色 */
           .settings-item input::placeholder {
               color: #c7c7cc;
           }

           /* 按钮样式 */
           .settings-text-btn {
               background: none;
               border: none;
               font-size: 17px;
               color: #007aff;
               cursor: pointer;
               padding: 4px 0;
           }

           .settings-text-btn.destructive {
               color: #ff3b30;
           }

           /* --- 修复 2: 优化全宽按钮，去除奇怪的黑线问题 --- */
           .settings-full-btn {
               width: 100%;
               background: #fff;
               /* 确保有背景色 */
               border: none;
               border-top: 0.5px solid #c6c6c8;
               /* 分割线 */
               padding: 14px;
               font-size: 17px;
               color: #007aff;
               cursor: pointer;
               font-weight: 400;
               /* iOS 按钮字体通常不需要加粗 */
               margin: 0;
               /* 清除外边距 */
               display: block;
               /* 确保是块级元素 */
           }

           #phone-screen.dark-mode .settings-full-btn {
               background: #1c1c1e;
               border-top-color: #38383a;
               color: #0a84ff;
           }

           /* 如果按钮是分组里的第一个元素，去掉顶部分割线 */
           .settings-section .settings-full-btn:first-child {
               border-top: none;
           }

           .settings-full-btn:active {
               background-color: #e5e5ea;
           }

           #phone-screen.dark-mode .settings-full-btn:active {
               background-color: #3a3a3c;
           }

           /* 可点击项 (Clickable Rows) */
           .settings-item.clickable {
               cursor: pointer;
               justify-content: center;
               /* 居中文字 */
           }

           .settings-item.clickable:active {
               background-color: #e5e5ea;
           }

           #phone-screen.dark-mode .settings-item.clickable:active {
               background-color: #3a3a3c;
           }

           /* 修复 Slider */
           input[type=range] {
               height: 24px;
               margin: 0;
           }

           /* 修复 Toggle Switch (复用之前的，只需确保 vertical-align) */
           .toggle-switch {
               display: flex;
               align-items: center;
           }

           /* 小按钮 (Mini Btn) */
           .settings-mini-btn {
               background-color: #f2f2f7;
               color: #007aff;
               border: none;
               border-radius: 14px;
               padding: 6px 12px;
               font-size: 14px;
               cursor: pointer;
           }

           #phone-screen.dark-mode .settings-mini-btn {
               background-color: #3a3a3c;
               color: #0a84ff;
           }

           /* 数字输入框特殊处理 */
           .settings-num-input {
               max-width: 80px;
               background-color: #f2f2f7 !important;
               border-radius: 6px !important;
               text-align: center !important;
               padding: 4px !important;
               color: #000 !important;
           }

           #phone-screen.dark-mode .settings-num-input {
               background-color: #3a3a3c !important;
               color: #fff !important;
           }

           /* Block Item (用于图片大小计算等) */
           .settings-item-block {
               padding: 11px 16px;
               background-color: #fff;
           }

           #phone-screen.dark-mode .settings-item-block {
               background-color: #1c1c1e;
           }

           /* --- 修复 1: 下拉框对齐逻辑 (闭合右对齐，展开左对齐) --- */
           .settings-select {
               text-align: right !important;
               /* 闭合状态：文字靠右 */
               text-align-last: right !important;
               /* 强制最后一行靠右 (针对部分浏览器) */
               direction: ltr !important;
               /* 保持从左到右的文字方向 */
               padding-right: 24px;
               /* 留出右侧空间给箭头或后面加的按钮 */
               background-position: right center;
               /* 确保原生箭头在右侧 */
           }

           /* 展开后的选项强制左对齐 */
           .settings-select option {
               text-align: left !important;
               direction: ltr !important;
           }

           /* --- 修复 2: 按钮改为行内简约风格 (去背景) --- */
           /* 定义一个新的行内按钮样式 */
           .settings-inline-btn {
               background: none !important;
               /* 去掉灰色背景 */
               border: none !important;
               /* 去掉边框 */
               font-size: 15px !important;
               /* 字体大小 */
               font-weight: 500 !important;
               padding: 4px 8px !important;
               /* 减小内边距 */
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               min-width: 30px;
               /* 保证触摸区域 */
           }

           /* 保存按钮 (蓝色) */
           .settings-inline-btn.save-btn {
               color: #007aff !important;
           }

           /* 删除按钮 (红色) */
           .settings-inline-btn.delete-btn {
               color: #ff3b30 !important;
               border-left: 1px solid #c6c6c8 !important;
               /* 加个左边框分隔线 */
               padding-left: 12px !important;
               margin-left: 4px;
           }

           /* 按钮点击态 */
           .settings-inline-btn:active {
               opacity: 0.5;
           }

           /* 调整右侧容器，让下拉框和按钮排成一行 */
           .settings-right {
               gap: 2px !important;
               /* 减小元素间距 */
           }

           /* --- 修复 1: 截图同款“更换”按钮样式 --- */
           .settings-mini-btn {
               background-color: #f2f2f7 !important;
               /* 浅灰背景 */
               border: 1px solid #e5e5ea !important;
               /* 极淡的边框 */
               color: #007aff !important;
               /* iOS 蓝色文字 */
               border-radius: 6px !important;
               /* 小圆角 */
               padding: 5px 12px !important;
               /* 内边距 */
               font-size: 13px !important;
               /* 字体稍小 */
               font-weight: 500 !important;
               /* 适中字重 */
               cursor: pointer;
               white-space: nowrap;
               /* 防止换行 */
               margin-left: 8px;
               /* 与左边的输入框保持距离 */
               transition: opacity 0.2s;
           }

           /* 点击时的反馈 */
           .settings-mini-btn:active {
               opacity: 0.6;
               background-color: #e5e5ea !important;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .settings-mini-btn {
               background-color: #2c2c2e !important;
               border-color: #3a3a3c !important;
               color: #0a84ff !important;
           }

           #phone-screen.dark-mode .settings-mini-btn:active {
               background-color: #3a3a3c !important;
           }

           /* --- 修正 1: 数据管理按钮改为 iOS 标准列表风格 (黑字、左对齐) --- */
           .settings-full-btn {
               width: 100%;
               background-color: #fff !important;
               border: none;
               border-top: 0.5px solid #c6c6c8 !important;
               /* 细分割线 */
               padding: 14px 16px !important;
               /* 标准内边距 */
               font-size: 17px !important;
               color: #000000 !important;
               /* 改为黑色 */
               font-weight: 400 !important;
               /* 正常字重 */
               text-align: left !important;
               /* 强制左对齐 */
               cursor: pointer;
               margin: 0 !important;
               display: block;
               border-radius: 0 !important;
           }

           /* 危险按钮保持红色，但依然左对齐 */
           .settings-full-btn[style*="color: #ff3b30"],
           .settings-full-btn[style*="color:#ff3b30"] {
               color: #ff3b30 !important;
           }

           /* 按钮点击态 */
           .settings-full-btn:active {
               background-color: #e5e5ea !important;
           }

           /* --- 修正 2: 清除“图片占用大小”旧样式的灰框和黑线 --- */
           #total-image-size-display {
               background: transparent !important;
               /* 去掉灰色背景 */
               border: none !important;
               /* 去掉边框 */
               padding: 0 !important;
               margin: 0 !important;
               color: #8a8a8a;
               font-size: 17px;
           }

           /* --- 修正 3: 让预设部分的下拉框和按钮布局更紧凑 --- */
           /* 针对预设管理那一行的特殊微调 */
           #api-settings-screen .settings-item .settings-right {
               gap: 8px !important;
               /* 增加一点间距 */
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .settings-full-btn {
               background-color: #1c1c1e !important;
               border-top-color: #38383a !important;
               color: #ffffff !important;
           }

           #phone-screen.dark-mode .settings-full-btn:active {
               background-color: #2c2c2e !important;
           }

           /* --- 修正 1: 下拉框完全左对齐，去除右侧内边距 --- */
           .settings-select {
               text-align: left !important;
               padding-left: 0 !important;
               /* 紧贴左侧 */
               direction: ltr !important;
           }

           /* --- 修正 2: 列表按钮颜色统一 (强制黑色) --- */
           .settings-full-btn {
               color: #000000 !important;
               /* 统一为黑色 */
           }

           /* 暗黑模式下统一为白色 */
           #phone-screen.dark-mode .settings-full-btn {
               color: #ffffff !important;
           }

           /* --- 修正 1: 按钮颜色统一为黑色 (去蓝去红) --- */
           /* 小按钮 (保存、删除、压缩) */
           .settings-mini-btn {
               color: #333333 !important;
               /* 黑色文字 */
               background-color: #f2f2f7 !important;
               border: 1px solid #e5e5ea !important;
               margin-left: 8px;
           }

           /* 大列表按钮 (导出、导入、清理) */
           .settings-full-btn {
               color: #333333 !important;
               /* 黑色文字 */
               text-align: left !important;
               justify-content: flex-start !important;
               padding-left: 16px !important;
           }

           /* 暗黑模式下改为白色 */
           #phone-screen.dark-mode .settings-mini-btn,
           #phone-screen.dark-mode .settings-full-btn {
               color: #ffffff !important;
           }

           /* --- 修正 2: 强制清洗 JS 生成的冗余文本 --- */
           /* 隐藏 JS 生成的 "本地图片(头像/表情...):" 这串长字 */
           #total-image-size-display #image-size-label {
               display: none !important;
           }

           /* 只显示大小数值，并调整样式 */
           #total-image-size-display #image-size-value {
               font-size: 13px;
               color: #8a8a8a;
               /* 次要信息灰色 */
               margin-top: 2px;
               display: block;
               text-align: left;
           }

           /* 移除外层容器的干扰样式 */
           #total-image-size-display {
               background: transparent !important;
               border: none !important;
               padding: 0 !important;
               margin: 0 !important;
               display: flex !important;
               flex-direction: column !important;
               align-items: flex-start !important;
           }

           /* --- 修正 3: 下拉框对齐调整 --- */
           /* 让下拉框文字紧贴左侧 */
           .settings-select {
               text-align: left !important;
               padding-left: 0 !important;
           }

           /* --- 修复 1: 暴力清除下拉框的所有间隙 --- */
           .settings-select {
               appearance: none !important;
               /* 清除系统默认外观 */
               -webkit-appearance: none !important;
               background: transparent !important;
               /* 去除背景 */
               border: none !important;
               /* 去除边框 */
               padding: 0 !important;
               /* 清除内边距 */
               margin: 0 !important;
               /* 清除外边距 */
               text-indent: 0 !important;
               /* 清除首行缩进 */
               text-align: left !important;
               /* 强制左对齐 */
               font-size: 17px !important;
               line-height: normal !important;
               color: #000 !important;
               width: 100%;
           }

           /* 暗黑模式文字颜色 */
           #phone-screen.dark-mode .settings-select {
               color: #fff !important;
           }

           /* --- 修复 2: 数据管理行布局 (实现：标题------数值 [按钮]) --- */
           /* 让右侧容器里的内容紧凑排列 */
           .data-row-right {
               display: flex;
               align-items: center;
               justify-content: flex-end;
               gap: 10px;
               /* 数值和按钮之间的间距 */
               flex-grow: 1;
           }

           /* 纯净显示数值，去掉JS生成的标签文字 */
           #total-image-size-display {
               font-size: 15px !important;
               color: #8a8a8a !important;
               /* 次要信息用灰色 */
               background: none !important;
               border: none !important;
               padding: 0 !important;
               margin: 0 !important;
           }

           /* 隐藏掉 JS 自动生成的 "本地图片(xxx):" 这种长文本，只留数字 */
           #total-image-size-display #image-size-label {
               display: none !important;
           }

           #total-image-size-display #image-size-value {
               font-weight: 400 !important;
               color: #8a8a8a !important;
           }

           #api-preset-select.settings-select {
               text-align: left !important;
               /* 强制左对齐 */
               text-align-last: left !important;
               /* 针对选中值的强制左对齐 (关键) */
               padding-left: 0 !important;
               /* 去除左侧内边距 */
               direction: ltr !important;
               /* 从左到右排列 */
               width: 100% !important;
               /* 占满容器 */
               display: block !important;
           }

           /* --- 修复: 还原灰色的说明/教程条 --- */
           /* 这是一个列表项容器，确保它在白色卡片内占位 */
           .settings-tip-wrapper {
               padding: 10px 16px;
               background-color: #fff;
               border-bottom: 0.5px solid #c6c6c8;
           }

           /* 这是里面的灰色圆角框 (对应你截图的样子) */
           .settings-tip-content {
               background-color: #f0f0f0;
               /* 浅灰背景 */
               color: #666666;
               /* 深灰文字 */
               font-size: 13px;
               padding: 10px;
               border-radius: 8px;
               /* 圆角 */
               line-height: 1.5;
               /* 行高，易读 */
           }

           /* 强调文字 (红色警告) */
           .settings-tip-content strong {
               color: #ff3b30;
               font-weight: 600;
           }

           /* 链接样式 */
           .settings-tip-content a {
               color: #007aff;
               text-decoration: none;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .settings-tip-wrapper {
               background-color: #1c1c1e;
               border-bottom-color: #38383a;
           }

           #phone-screen.dark-mode .settings-tip-content {
               background-color: #2c2c2e;
               /* 深色背景 */
               color: #aeaeb2;
           }

           /* ============================================================
   【独立修复】聊天详情页下拉框 (不影响 API 设置页)
   ============================================================ */

           /* 1. 将选择器限定在 #chat-settings-screen 内 */
           #chat-settings-screen .settings-select {
               /* 恢复灰色背景条 */
               background-color: #f2f2f7 !important;

               /* 加回边框和圆角，让它看起来像个按钮 */
               border: 1px solid #e5e5ea !important;
               border-radius: 6px !important;

               /* 调整内边距：上下 6px 保证高度与旁边的“更换”按钮一致 */
               padding: 6px 25px 6px 12px !important;

               /* 恢复黑色文字 */
               color: #333 !important;

               /* 默认：强制左对齐 */
               text-align: left !important;
               text-align-last: left !important;

               /* 添加一个小箭头图标，让它看起来更像下拉框 */
               background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%238a8a8a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e") !important;
               background-repeat: no-repeat !important;
               background-position: right 8px center !important;
               background-size: 12px !important;

               /* 确保高度撑开 */
               min-height: 28px !important;
               line-height: normal !important;
           }

           /* 2. 【特例】语音语言选择：强制右对齐 */
           #chat-settings-screen #ai-voice-lang-select {
               text-align: right !important;
               text-align-last: right !important;
               direction: ltr !important;
               /* 右侧留出一点空间给箭头，但文字靠右 */
               padding-right: 30px !important;
               padding-left: 0 !important;
           }

           /* 3. 暗黑模式适配 (仅针对聊天设置页) */
           #phone-screen.dark-mode #chat-settings-screen .settings-select {
               background-color: #3a3a3c !important;
               border-color: #48484a !important;
               color: #fff !important;

               /* 暗黑模式下箭头变白一点 */
               background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e") !important;
           }

           #ai-avatar-group,
           #group-avatar-group,
           #my-avatar-group {
               /* 1. 改变主轴方向为垂直，让标签和内容换行 */
               flex-direction: column !important;

               /* 2. 让子元素拉伸填满宽度 */
               align-items: stretch !important;

               /* 3. 增加标签和下方内容之间的间距 */
               gap: 8px !important;

               /* 4. 确保高度自适应 */
               height: auto !important;
               padding-bottom: 12px !important;
           }

           /* 修正下方内容区域的边距 */
           #ai-avatar-group .settings-right,
           #group-avatar-group .settings-right,
           #my-avatar-group .settings-right {
               /* 换行后不再需要左边距 */
               margin-left: 0 !important;

               /* 确保占满整行宽度 */
               width: 100% !important;
           }

           /* 确保头像操作区两端对齐 (头像在左，按钮在右) */
           #ai-avatar-group .avatar-action-wrapper,
           #group-avatar-group .avatar-action-wrapper,
           #my-avatar-group .avatar-action-wrapper {
               justify-content: space-between !important;
               width: 100% !important;
           }

           #toggle-reading-fullscreen-btn {
               background: none;
               border: none;
               cursor: pointer;
               color: var(--text-secondary);
               padding: 4px 8px;
               border-radius: 4px;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: background-color 0.2s;
           }

           #toggle-reading-fullscreen-btn:hover {
               background-color: rgba(0, 0, 0, 0.1);
           }

           /* 2. 当窗口全屏时，切换按钮内的图标 */
           #reading-window.fullscreen #toggle-reading-fullscreen-btn .icon-maximize {
               display: none;
           }

           #reading-window.fullscreen #toggle-reading-fullscreen-btn .icon-minimize {
               display: block;
           }

           /* 3. 窗口全屏时的核心样式 */
           #reading-window.fullscreen {
               width: 100%;
               height: 100%;
               max-width: 100%;
               max-height: 100%;
               top: 0 !important;
               left: 0 !important;
               border-radius: 0;
               box-shadow: none;
               transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }

           /* 4. 遮罩层在全屏时的样式 */
           #reading-overlay.fullscreen-active {
               align-items: stretch;
               justify-content: stretch;
           }

           /* --- “一起读书”全屏功能样式 优化版 --- */

           /* 1. 修复头部布局，防止标题过长把按钮挤下去 */
           .reading-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               gap: 10px;
               /* 标题和按钮组之间的间距 */
               flex-wrap: nowrap;
               /* 强制不换行 */
           }

           #reading-title {
               flex: 1;
               /* 占据可用空间 */
               min-width: 0;
               /* 允许被压缩 */
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               /* 标题过长时显示省略号 */
           }

           .reading-controls {
               flex-shrink: 0;
               /* 防止按钮组被压缩 */
               display: flex;
               /* 确保内部按钮水平排列 */
               align-items: center;
           }

           /* 2. 美化新的全屏/最小化按钮 */
           #toggle-reading-fullscreen-btn {
               background: none;
               border: none;
               cursor: pointer;
               color: var(--text-secondary);
               padding: 4px 8px;
               /* 调整点击区域 */
               border-radius: 4px;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: background-color 0.2s;
           }

           #toggle-reading-fullscreen-btn:hover {
               background-color: rgba(0, 0, 0, 0.1);
           }

           /* 3. 当窗口全屏时，切换按钮内的图标显示 */
           #reading-window.fullscreen #toggle-reading-fullscreen-btn .icon-maximize {
               display: none;
           }

           #reading-window.fullscreen #toggle-reading-fullscreen-btn .icon-minimize {
               display: block;
           }

           /* 4. 窗口全屏时的核心样式 (与上次相同) */
           #reading-window.fullscreen {
               width: 100%;
               height: 100%;
               max-width: 100%;
               max-height: 100%;
               top: 0 !important;
               left: 0 !important;
               border-radius: 0;
               box-shadow: none;
               transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }

           /* 5. 遮罩层在全屏时的样式 (与上次相同) */
           #reading-overlay.fullscreen-active {
               align-items: stretch;
               justify-content: stretch;
           }

           /* =========================================== */
           /* ▼▼▼ 阅读模式全屏/头部修复补丁 ▼▼▼ */
           /* =========================================== */

           /* 1. 修复全屏状态下的图标切换逻辑 */
           /* 默认状态：显示最大化图标，隐藏还原图标 */
           #toggle-reading-fullscreen-btn .icon-maximize {
               display: block !important;
           }

           #toggle-reading-fullscreen-btn .icon-minimize {
               display: none !important;
           }

           /* 全屏状态：隐藏最大化图标，显示还原图标 */
           #reading-window.fullscreen #toggle-reading-fullscreen-btn .icon-maximize {
               display: none !important;
           }

           #reading-window.fullscreen #toggle-reading-fullscreen-btn .icon-minimize {
               display: block !important;
           }

           /* 2. 修复全屏时的头部布局与间距 (解决重叠问题) */
           #reading-window.fullscreen .reading-header {
               /* 【核心修复】增加顶部内边距：
       45px 是避让状态栏的基础高度，
       env(safe-area-inset-top) 是适配刘海屏/灵动岛
    */
               padding-top: calc(45px + env(safe-area-inset-top)) !important;
               padding-bottom: 15px !important;
               padding-left: 20px !important;
               padding-right: 20px !important;

               /* 强制高度自适应 */
               height: auto !important;
               min-height: 80px !important;
               /* 保证有足够的高度 */

               /* 修复背景色：全屏时必须有不透明背景，否则内容会透出来 */
               background-color: #fff !important;
               /* 加上底部边框线 */
               border-bottom: 1px solid var(--border-color) !important;

               /* 确保头部在最上层 */
               z-index: 10 !important;

               /* 强制且绝对的顶部定位，防止被父级flex影响 */
               position: absolute !important;
               top: 0 !important;
               left: 0 !important;
               width: 100% !important;
               box-sizing: border-box !important;
           }

           /* 3. 暗黑模式适配 */
           #phone-screen.dark-mode #reading-window.fullscreen .reading-header {
               background-color: #1c1c1e !important;
               /* 暗黑模式背景色 */
               border-bottom-color: #38383a !important;
           }

           /* 4. 修复全屏时的内容区域，防止被加高的头部遮挡 */
           #reading-window.fullscreen #reading-content {
               /* 给内容顶部增加更多的内边距，因为头部变高了 */
               padding-top: calc(100px + env(safe-area-inset-top)) !important;
           }

           /* --- iOS 风格通用化适配 (适配外观设置页) --- */

           /* 让两个页面都使用 iOS 背景色 */
           #api-settings-screen.ios-settings-screen,
           #wallpaper-screen {
               background-color: #f2f2f7 !important;
           }

           #phone-screen.dark-mode #api-settings-screen.ios-settings-screen,
           #phone-screen.dark-mode #wallpaper-screen {
               background-color: #000 !important;
           }

           /* 头部适配 */
           #wallpaper-screen .header {
               background-color: #f2f2f7 !important;
               border-bottom: none !important;
               box-shadow: none !important;
           }

           #phone-screen.dark-mode #wallpaper-screen .header {
               background-color: #000 !important;
           }

           /* 确保外观设置页使用滚动容器样式 */
           #wallpaper-screen .settings-container {
               padding: 10px 16px;
               padding-bottom: calc(20px + env(safe-area-inset-bottom));
               box-sizing: border-box;
               overflow-y: auto;
           }

           /* 壁纸预览图样式优化 (小图模式) */
           .wallpaper-thumbnail {
               width: 40px;
               height: 70px;
               /* 9:16 比例 */
               border-radius: 6px;
               background-color: #eee;
               background-size: cover;
               background-position: center;
               border: 1px solid #d1d1d6;
               margin-right: 8px;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 10px;
               color: #999;
               overflow: hidden;
               text-align: center;
               line-height: 1.2;
           }

           #phone-screen.dark-mode .wallpaper-thumbnail {
               background-color: #2c2c2e;
               border-color: #3a3a3c;
           }

           /* 按钮组微调 */
           .action-btn-group {
               display: flex;
               gap: 6px;
           }

           /* 隐藏的 Input 保持隐藏 */
           .hidden-input {
               display: none !important;
           }

           /* 图标网格在白色卡片内的适配 */
           .settings-icon-grid {
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
               gap: 15px;
               padding: 10px 0;
           }

           .settings-icon-grid .icon-setting-item {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 6px;
           }

           .settings-icon-grid .icon-preview {
               width: 50px;
               height: 50px;
               border-radius: 12px;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
               border: 1px solid rgba(0, 0, 0, 0.1);
           }

           /* 拖拽排序区域适配 */
           #button-order-editor {
               background-color: transparent !important;
               /* 移除原有的灰色背景 */
               border: none !important;
               padding: 0 !important;
               display: flex;
               flex-wrap: wrap;
               gap: 8px;
           }

           .draggable-button-item {
               background-color: #f2f2f7;
               border: 1px solid #e5e5ea;
               border-radius: 8px;
               padding: 6px 10px;
           }

           #phone-screen.dark-mode .draggable-button-item {
               background-color: #2c2c2e;
               border-color: #3a3a3c;
           }

           /* 锁屏密码输入框适配 */
           #lock-screen-password-input {
               letter-spacing: 8px !important;
               font-weight: bold !important;
               font-size: 20px !important;
               text-align: center !important;
               background-color: #f2f2f7 !important;
               border-radius: 8px;
               height: 40px;
           }

           #phone-screen.dark-mode #lock-screen-password-input {
               background-color: #2c2c2e !important;
           }

           /* 文本域适配 */
           #global-css-input {
               font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
               font-size: 12px;
               background-color: #f2f2f7;
               border: none;
               border-radius: 8px;
               padding: 10px;
               min-height: 100px;
           }

           #phone-screen.dark-mode #global-css-input {
               background-color: #2c2c2e;
               color: #fff;
           }

           /* --- 修复：壁纸预览图样式 (带强制覆盖) --- */
           .wallpaper-thumbnail {
               /* 使用 !important 强制覆盖旧的 #wallpaper-preview 样式 */
               width: 40px !important;
               height: 70px !important;
               /* 9:16 比例 */

               border-radius: 6px;
               background-color: #eee;
               background-size: cover;
               background-position: center;

               /* 覆盖旧的边框样式 */
               border: 1px solid #d1d1d6 !important;
               margin: 0 !important;
               margin-right: 8px !important;

               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 10px;
               color: #999;
               overflow: hidden;
               text-align: center;
               line-height: 1.2;
               flex-shrink: 0;
               /* 防止被挤压 */
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .wallpaper-thumbnail {
               background-color: #2c2c2e;
               border-color: #3a3a3c !important;
           }

           /* 天气设置专用样式 - 保持原生风格 */
           .weather-input-group {
               display: flex;
               align-items: center;
               gap: 8px;
               margin-top: 8px;
               width: 100%;
           }

           .weather-input {
               flex: 1;
               /* 让输入框平分宽度 */
               background-color: #f2f2f7;
               /* 与原生输入框背景一致 */
               border: none;
               border-radius: 6px;
               padding: 8px 10px;
               font-size: 14px;
               color: #333;
               outline: none;
               min-width: 0;
               /* 防止溢出 */
           }

           .weather-result-text {
               font-size: 12px;
               color: #8a8a8a;
               margin-top: 6px;
               text-align: left;
               /* 左对齐看起来更整齐 */
               padding-left: 2px;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .weather-input {
               background-color: #3a3a3c;
               color: #fff;
           }

           /* --- 主屏幕第二页布局调整 --- */
           #page-2-app-container {
               display: grid;
               grid-template-columns: 155px 1fr;
               /* 保持原来的列宽比例 */
               gap: 15px;
               width: 100%;
               padding-top: 20px;
               align-items: start;
           }

           .left-column-stack {
               display: flex;
               flex-direction: column;
               gap: 15px;
               /* 组件和下方App的间距 */
           }

           .left-app-grid {
               display: grid;
               grid-template-columns: repeat(2, 1fr);
               /* 左侧下方也是两列 */
               gap: 15px;
               justify-items: center;
           }

           /* 支付宝图标专用样式 */
           .alipay-icon-bg {
               background-color: #1677ff;
               /* 支付宝蓝 */
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .alipay-icon-bg img {
               width: 80%;
               height: 80%;
               object-fit: contain;
           }

           /* --- 支付宝 App 界面样式 --- */
           #alipay-screen {
               background-color: #f5f5f5;
               display: flex;
               flex-direction: column;
               transition: background-color 0.5s;
           }

           /* 默认蓝色主题 */
           #alipay-screen {
               --alipay-primary: #1677ff;
               --alipay-text: #ffffff;
               --alipay-card-bg: #1677ff;
               --alipay-bill-bg: #ffffff;
               --alipay-bill-text: #333333;
           }

           /* 黑金主题 (通过JS添加 class .theme-blackgold) */
           #alipay-screen.theme-blackgold {
               --alipay-primary: #1a1a1a;
               --alipay-text: #d4af37;
               /* 金色 */
               --alipay-card-bg: linear-gradient(135deg, #2b2b2b, #000000);
               --alipay-bill-bg: #1c1c1e;
               --alipay-bill-text: #e0e0e0;
               background-color: #121212 !important;
           }

           .alipay-header-area {
               background-color: var(--alipay-primary);
               color: var(--alipay-text);
               padding-bottom: 60px;
               /* 为卡片留出空间 */
               padding-top: calc(50px + env(safe-area-inset-top));
               transition: background-color 0.5s;
           }

           .alipay-nav {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 10px 15px;
               font-size: 18px;
           }

           .alipay-action {
               font-size: 14px;
               cursor: pointer;
           }

           .alipay-card-container {
               padding: 0 15px;
               margin-top: -50px;
               /* 上浮效果 */
           }

           .alipay-balance-card {
               background: var(--alipay-card-bg);
               color: var(--alipay-text);
               border-radius: 12px;
               padding: 25px 20px;
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
               transition: all 0.5s;
           }

           #alipay-screen.theme-blackgold .alipay-balance-card {
               box-shadow: 0 4px 20px rgba(212, 175, 55, 0.2);
               /* 金色光晕 */
               border: 1px solid #333;
           }

           .balance-label {
               font-size: 13px;
               opacity: 0.8;
           }

           .balance-amount {
               font-size: 42px;
               font-weight: 700;
               margin: 5px 0 10px 0;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
           }

           .balance-status-tag {
               display: inline-block;
               padding: 2px 8px;
               border: 1px solid currentColor;
               border-radius: 4px;
               font-size: 11px;
               opacity: 0.8;
           }

           .alipay-bill-container {
               flex-grow: 1;
               background-color: var(--alipay-bill-bg);
               margin-top: 20px;
               border-radius: 20px 20px 0 0;
               padding: 20px;
               overflow-y: auto;
               display: flex;
               flex-direction: column;
               color: var(--alipay-bill-text);
           }

           .bill-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-bottom: 15px;
               font-weight: 600;
               font-size: 16px;
           }

           /* 账单列表项 */
           .bill-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px 0;
               border-bottom: 1px solid rgba(0, 0, 0, 0.05);
           }

           #alipay-screen.theme-blackgold .bill-item {
               border-bottom: 1px solid rgba(255, 255, 255, 0.1);
           }

           .bill-info {
               display: flex;
               flex-direction: column;
               gap: 4px;
           }

           .bill-title {
               font-size: 15px;
               font-weight: 500;
           }

           .bill-time {
               font-size: 12px;
               opacity: 0.6;
           }

           .bill-amount {
               font-size: 17px;
               font-weight: 600;
           }

           .bill-amount.income {
               color: #ff3b30;
           }

           /* 收入红色 */
           .bill-amount.expense {
               color: #1f1f1f;
           }

           /* 支出黑色 */

           #alipay-screen.theme-blackgold .bill-amount.expense {
               color: #e0e0e0;
           }

           #alipay-screen.theme-blackgold .bill-amount.income {
               color: #ff4d4f;
           }

           .kinship-invite-card {
               width: 250px;
               /* 稍微加宽一点 */
               background-color: #fff;
               border-radius: 12px;
               overflow: hidden;
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
               /* 更柔和的阴影 */
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
               border: none;
               /* 去掉默认边框 */
           }

           /* 头部：渐变背景 + 装饰 */
           .kinship-invite-header {
               background: linear-gradient(135deg, #FF6B6B, #EE0979);
               /* 更加现代的红粉渐变 */
               padding: 20px 15px;
               color: white;
               text-align: center;
               position: relative;
               overflow: hidden;
           }

           /* 头部背景装饰圆圈（纯CSS画的） */
           .kinship-invite-header::before {
               content: '';
               position: absolute;
               top: -20px;
               right: -20px;
               width: 80px;
               height: 80px;
               background: rgba(255, 255, 255, 0.1);
               border-radius: 50%;
           }

           .kinship-invite-header::after {
               content: '';
               position: absolute;
               bottom: -10px;
               left: -10px;
               width: 40px;
               height: 40px;
               background: rgba(255, 255, 255, 0.15);
               border-radius: 50%;
           }

           .kinship-title {
               font-size: 17px;
               font-weight: 600;
               letter-spacing: 0.5px;
               position: relative;
               z-index: 2;
           }

           .kinship-subtitle {
               font-size: 12px;
               opacity: 0.9;
               margin-top: 4px;
               position: relative;
               z-index: 2;
           }

           /* 主体内容：金额显示 */
           .kinship-invite-body {
               padding: 25px 15px;
               text-align: center;
               background-color: #fff;
           }

           .kinship-limit-label {
               font-size: 13px;
               color: #888;
               margin-bottom: 8px;
           }

           .kinship-limit-amount {
               font-size: 36px;
               font-weight: 700;
               color: #333;
               /* 改为深色，更有金融质感 */
               font-family: "DIN Alternate", "Roboto", sans-serif;
               /* 如果系统支持，数字会更好看 */
               line-height: 1;
           }

           .kinship-limit-amount::first-letter {
               font-size: 20px;
               /* 货币符号稍微小一点 */
               margin-right: 2px;
               font-weight: 500;
           }

           /* 底部状态栏 */
           .kinship-status {
               font-size: 12px;
               padding: 12px 15px;
               background: #F9F9F9;
               /* 很浅的灰色 */
               color: #999;
               text-align: left;
               /* 左对齐看起来更像系统单据 */
               border-top: 1px solid #eee;
               display: flex;
               align-items: center;
               gap: 6px;
           }

           /* 状态点 (可选) */
           .kinship-status::before {
               content: '';
               display: inline-block;
               width: 6px;
               height: 6px;
               border-radius: 50%;
               background-color: #ccc;
           }

           /* 不同状态的颜色修饰 */
           .kinship-status[data-status="pending"]::before {
               background-color: #ff9800;
           }

           .kinship-status[data-status="accepted"]::before {
               background-color: #52c41a;
           }

           .kinship-status[data-status="rejected"]::before {
               background-color: #ff4d4f;
           }

           /* 聊天中的亲属卡气泡去背景 */
           .message-bubble.is-kinship-request .content {
               padding: 0;
               background: transparent !important;
               box-shadow: none;
           }

           /* --- 支付宝钱包页面的亲属卡列表样式 (补回) --- */
           .kinship-card-entry {
               background: linear-gradient(135deg, #ff5252, #ff1744);
               border-radius: 12px;
               padding: 15px;
               color: white;
               margin-bottom: 15px;
               position: relative;
               overflow: hidden;
               box-shadow: 0 4px 12px rgba(255, 23, 68, 0.3);
               cursor: pointer;
           }

           /* 右下角的装饰爱心 */
           .kinship-card-entry::after {
               content: '❤️';
               position: absolute;
               right: -10px;
               bottom: -20px;
               font-size: 80px;
               opacity: 0.2;
               transform: rotate(-15deg);
           }

           .kinship-top {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-bottom: 20px;
               position: relative;
               z-index: 2;
           }

           .kinship-provider {
               display: flex;
               align-items: center;
               gap: 8px;
               font-size: 15px;
               font-weight: 600;
           }

           /* 这里就是控制那张大图变回小头像的关键代码 */
           .kinship-provider img {
               width: 24px;
               height: 24px;
               border-radius: 50%;
               border: 1px solid rgba(255, 255, 255, 0.5);
               object-fit: cover;
           }

           .kinship-limit {
               font-size: 24px;
               font-weight: bold;
               position: relative;
               z-index: 2;
               font-family: "DIN Alternate", sans-serif;
           }

           .kinship-label {
               font-size: 12px;
               opacity: 0.8;
               position: relative;
               z-index: 2;
           }

           /* 支付宝亲属卡卡片内的解绑按钮 */
           .kinship-card-entry .alipay-unbind-btn {
               position: absolute;
               top: 10px;
               right: 10px;
               background: rgba(0, 0, 0, 0.2);
               /* 半透明黑底 */
               color: white;
               border: 1px solid rgba(255, 255, 255, 0.5);
               font-size: 12px;
               padding: 2px 8px;
               border-radius: 12px;
               cursor: pointer;
               z-index: 10;
               /* 保证点得到 */
               transition: background 0.2s;
           }

           .kinship-card-entry .alipay-unbind-btn:hover {
               background: rgba(0, 0, 0, 0.4);
           }

           /* --- 支付宝黑金模式适配补丁 --- */

           /* 暂无亲属卡的空状态样式 */
           .kinship-empty-state {
               text-align: center;
               padding: 20px;
               background: white;
               border-radius: 12px;
               color: #999;
               font-size: 13px;
               transition: all 0.3s;
           }

           /* 黑金模式下的空状态 */
           .theme-blackgold .kinship-empty-state {
               background: rgba(255, 255, 255, 0.1) !important;
               /* 半透明深色 */
               color: #d4af37 !important;
               /* 金色文字 */
               border: 1px solid rgba(212, 175, 55, 0.3);
               /* 金色边框 */
           }

           /* 黑金模式下的添加按钮 */
           .theme-blackgold #add-kinship-btn {
               color: #d4af37 !important;
               /* 按钮变金 */
           }

           /* 黑金模式下的标题文字 */
           .theme-blackgold #alipay-kinship-section span {
               color: #d4af37 !important;
               /* 标题变金 */
           }

           /* --- 支付收银台弹窗美化 --- */

           /* 1. 弹窗内的按钮容器 */
           #custom-modal .custom-modal-footer {
               /* 让列表更紧凑，去掉默认的居中 */
               display: flex;
               flex-direction: column;
               padding: 0;
               max-height: 60vh;
               overflow-y: auto;
           }

           /* 2. 支付选项按钮 (原来那些蓝色的字) */
           .payment-option-item {
               display: flex !important;
               align-items: center;
               justify-content: space-between;
               width: 100%;
               padding: 15px 20px !important;
               background-color: #fff !important;
               border: none !important;
               border-bottom: 1px solid #f5f5f5 !important;
               cursor: pointer;
               text-decoration: none !important;
               transition: background-color 0.2s;
               margin: 0 !important;
               height: auto !important;
           }

           .payment-option-item:active {
               background-color: #f9f9f9 !important;
           }

           /* 最后一项去掉边框 */
           .payment-option-item:last-child {
               border-bottom: none !important;
           }

           /* 3. 内部元素布局 */
           .pay-opt-left {
               display: flex;
               align-items: center;
               gap: 12px;
               text-align: left;
           }

           /* 图标样式 */
           .pay-opt-icon {
               width: 28px;
               height: 28px;
               border-radius: 4px;
           }

           /* 文字信息 */
           .pay-opt-info {
               display: flex;
               flex-direction: column;
               gap: 2px;
           }

           .pay-opt-title {
               font-size: 16px;
               color: #333;
               font-weight: 500;
           }

           .pay-opt-desc {
               font-size: 12px;
               color: #999;
           }

           /* 余额不足时的样式 (可选) */
           .payment-option-item.disabled {
               opacity: 0.6;
               pointer-events: none;
           }

           /* 适配暗黑模式 */
           #phone-screen.dark-mode .payment-option-item {
               background-color: #1c1c1e !important;
               border-bottom-color: #2c2c2e !important;
           }

           #phone-screen.dark-mode .pay-opt-title {
               color: #fff;
           }

           #phone-screen.dark-mode .pay-opt-desc {
               color: #666;
           }

           /* --- 支付宝亲属卡布局终极修复 --- */

           /* 1. 滚动容器 */
           #alipay-kinship-section {
               display: flex !important;
               flex-direction: row !important;
               overflow-x: auto !important;
               overflow-y: hidden !important;
               gap: 15px;
               padding: 5px 5px 15px 5px;
               /* 增加内边距，防止阴影被切 */

               /* 关键：让内容在只有一张卡时也能撑开容器 */
               width: 100%;
               box-sizing: border-box;

               /* 隐藏滚动条 */
               -webkit-overflow-scrolling: touch;
               scrollbar-width: none;
           }

           #alipay-kinship-section::-webkit-scrollbar {
               display: none;
           }

           /* 2. 单卡样式优化 */
           .kinship-card-entry {
               /* 核心修改：使用 flex-shrink: 0 防止被挤压 */
               flex-shrink: 0;

               /* 核心修改：宽度逻辑 */
               /* 默认宽度，适合多卡并排 */
               width: 85vw;
               max-width: 320px;
               min-width: 260px;

               margin-bottom: 0 !important;

               /* 视觉美化 */
               box-shadow: 0 4px 15px rgba(255, 23, 68, 0.25);
               border-radius: 16px;
           }


           /* 1. 修复亲属卡宽度问题 */
           /* 逻辑：如果列表里只有一张卡，强制占满容器宽度，和余额卡对齐 */
           #alipay-kinship-section:has(.kinship-card-entry:only-child) .kinship-card-entry {
               width: 100% !important;
               max-width: none !important;
               min-width: 0 !important;
               margin-right: 0 !important;
           }

           /* 确保容器本身的内边距不会导致对齐偏差 */
           #alipay-kinship-section {
               padding-left: 0 !important;
               /* 移除左边距，依靠父容器对齐 */
               padding-right: 0 !important;
           }

           /* 2. 修复支付宝图标不铺满的问题 */
           /* 去掉原本给支付宝特意留的边距，让图片强制撑满 */
           .alipay-icon-bg {
               padding: 0 !important;
               /* 去掉内边距 */
               display: block !important;
               /* 确保是块级布局 */
           }

           .alipay-icon-bg img {
               width: 100% !important;
               /* 宽度撑满 */
               height: 100% !important;
               /* 高度撑满 */
               object-fit: cover !important;
               /* 裁剪以铺满，不留白边 */
               border-radius: inherit !important;
               /* 继承父级的圆角 */
               margin: 0 !important;
           }

           /* 4. 空状态优化 */
           .kinship-empty-state {
               width: 100%;
               flex-shrink: 0;
               padding: 30px 20px;
               background-color: #fff;
               border-radius: 12px;
               text-align: center;
               color: #999;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
           }

           #alipay-kinship-section:has(.kinship-card-entry:only-child) {
               display: block !important;
               /* 关键：取消 Flex */
               overflow: visible !important;
               /* 关键：不需要滚动 */
               white-space: normal !important;
               padding-right: 5px !important;
               /* 保持一点右边距美观 */
           }

           /* 2. 针对只有一张卡的情况：卡片样式重置 */
           #alipay-kinship-section:has(.kinship-card-entry:only-child) .kinship-card-entry {
               width: auto !important;
               /* 关键：自动宽度 (Block布局下等于占满) */
               max-width: 100% !important;
               /* 双重保险：绝不超过父容器 */
               min-width: 0 !important;
               /* 清除之前设置的 260px 最小宽度 */
               margin: 0 !important;
               /* 清除边距 */
               flex: none !important;
               /* 禁用 flex 属性 */
               transform: none !important;
               /* 防止变换导致的位置偏移 */
           }

           /* 3. 确保多张卡片时（Flex布局）依然正常 */
           #alipay-kinship-section {
               /* 这里保持之前的设置，确保多张卡时横向滚动 */
               box-sizing: border-box;
           }

           /* 4. 再次确保图标铺满 (以防被覆盖) */
           .alipay-icon-bg {
               padding: 0 !important;
               display: block !important;
           }

           .alipay-icon-bg img {
               width: 100% !important;
               height: 100% !important;
               object-fit: cover !important;
               border-radius: inherit !important;
               margin: 0 !important;
           }

           /* --- 支付宝账单筛选与分页样式 --- */
           .alipay-bill-container {
               padding: 0 !important;
               /*以此覆盖旧padding，由内部元素控制 */
               background-color: #f5f5f5;
               display: flex;
               flex-direction: column;
               overflow: hidden;
               /* 容器本身不滚动，内部列表滚动 */
           }

           /* 筛选栏头部 */
           .bill-filter-header {
               background-color: #fff;
               padding: 10px 15px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               border-bottom: 1px solid #eee;
               flex-shrink: 0;
               z-index: 10;
           }

           /* 日期选择器美化 */
           .bill-date-picker-wrapper {
               position: relative;
               display: flex;
               align-items: center;
               background-color: #f5f5f5;
               border-radius: 20px;
               padding: 5px 12px;
           }

           .bill-date-input {
               border: none;
               background: transparent;
               font-size: 14px;
               color: #333;
               font-weight: 500;
               outline: none;
               width: 110px;
           }

           /* 类型切换标签 */
           .bill-type-tabs {
               display: flex;
               gap: 15px;
           }

           .bill-type-tab {
               font-size: 14px;
               color: #666;
               cursor: pointer;
               padding: 4px 0;
               position: relative;
               transition: color 0.2s;
           }

           .bill-type-tab.active {
               color: #1677ff;
               /* 支付宝蓝 */
               font-weight: 600;
           }

           /* 黑金模式下的选中态 */
           .theme-blackgold .bill-type-tab.active {
               color: #d4af37;
           }

           .bill-type-tab.active::after {
               content: '';
               position: absolute;
               bottom: 0;
               left: 50%;
               transform: translateX(-50%);
               width: 100%;
               height: 2px;
               background-color: currentColor;
               border-radius: 2px;
           }

           /* 滚动列表区域 */
           #bill-scroll-list {
               flex-grow: 1;
               overflow-y: auto;
               padding: 0 15px;
               background-color: #fff;
           }

           /* 列表月份分割线 */
           .bill-month-separator {
               padding: 15px 0 5px 0;
               font-size: 13px;
               color: #999;
               background-color: #fff;
               position: sticky;
               top: 0;
               z-index: 5;
           }

           /* 加载更多提示 */
           .bill-loading-more {
               text-align: center;
               padding: 15px;
               color: #999;
               font-size: 12px;
           }

           .bill-loading-more.hidden {
               display: none;
           }

           /* 1. 容器与背景变黑 */
           #alipay-screen.theme-blackgold .alipay-bill-container,
           #alipay-screen.theme-blackgold .bill-filter-header,
           #alipay-screen.theme-blackgold #bill-scroll-list {
               background-color: #121212 !important;
               /* 深黑背景 */
               border-color: #333 !important;
           }

           /* 2. 筛选栏头部 */
           #alipay-screen.theme-blackgold .bill-filter-header {
               border-bottom: 1px solid #2c2c2e;
           }

           /* 3. 日期选择器美化 */
           #alipay-screen.theme-blackgold .bill-date-picker-wrapper {
               background-color: #2c2c2e !important;
               /* 比背景稍亮的灰色 */
               border: 1px solid #444;
           }

           #alipay-screen.theme-blackgold .bill-date-input {
               color: #d4af37 !important;
               /* 金色文字 */
               color-scheme: dark;
               /* 让浏览器自带的日期弹窗也变成深色 */
           }

           /* 4. 类型切换标签 */
           #alipay-screen.theme-blackgold .bill-type-tab {
               color: #888;
           }

           #alipay-screen.theme-blackgold .bill-type-tab.active {
               color: #d4af37 !important;
               /* 选中变为金色 */
           }

           /* 5. 列表内容适配 */
           #alipay-screen.theme-blackgold .bill-month-separator {
               background-color: #121212 !important;
               /* 与背景同色 */
               color: #d4af37 !important;
               /* 月份标题变金 */
           }

           #alipay-screen.theme-blackgold .bill-item {
               border-bottom-color: #2c2c2e !important;
           }

           /* 账单标题 */
           #alipay-screen.theme-blackgold .bill-title {
               color: #e0e0e0 !important;
               /* 浅灰偏白 */
           }

           /* 账单时间 */
           #alipay-screen.theme-blackgold .bill-time {
               color: #666 !important;
           }

           /* 支出金额 (原本是黑色，现在变白) */
           #alipay-screen.theme-blackgold .bill-amount.expense {
               color: #ffffff !important;
           }

           /* 收入金额 (原本是红色，现在变金或者淡红，这里选金色呼应主题) */
           #alipay-screen.theme-blackgold .bill-amount.income {
               color: #d4af37 !important;
           }

           /* 底部加载提示 */
           #alipay-screen.theme-blackgold .bill-loading-more {
               color: #666 !important;
           }

           /* 如果列表为空的提示文字 */
           #alipay-screen.theme-blackgold .bill-empty-msg {
               color: #666 !important;
           }

           .alipay-bill-container {
               border-radius: 5px 5px 0 0 !important;
           }

           /* 2. 让筛选栏头部也拥有圆角，与容器贴合 */
           .bill-filter-header {
               border-radius: 5px 5px 0 0;
               /* 稍微增加一点左侧内边距，让文字离边缘远一点 */
               padding-left: 20px !important;
           }

           /* --- 基金理财模块样式 --- */
           .fund-item {
               background-color: white;
               border-radius: 12px;
               padding: 15px;
               margin-bottom: 12px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02);
               transition: transform 0.1s;
           }

           .fund-item:active {
               transform: scale(0.98);
               background-color: #f9f9f9;
           }

           .fund-info h4 {
               margin: 0 0 4px 0;
               font-size: 15px;
               font-weight: 600;
               color: #333;
           }

           .fund-tags {
               display: flex;
               gap: 5px;
           }

           .fund-tag {
               font-size: 10px;
               padding: 1px 4px;
               border-radius: 3px;
               background-color: #f0f2f5;
               color: #666;
           }

           .fund-tag.high-risk {
               background-color: #fff1f0;
               color: #ff4d4f;
           }

           .fund-data {
               text-align: right;
           }

           .fund-change {
               font-size: 18px;
               font-weight: 600;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
           }

           /* 红涨绿跌 */
           .fund-up {
               color: #ff3b30;
           }

           .fund-down {
               color: #4cd964;
           }

           .fund-flat {
               color: #999;
           }

           .fund-nav {
               font-size: 12px;
               color: #999;
               margin-top: 2px;
           }

           /* 黑金模式适配 */
           #alipay-screen.theme-blackgold .alipay-grid-menu .alipay-menu-item {
               background-color: #1c1c1e;
               color: #e0e0e0;
               box-shadow: none;
               border: 1px solid #333;
           }

           #alipay-screen.theme-blackgold #fund-market-trend-preview {
               color: #d4af37 !important;
           }

           /* --- 支付宝布局修复：确保账单不被挤压 --- */
           #alipay-screen {
               display: flex;
               flex-direction: column;
               height: 100%;
               /* 强制占满屏幕 */
               overflow: hidden;
               /* 禁止整个屏幕滚动，只让内部区域滚动 */
           }

           /* 头部区域 (包含蓝色背景、余额、亲属卡、基金入口) */
           .alipay-header-area {
               flex-shrink: 0;
               /* 禁止头部被压缩 */
               background-color: var(--alipay-primary);
               /* 注意：这里去掉了 padding-bottom，由内容撑开 */
               padding-bottom: 20px;
               transition: background-color 0.5s;
           }

           /* 卡片容器 */
           .alipay-card-container {
               margin-top: 0;
               /* 调整间距 */
               padding: 0 15px;
           }

           /* --- 基金入口样式优化 (更紧凑) --- */
           .alipay-grid-menu {
               padding: 0 15px;
               margin-top: 10px;
               /* 与上方卡片保持距离 */
               margin-bottom: 10px;
               /* 与下方账单保持距离 */
           }

           .alipay-menu-item {
               background: white;
               padding: 12px 15px;
               /* 减小内边距，更扁平 */
               border-radius: 12px;
               display: flex;
               align-items: center;
               gap: 12px;
               box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03);
               cursor: pointer;
               transition: all 0.3s;
               border: 1px solid transparent;
               /* 预留边框位 */
           }

           .alipay-menu-item:active {
               transform: scale(0.98);
           }

           .menu-icon {
               width: 36px;
               height: 36px;
               background: #FFF5E5;
               border-radius: 8px;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 20px;
           }

           .menu-info {
               flex-grow: 1;
           }

           .menu-title {
               font-weight: 600;
               font-size: 15px;
               color: #333;
           }

           .menu-trend {
               font-size: 11px;
               color: #ff3b30;
               margin-top: 2px;
           }

           .menu-arrow {
               color: #ccc;
               font-size: 18px;
               font-weight: 300;
           }

           /* --- 账单容器自适应 (关键！) --- */
           .alipay-bill-container {
               flex-grow: 1;
               /* 占据剩余所有空间 */
               min-height: 0;
               /* 允许 Flex 子元素收缩，防止溢出 */
               margin-top: 0;
               /* 紧贴上方 */
               background-color: var(--alipay-bill-bg);
               border-radius: 20px 20px 0 0;
               padding: 0;
               /* 内部元素处理 padding */
               display: flex;
               flex-direction: column;
               overflow: hidden;
               /* 容器本身不滚 */
               box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.05);
               /* 增加顶部阴影，产生层次感 */
           }

           /* 账单列表滚动区域 */
           #bill-scroll-list {
               flex-grow: 1;
               overflow-y: auto;
               /* 只有这里滚动 */
               padding: 0 15px 20px 15px;
               -webkit-overflow-scrolling: touch;
           }


           /* --- 支付宝布局修复：确保账单不被挤压 --- */
           #alipay-screen {
               display: flex;
               flex-direction: column;
               height: 100%;
               /* 强制占满屏幕 */
               overflow: hidden;
               /* 禁止整个屏幕滚动，只让内部区域滚动 */
           }

           /* 头部区域 (包含蓝色背景、余额、亲属卡、基金入口) */
           .alipay-header-area {
               flex-shrink: 0;
               /* 禁止头部被压缩 */
               background-color: var(--alipay-primary);
               /* 注意：这里去掉了 padding-bottom，由内容撑开 */
               padding-bottom: 20px;
               transition: background-color 0.5s;
           }

           /* 卡片容器 */
           .alipay-card-container {
               margin-top: 0;
               /* 调整间距 */
               padding: 0 15px;
           }

           /* --- 基金入口样式优化 (更紧凑) --- */
           .alipay-grid-menu {
               padding: 0 15px;
               margin-top: 10px;
               /* 与上方卡片保持距离 */
               margin-bottom: 10px;
               /* 与下方账单保持距离 */
           }

           .alipay-menu-item {
               background: white;
               padding: 12px 15px;
               /* 减小内边距，更扁平 */
               border-radius: 12px;
               display: flex;
               align-items: center;
               gap: 12px;
               box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03);
               cursor: pointer;
               transition: all 0.3s;
               border: 1px solid transparent;
               /* 预留边框位 */
           }

           .alipay-menu-item:active {
               transform: scale(0.98);
           }

           .menu-icon {
               width: 36px;
               height: 36px;
               background: #FFF5E5;
               border-radius: 8px;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 20px;
           }

           .menu-info {
               flex-grow: 1;
           }

           .menu-title {
               font-weight: 600;
               font-size: 15px;
               color: #333;
           }

           .menu-trend {
               font-size: 11px;
               color: #ff3b30;
               margin-top: 2px;
           }

           .menu-arrow {
               color: #ccc;
               font-size: 18px;
               font-weight: 300;
           }

           /* --- 账单容器自适应 (关键！) --- */
           .alipay-bill-container {
               flex-grow: 1;
               /* 占据剩余所有空间 */
               min-height: 0;
               /* 允许 Flex 子元素收缩，防止溢出 */
               margin-top: 0;
               /* 紧贴上方 */
               background-color: var(--alipay-bill-bg);
               border-radius: 20px 20px 0 0;
               padding: 0;
               /* 内部元素处理 padding */
               display: flex;
               flex-direction: column;
               overflow: hidden;
               /* 容器本身不滚 */
               box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.05);
               /* 增加顶部阴影，产生层次感 */
           }

           /* 账单列表滚动区域 */
           #bill-scroll-list {
               flex-grow: 1;
               overflow-y: auto;
               /* 只有这里滚动 */
               padding: 0 15px 20px 15px;
               -webkit-overflow-scrolling: touch;
           }



           /* 1. 基金入口黑金化 */
           #alipay-screen.theme-blackgold .alipay-menu-item {
               background-color: #1c1c1e;
               /* 深色背景 */
               border: 1px solid #333;
               /* 微弱边框 */
               box-shadow: none;
           }

           #alipay-screen.theme-blackgold .menu-icon {
               background-color: #2c2c2e;
               /* 图标背景变深 */
               border: 1px solid #444;
           }

           #alipay-screen.theme-blackgold .menu-title {
               color: #e0e0e0;
               /* 标题变白/灰 */
           }

           #alipay-screen.theme-blackgold .menu-trend {
               color: #d4af37 !important;
               /* 涨跌幅变金色 */
           }

           #alipay-screen.theme-blackgold .menu-arrow {
               color: #666;
           }

           /* 2. 账单区域黑金化完善 */
           #alipay-screen.theme-blackgold .alipay-bill-container {
               background-color: #000000;
               /* 账单背景全黑 */
               border-top: 1px solid #222;
           }

           #alipay-screen.theme-blackgold #bill-scroll-list {
               background-color: #000000;
           }

           /* --- 基金页面主题适配 --- */

           /* 1. 默认蓝色主题 */
           .fund-header-area {
               background-color: #1677ff;
               color: white;
               border-bottom: none;
           }

           .fund-asset-card {
               background-color: #1677ff;
               color: white;
               padding: 10px 20px 40px 20px;
               /* 增加底部内边距 */
               margin-bottom: -20px;
               /* 让下方列表上浮覆盖 */
               transition: background-color 0.5s;
           }

           /* 2. 黑金模式适配 (当 fund-screen 拥有 .theme-blackgold 类时) */
           #fund-screen.theme-blackgold {
               background-color: #121212 !important;
           }

           #fund-screen.theme-blackgold .fund-header-area {
               background-color: #1a1a1a;
               /* 头部变深黑 */
               color: #d4af37;
               /* 金色文字 */
           }

           #fund-screen.theme-blackgold .fund-asset-card {
               background: linear-gradient(180deg, #1a1a1a 0%, #000000 100%);
               /* 黑金渐变 */
               color: #d4af37;
           }

           #fund-screen.theme-blackgold .list-container {
               background-color: #121212 !important;
               /* 列表背景变黑 */
           }

           #fund-screen.theme-blackgold .frame-tabs {
               background-color: #1c1c1e !important;
               box-shadow: none;
               border: 1px solid #333;
           }

           #fund-screen.theme-blackgold .frame-tab {
               color: #888;
           }

           #fund-screen.theme-blackgold .frame-tab.active {
               background-color: #333 !important;
               color: #d4af37 !important;
           }

           #fund-screen.theme-blackgold .fund-item {
               background-color: #1c1c1e;
               border: 1px solid #2c2c2e;
               color: #e0e0e0;
           }

           #fund-screen.theme-blackgold .fund-info h4 {
               color: #e0e0e0;
           }

           /* --- 亲属卡标题适配 --- */
           .kinship-section-title {
               color: #333;
               /* 默认模式：深灰色 */
               transition: color 0.3s;
           }

           /* 黑金模式下，标题变金 */
           #alipay-screen.theme-blackgold .kinship-section-title {
               color: #d4af37 !important;
           }

           /* 黑金模式下，添加按钮也变金 */
           #alipay-screen.theme-blackgold #add-kinship-btn {
               color: #d4af37 !important;
           }


           /* ============================================================ */
           /* ▼▼▼ 终极修复：消息长按菜单 (还原九宫格 + 自动填满) ▼▼▼ */
           /* ============================================================ */

           /* 1. 容器布局：横向排列，允许换行，按钮之间有间隙 */
           #message-actions-modal .custom-modal-footer {
               display: flex !important;
               flex-direction: row !important;
               /* 强制横向 */
               flex-wrap: wrap !important;
               /* 允许换行 */
               justify-content: space-between !important;
               padding: 10px !important;
               gap: 10px !important;
               /* 按钮间距 */
               background-color: transparent !important;
               max-height: none !important;
               overflow: visible !important;
           }

           /* 2. 功能按钮：灰色方块，自动填满 */
           #message-actions-modal .custom-modal-footer button:not(#cancel-message-action-btn) {
               /* 基础宽度：约一半减去间隙 */
               width: 48% !important;
               /* 【关键修复】：允许按钮自动拉伸！这样如果是奇数个，最后一个会自动占满一行 */
               flex-grow: 1 !important;

               /* 【关键修复】：移除 display: ... !important，让 JS 的隐藏逻辑生效 */
               display: flex;
               align-items: center;
               justify-content: center;

               margin: 0 !important;
               padding: 15px 0 !important;
               /* 保持高度 */

               /* 外观：浅灰色圆角 */
               background-color: #f2f2f7 !important;
               color: #007aff !important;
               border-radius: 10px !important;
               border: none !important;
               font-size: 16px !important;
               font-weight: 500 !important;

               /* 清除干扰 */
               border-bottom: none !important;
           }

           /* 3. 强制隐藏被 JS 设置为隐藏的按钮 (解决单聊显示群聊按钮的问题) */
           #message-actions-modal .custom-modal-footer button[style*="display: none"] {
               display: none !important;
           }

           /* 4. 取消按钮：样式完全统一（灰色背景、正常字体） */
           #message-actions-modal #cancel-message-action-btn {
               width: 100% !important;
               flex-grow: 0 !important;
               margin-top: 5px !important;
               padding: 15px 0 !important;

               /* 【修改】背景色改为和其他按钮一样的浅灰 */
               background-color: #f2f2f7 !important;

               color: #007aff !important;

               /* 【修改】字体粗细改为正常，不再加粗 */
               font-weight: 500 !important;

               border-radius: 10px !important;
               border: none !important;
               box-shadow: none !important;
               /* 去掉阴影 */
           }

           /* 5. 黑金/夜间模式适配 */
           #phone-screen.dark-mode #message-actions-modal .custom-modal-footer button:not(#cancel-message-action-btn),
           #phone-screen.dark-mode #message-actions-modal #cancel-message-action-btn {
               background-color: #2c2c2e !important;
               /* 统一深灰块 */
               color: #0a84ff !important;
           }

           /* ========================================= */
           /* ▼▼▼ 支付宝 UI 美化版 (Modern Fintech) ▼▼▼ */
           /* ========================================= */

           /* 1. 屏幕整体容器 */
           #alipay-screen {
               /* 定义变量：默认财富蓝主题 */
               --alipay-header-bg: linear-gradient(180deg, #1677ff 0%, #0a5ad3 100%);
               --alipay-bg-color: #f5f7fa;
               /* 更柔和的浅灰底色 */
               --alipay-card-bg: #ffffff;
               --alipay-text-primary: #1f1f1f;
               --alipay-text-secondary: #8a8a8a;
               --alipay-money-font: -apple-system, BlinkMacSystemFont, "DIN Alternate", "Roboto", sans-serif;

               background-color: var(--alipay-bg-color);
               display: flex;
               flex-direction: column;
               height: 100%;
               overflow: hidden;
           }

           /* 2. 头部区域 (包含导航栏和蓝色背景层) */
           .alipay-header-area {
               background: var(--alipay-header-bg);
               color: white;
               padding-top: calc(10px + env(safe-area-inset-top));
               padding-bottom: 60px;
               /* 留出空间给卡片上浮 */
               border-radius: 0 0 20px 20px;
               /* 底部微圆角 */
               flex-shrink: 0;
               position: relative;
               z-index: 1;
           }

           /* 导航栏 */
           .alipay-nav {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 0 15px;
               height: 44px;
               font-size: 17px;
               font-weight: 500;
           }

           .alipay-nav .back-btn {
               font-size: 24px;
               font-weight: 300;
               cursor: pointer;
               width: 30px;
               opacity: 0.9;
           }

           .alipay-action {
               font-size: 15px;
               opacity: 0.9;
               cursor: pointer;
               padding: 4px 10px;
               background: rgba(255, 255, 255, 0.15);
               border-radius: 15px;
               backdrop-filter: blur(5px);
               transition: background 0.2s;
           }

           .alipay-action:active {
               background: rgba(255, 255, 255, 0.3);
           }

           /* 3. 卡片容器 (负责上浮布局) */
           .alipay-card-container {
               flex-grow: 1;
               overflow-y: auto;
               /* 让卡片和下方内容整体滚动 */
               padding: 0 12px;
               margin-top: -50px;
               /* 核心：卡片上浮覆盖蓝色背景 */
               position: relative;
               z-index: 2;
               /* 隐藏滚动条 */
               -webkit-overflow-scrolling: touch;
           }

           .alipay-card-container::-webkit-scrollbar {
               display: none;
           }

           /* 4. 总资产卡片 (深色质感卡片) */
           .alipay-balance-card {
               background: linear-gradient(180deg, #1677ff 0%, #0a5ad3 100%);
               color: #fff;
               border-radius: 16px;
               padding: 20px;
               box-shadow: 0 8px 20px rgba(22, 119, 255, 0.2);
               position: relative;
               overflow: hidden;
               margin-bottom: 12px;
           }

           /* 卡片内部装饰光纹 */
           .alipay-balance-card::after {
               content: '';
               position: absolute;
               top: -50%;
               right: -50%;
               width: 200px;
               height: 200px;
               background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
               pointer-events: none;
           }

           .balance-label {
               font-size: 13px;
               opacity: 0.7;
               margin-bottom: 4px;
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           .balance-amount {
               font-family: var(--alipay-money-font);
               font-size: 38px;
               font-weight: 700;
               letter-spacing: 0.5px;
               text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
           }

           .balance-status-tag {
               font-size: 11px;
               padding: 2px 8px;
               background: rgba(255, 255, 255, 0.15);
               border: 1px solid rgba(255, 255, 255, 0.2);
               border-radius: 4px;
               color: rgba(255, 255, 255, 0.9);
               backdrop-filter: blur(4px);
           }

           /* 5. 功能菜单网格 (Funds, etc.) */
           .alipay-grid-menu {
               display: grid;
               grid-template-columns: 1fr;
               /* 保持单行，也可以改成 1fr 1fr */
               gap: 10px;
               margin-bottom: 12px;
           }

           .alipay-menu-item {
               background: var(--alipay-card-bg);
               padding: 16px;
               border-radius: 12px;
               display: flex;
               align-items: center;
               gap: 12px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
               cursor: pointer;
               transition: transform 0.1s;
           }

           .alipay-menu-item:active {
               transform: scale(0.98);
           }

           .menu-icon {
               width: 40px;
               height: 40px;
               border-radius: 10px;
               background: #eff4ff;
               /* 浅蓝底 */
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 20px;
           }

           .menu-info {
               flex-grow: 1;
           }

           .menu-title {
               font-size: 15px;
               font-weight: 600;
               color: var(--alipay-text-primary);
               margin-bottom: 2px;
           }

           .menu-trend {
               font-size: 12px;
               color: #ff3b30;
               /* 红涨 */
               font-family: var(--alipay-money-font);
               font-weight: 500;
           }

           .menu-arrow {
               color: #ccc;
               font-size: 16px;
           }

           /* 6. 亲属卡区域 */
           #alipay-kinship-section-wrapper {
               margin-bottom: 15px;
           }

           .kinship-section-title {
               font-size: 15px;
               font-weight: 600;
               color: var(--alipay-text-primary);
               margin-left: 5px;
           }

           /* 亲属卡容器 */
           #alipay-kinship-section {
               display: flex;
               overflow-x: auto;
               gap: 10px;
               padding: 10px 5px 15px 5px;
               /* 留出阴影空间 */
               -webkit-overflow-scrolling: touch;
               scrollbar-width: none;
           }

           #alipay-kinship-section::-webkit-scrollbar {
               display: none;
           }

           /* 亲属卡单卡 */
           .kinship-card-entry {
               flex-shrink: 0;
               width: 85%;
               /* 稍微露出下一张 */
               max-width: 300px;
               background: linear-gradient(135deg, #ff5252, #e00f38);
               border-radius: 12px;
               padding: 16px;
               color: white;
               position: relative;
               box-shadow: 0 4px 12px rgba(255, 82, 82, 0.3);
               overflow: hidden;
           }

           .kinship-top {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-bottom: 25px;
           }

           .kinship-provider {
               display: flex;
               align-items: center;
               gap: 8px;
               font-size: 14px;
               font-weight: 500;
               background: rgba(0, 0, 0, 0.1);
               padding: 4px 10px 4px 4px;
               border-radius: 20px;
           }

           .kinship-provider img {
               width: 24px;
               height: 24px;
               border-radius: 50%;
               border: 1px solid rgba(255, 255, 255, 0.6);
           }

           .kinship-limit {
               font-family: var(--alipay-money-font);
               font-size: 26px;
               font-weight: 700;
           }

           .kinship-label {
               font-size: 11px;
               opacity: 0.8;
               margin-bottom: 2px;
           }

           /* 7. 账单区域 */
           .alipay-bill-container {
               background-color: var(--alipay-card-bg);
               border-radius: 16px;
               padding: 0;
               overflow: hidden;
               /* 内部滚动 */
               box-shadow: 0 2px 15px rgba(0, 0, 0, 0.04);
               margin-bottom: 20px;
               /* 底部留白 */
               min-height: 300px;
           }

           /* 账单筛选头 */
           .bill-filter-header {
               padding: 15px;
               background: var(--alipay-card-bg);
               border-bottom: 1px solid #f0f0f0;
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           /* 账单列表 */
           #bill-scroll-list {
               max-height: 500px;
               /* 给个最大高度，防止撑破页面 */
               overflow-y: auto;
           }

           .bill-month-separator {
               background-color: #f9f9f9;
               padding: 8px 15px;
               font-size: 12px;
               color: #999;
               font-weight: 500;
               position: sticky;
               top: 0;
           }

           .bill-item {
               padding: 16px 15px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               border-bottom: 1px solid #f7f7f7;
           }

           .bill-item:last-child {
               border-bottom: none;
           }

           .bill-info {
               display: flex;
               flex-direction: column;
               gap: 4px;
           }

           .bill-title {
               font-size: 15px;
               color: var(--alipay-text-primary);
               font-weight: 500;
           }

           .bill-time {
               font-size: 12px;
               color: #ccc;
           }

           .bill-amount {
               font-family: var(--alipay-money-font);
               font-size: 17px;
               font-weight: 600;
           }

           .bill-amount.income {
               color: #ff3b30;
           }

           .bill-amount.expense {
               color: var(--alipay-text-primary);
           }


           /* 8. 黑金主题适配 (Black Gold Theme) */
           #alipay-screen.theme-blackgold {
               --alipay-header-bg: #1a1a1a;
               /* 纯黑头部 */
               --alipay-bg-color: #121212;
               --alipay-card-bg: #1c1c1e;
               --alipay-text-primary: #e5e5e5;
               --alipay-text-secondary: #888;
           }

           #alipay-screen.theme-blackgold .alipay-balance-card {
               background: linear-gradient(135deg, #2a2a2a, #000);
               border: 1px solid #333;
               color: #d4af37;
               /* 金色 */
               box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
           }

           #alipay-screen.theme-blackgold .balance-label,
           #alipay-screen.theme-blackgold .balance-status-tag {
               color: rgba(212, 175, 55, 0.8);
               border-color: rgba(212, 175, 55, 0.3);
           }

           #alipay-screen.theme-blackgold .menu-icon {
               background: #2c2c2e;
               color: #d4af37;
           }

           #alipay-screen.theme-blackgold .menu-trend {
               color: #d4af37;
               /* 也是金色 */
           }

           #alipay-screen.theme-blackgold .bill-filter-header {
               border-bottom-color: #333;
           }

           #alipay-screen.theme-blackgold .bill-month-separator {
               background-color: #121212;
               color: #666;
           }

           #alipay-screen.theme-blackgold .bill-item {
               border-bottom-color: #333;
           }

           #alipay-screen.theme-blackgold .bill-amount.expense {
               color: #fff;
           }

           #alipay-screen.theme-blackgold .bill-amount.income {
               color: #d4af37;
           }

           #alipay-screen.theme-blackgold .kinship-section-title {
               color: #d4af37;
           }

           #alipay-screen.theme-blackgold #add-kinship-btn {
               color: #d4af37 !important;
           }

           /* ========================================= */
           /* ▼▼▼ 赛博黑市拍卖行 2.0 (UI 重构) ▼▼▼ */
           /* ========================================= */

           /* 1. 全屏背景：深邃的网格背景 */
           #auction-screen {
               background-color: #050505 !important;
               background-image:
                   linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px),
                   linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
               background-size: 30px 30px;
               color: #e0e0e0;
               font-family: 'Courier New', Courier, monospace;
               /* 终端字体感 */
           }

           /* 2. 头部：霓虹边框 */
           #auction-screen .header {
               background-color: rgba(20, 20, 20, 0.9) !important;
               border-bottom: 1px solid #333;
               box-shadow: 0 0 15px rgba(0, 255, 242, 0.1);
           }

           #auction-screen .header span {
               color: #00f3ff !important;
               text-shadow: 0 0 5px rgba(0, 243, 255, 0.5);
               font-weight: 800;
               letter-spacing: 1px;
           }

           /* 3. 拍品展示区：全息投影感 */
           #auction-main-display {
               height: auto !important;
               flex-grow: 1;
               display: flex;
               flex-direction: column;
               justify-content: center;
               background: radial-gradient(circle at center, #1a1a2e 0%, #000000 80%);
           }

           #auction-item-image-container {
               border: 2px solid #00f3ff !important;
               box-shadow: 0 0 20px rgba(0, 243, 255, 0.2), inset 0 0 20px rgba(0, 243, 255, 0.1) !important;
               border-radius: 4px !important;
               /* 硬朗的角 */
               position: relative;
           }

           /* 扫描线动画 */
           #auction-item-image-container::after {
               content: '';
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background: linear-gradient(to bottom, transparent 50%, rgba(0, 255, 255, 0.1) 51%, transparent 52%);
               background-size: 100% 10px;
               animation: scanline 5s linear infinite;
               pointer-events: none;
           }

           @keyframes scanline {
               0% {
                   background-position: 0 0;
               }

               100% {
                   background-position: 0 100%;
               }
           }

           #auction-item-name {
               font-family: -apple-system, sans-serif;
               font-weight: 900;
               font-size: 24px !important;
               color: #fff !important;
               text-shadow: 2px 2px 0px #ff0055;
               /* 故障风阴影 */
               margin-top: 15px !important;
           }

           #auction-item-desc {
               color: #00f3ff !important;
               opacity: 0.8;
               border: 1px dashed #00f3ff;
               padding: 8px;
               background: rgba(0, 243, 255, 0.05);
               margin-top: 10px !important;
               max-width: 90%;
           }

           /* 4. 竞价面板：控制台风格 */
           #auction-screen>div:last-child {
               /* 指向底部的白色面板 */
               background-color: #111 !important;
               border-top: 2px solid #ff0055;
               /* 撞色边框 */
               border-radius: 0 !important;
               /* 方正 */
               box-shadow: 0 -5px 30px rgba(255, 0, 85, 0.15) !important;
           }

           /* 当前价格大字 */
           #auction-current-price {
               color: #ff0055 !important;
               text-shadow: 0 0 10px rgba(255, 0, 85, 0.5);
               font-family: 'DIN Alternate', sans-serif;
               /* 数字字体 */
           }

           /* 倒计时 */
           #auction-timer {
               color: #f0ad4e !important;
               /* 警告黄 */
               font-family: monospace;
           }

           /* 5. 滚动日志：终端数据流 */
           #auction-log {
               background: #000;
               border: 1px solid #333;
               font-family: monospace;
               padding: 5px;
               margin-bottom: 15px;
           }

           #auction-log div {
               border-bottom: none !important;
               padding: 2px 5px !important;
               font-size: 12px;
           }

           #auction-log .bid-me {
               color: #00ff00 !important;
               text-shadow: 0 0 5px #00ff00;
           }

           /* 我出价绿色高亮 */
           #auction-log .bid-friend {
               color: #00f3ff !important;
           }

           #auction-log .bid-npc {
               color: #666 !important;
           }

           /* 6. 按钮组：机械感 */
           #auction-controls {
               gap: 8px !important;
           }

           #auction-controls button {
               border-radius: 2px !important;
               /* 方形按钮 */
               text-transform: uppercase;
               font-weight: 800 !important;
               letter-spacing: 1px;
               transition: all 0.1s;
           }

           /* 加价按钮 */
           #auction-controls .form-button-secondary {
               background: #222 !important;
               border: 1px solid #444 !important;
               color: #ccc !important;
           }

           #auction-controls .form-button-secondary:active {
               background: #fff !important;
               color: #000 !important;
           }

           /* 核心出价按钮 */
           #auction-controls .form-button {
               background: #ff0055 !important;
               /* 霓虹红 */
               color: #fff !important;
               box-shadow: 0 0 15px rgba(255, 0, 85, 0.4);
               border: none !important;
           }

           #auction-controls .form-button:active {
               transform: scale(0.95);
               box-shadow: 0 0 5px rgba(255, 0, 85, 0.8);
           }

           #auction-log .bid-friend {
               color: #ff00ff !important;
               /* 亮粉色 */
               font-weight: 900 !important;
               font-size: 14px !important;
               border-left: 3px solid #ff00ff;
               /* 左侧加个粉条 */
               padding-left: 8px !important;
               background: rgba(255, 0, 255, 0.1);
               /* 微弱背景 */
               text-shadow: 0 0 5px #ff00ff;
               /* 霓虹光晕 */
           }

           /* 1. 头部：不再根据手机刘海自动变高，强制固定 */
           .alipay-header-area {
               /* 核心：直接写死数字，不使用 env() 变量 */
               padding-top: 25px !important;

               /* 保持下方留白给卡片上浮 */
               padding-bottom: 50px !important;

               /* 清除所有负边距干扰，回归标准位置 */
               margin-top: 0 !important;
           }

           /* 2. 导航栏：微调位置，确保文字垂直居中 */
           .alipay-nav {
               /* 不需要负边距了，因为头部 padding 已经固定 */
               transform: none !important;
               padding-top: 5px !important;
           }

           /* 3. 卡片容器：标准的上浮距离 */
           .alipay-card-container {
               /* 让卡片往上盖住蓝色背景 40px */
               margin-top: -40px !important;
               position: relative;
               z-index: 5;
           }

           /* 4. 账单列表：根据你的喜好，紧贴亲属卡 */
           .alipay-bill-container {
               /* 这里保留你之前喜欢的紧凑感 */
               margin-top: -50px !important;

               /* 核心：去掉手机底部的安全区留白，强制统一 */
               padding-bottom: 20px !important;
               margin-bottom: 0 !important;
               border-radius: 16px 16px 0 0 !important;
           }

           /* 5. 修正亲属卡的高度防止被压扁 */
           #alipay-kinship-section {
               margin-bottom: 0 !important;
               padding-bottom: 10px !important;
               min-height: auto !important;
           }

           /* 1. 强制背景透明，去掉阴影 */
           .icon-bg-desktop.transparent-mode {
               background-color: transparent !important;
               box-shadow: none !important;
               border: none !important;
           }

           /* 2. 让内部图片撑满，并不强制圆角（保持PNG原形） */
           .icon-bg-desktop.transparent-mode img {
               width: 100% !important;
               height: 100% !important;
               border-radius: 0 !important;
               /* 不切圆角，保持图片原样 */
               object-fit: contain !important;
               /* 保持比例，不拉伸 */
               transform: scale(1.1);
               /*稍微放大一点点视觉补偿，因为没有背景框了 */
           }

           /* --- 页面布局调整 --- */

           /* 1. 定义右侧列的堆叠方式 (垂直排列) */
           .right-column-stack {
               display: flex;
               flex-direction: column;
               gap: 15px;
               /* 上下组件的间距 */
               min-width: 0;
               /* 防止被挤压 */
           }

           /* --- 黑胶唱片机组件样式 --- */

           /* 2. 组件卡片外框 */
           .vinyl-widget-card {
               width: 155px !important;
               /* 强制固定宽度，和左侧大组件一致 */
               height: 155px !important;
               /* 强制固定高度，保持正方形 */
               background-color: white;
               border-radius: 20px;
               padding: 15px;
               box-sizing: border-box;
               display: flex;
               flex-direction: column;
               position: relative;
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
               flex-shrink: 0;
               /* 防止被挤压 */
           }

           /* 3. 顶部开关装饰 */
           .vinyl-header {
               height: 20px;
               display: flex;
               align-items: center;
           }

           .vinyl-switch {
               width: 46px;
               height: 20px;
               position: relative;
           }

           .switch-track {
               background-color: #f0f0f0;
               border-radius: 10px;
               width: 100%;
               height: 100%;
               font-size: 10px;
               color: #ccc;
               display: flex;
               align-items: center;
               justify-content: flex-end;
               padding-right: 6px;
               box-sizing: border-box;
               font-weight: bold;
               box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
           }

           .switch-circle {
               width: 16px;
               height: 16px;
               background-color: white;
               border-radius: 50%;
               position: absolute;
               top: 2px;
               left: 2px;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
           }

           /* 4. 中间部分布局 */
           .vinyl-body {
               flex-grow: 1;
               position: relative;
               display: flex;
               justify-content: center;
               align-items: center;
           }

           /* 5. 黑胶唱片纹理 */
           .vinyl-disc-bg {
               width: 100px;
               /* 唱片大小 */
               height: 100px;
               border-radius: 50%;
               background: repeating-radial-gradient(#111 0,
                       #111 2px,
                       #222 3px,
                       #222 4px);
               box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
               display: flex;
               justify-content: center;
               align-items: center;
               position: relative;
               z-index: 1;
               border: 4px solid #f5f5f5;
               /* 白色外圈 */
           }

           /* 6. 中间可换图片 (圆形封面) */
           .vinyl-cover {
               width: 55px;
               height: 55px;
               border-radius: 50%;
               object-fit: cover;
               border: 2px solid #111;
               cursor: pointer;
               transition: opacity 0.2s;
           }

           .vinyl-cover:active {
               opacity: 0.7;
           }

           /* 7. 唱针装饰 */
           .vinyl-arm-wrapper {
               position: absolute;
               right: -10px;
               top: -10px;
               width: 50px;
               height: 120px;
               z-index: 2;
               pointer-events: none;
               filter: drop-shadow(2px 4px 4px rgba(0, 0, 0, 0.1));
               transform: rotate(0deg);
               /* 可调整角度 */
           }

           /* 8. 底部文字 */
           .vinyl-footer {
               text-align: center;
               font-size: 12px;
               color: #666;
               font-weight: 500;
               margin-top: 5px;
           }

           /* --- 适配暗黑模式 --- */
           #phone-screen.dark-mode .vinyl-widget-card {
               background-color: #2c2c2e;
           }

           #phone-screen.dark-mode .vinyl-disc-bg {
               border-color: #3a3a3c;
           }

           #phone-screen.dark-mode .vinyl-footer {
               color: #aaa;
           }

           #phone-screen.dark-mode .switch-track {
               background-color: #3a3a3c;
               color: #666;
           }


           /* --- 透明黑胶唱片机样式 --- */

           /* 1. 透明容器：去掉白色背景和阴影，只做定位 */
           .vinyl-transparent-widget {
               width: 155px !important;
               /* 保持和其他组件一样大 */
               height: 155px !important;
               position: relative;
               display: flex;
               justify-content: center;
               align-items: center;
               /* 关键：背景透明，无边框，无阴影 */
               background-color: transparent !important;
               border: none !important;
               box-shadow: none !important;
               flex-shrink: 0;
           }

           /* 2. 黑胶唱片纹理 */
           .vinyl-disc-bg {
               width: 135px;
               /* 稍微调大一点 */
               height: 135px;
               border-radius: 50%;
               background: repeating-radial-gradient(#111 0,
                       #111 2px,
                       #222 3px,
                       #222 4px);
               /* 加强阴影，让它有浮起来的感觉 */
               box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
               display: flex;
               justify-content: center;
               align-items: center;
               position: relative;
               z-index: 1;
               border: 3px solid #f5f5f5;
           }

           /* 3. 中间可换图片 */
           .vinyl-cover {
               width: 75px;
               height: 75px;
               border-radius: 50%;
               object-fit: cover;
               border: 2px solid #111;
               cursor: pointer;
               transition: opacity 0.2s;
           }

           .vinyl-cover:active {
               opacity: 0.7;
           }

           /* 4. 唱针装饰 (调整位置以适应无边框) */
           .vinyl-arm-wrapper {
               position: absolute;
               right: 0px;
               top: 0px;
               width: 50px;
               height: 120px;
               z-index: 2;
               pointer-events: none;
               filter: drop-shadow(3px 6px 8px rgba(0, 0, 0, 0.3));
               /* 加强阴影 */
           }

           /* --- 移除原来的暗黑模式适配 (因为现在是透明的了) --- */
           /* 只保留唱片外圈颜色的适配 */
           #phone-screen.dark-mode .vinyl-disc-bg {
               border-color: #3a3a3c;
           }

           .left-column-stack {
               display: flex;
               flex-direction: column;
               gap: 30px;
               /* <--- 把这里的 15px 改大，比如 30px */
           }

           /* --- 1. 右侧列容器布局 --- */
           .right-column-stack {
               display: flex;
               flex-direction: column;
               gap: 30px;
               /* 上下间距 */
               min-width: 0;

               /* 【关键】让内部元素靠右对齐 (贴近屏幕右侧) */
               /* 如果您喜欢靠左贴着中间缝隙，改成 flex-start */
               align-items: flex-end;
           }

           /* --- 2. 右侧 4个APP 的网格布局 --- */
           .app-subgrid {
               display: grid;
               grid-template-columns: repeat(2, 1fr);
               gap: 15px;
               /* 图标间距 */

               /* 【关键】强制固定宽度，与左侧大组件/唱片机一致 */
               width: 155px !important;

               /* 让图标在格子里居中 */
               justify-items: center;
           }

           /* --- 3. 再次确保透明唱片机也是固定大小 --- */
           .vinyl-transparent-widget {
               width: 155px !important;
               height: 155px !important;
               /* ...其他样式保持不变... */
           }

           /* 合成音乐卡片样式 */
           .message-bubble.is-music-synth .content {
               padding: 0 !important;
               background: transparent !important;
           }

           .synth-music-card {
               background: linear-gradient(135deg, #fff1eb 0%, #ace0f9 100%);
               /* 清新的渐变色 */
               border-radius: 12px;
               padding: 12px 15px;
               display: flex;
               align-items: center;
               gap: 12px;
               width: 220px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
               border: 1px solid rgba(255, 255, 255, 0.5);
           }

           #phone-screen.dark-mode .synth-music-card {
               background: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);
               border-color: #444;
           }

           .synth-icon {
               font-size: 24px;
               filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.1));
           }

           .synth-info {
               flex-grow: 1;
               overflow: hidden;
           }

           .synth-title {
               font-weight: 600;
               font-size: 15px;
               color: #333;
               margin-bottom: 2px;
           }

           #phone-screen.dark-mode .synth-title {
               color: #fff;
           }

           .synth-reason {
               font-size: 12px;
               color: #666;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           #phone-screen.dark-mode .synth-reason {
               color: #ddd;
           }

           .synth-play-btn {
               width: 36px;
               height: 36px;
               border-radius: 50%;
               border: none;
               background-color: rgba(255, 255, 255, 0.6);
               color: #007bff;
               font-size: 14px;
               display: flex;
               align-items: center;
               justify-content: center;
               cursor: pointer;
               transition: all 0.2s;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
           }

           .synth-play-btn:active {
               transform: scale(0.9);
           }

           .synth-play-btn.playing {
               background-color: #007bff;
               color: white;
               animation: pulse-play 1s infinite;
           }

           @keyframes pulse-play {
               0% {
                   box-shadow: 0 0 0 0 rgba(0, 123, 255, 0.7);
               }

               70% {
                   box-shadow: 0 0 0 6px rgba(0, 123, 255, 0);
               }

               100% {
                   box-shadow: 0 0 0 0 rgba(0, 123, 255, 0);
               }
           }

           /* --- 修复黑市头部布局错误 --- */

           /* 1. 解除按钮宽度限制，让文字横向显示 */
           #auction-screen .header .action-btn {
               width: auto !important;
               /* 取消固定30px */
               min-width: 30px;
               padding: 4px 12px !important;
               /* 增加内边距 */
               font-size: 14px !important;
               white-space: nowrap;
               /* 强制不换行 */
           }

           /* 2. 确保右上角按钮组横向排列 */
           #auction-screen .header .header-actions {
               display: flex;
               align-items: center;
               gap: 8px;
               position: relative;
               z-index: 20;
               /* 确保在最上层，可点击 */
           }

           /* 3. 仓库弹窗的样式 */
           .inventory-item {
               display: flex;
               gap: 12px;
               background-color: #252525;
               padding: 12px;
               border-radius: 8px;
               margin-bottom: 12px;
               border: 1px solid #333;
               position: relative;
           }

           .inventory-img {
               width: 70px;
               height: 70px;
               object-fit: cover;
               border-radius: 6px;
               border: 1px solid #444;
               background-color: #000;
           }

           .inventory-info {
               flex: 1;
               display: flex;
               flex-direction: column;
               justify-content: center;
           }

           .inventory-name {
               font-size: 16px;
               font-weight: bold;
               color: #d4af37;
               margin-bottom: 4px;
           }

           .inventory-desc {
               font-size: 12px;
               color: #999;
               display: -webkit-box;
               -webkit-line-clamp: 2;
               -webkit-box-orient: vertical;
               overflow: hidden;
               line-height: 1.4;
           }

           .inventory-price {
               font-size: 12px;
               color: #555;
               margin-top: 4px;
               font-family: monospace;
           }

           .inventory-use-btn {
               position: absolute;
               right: 10px;
               bottom: 10px;
               background: linear-gradient(135deg, #d4af37, #f2d06b);
               color: #000;
               border: none;
               border-radius: 4px;
               padding: 4px 10px;
               font-size: 12px;
               font-weight: bold;
               cursor: pointer;
           }

           /* --- To-Do List 样式 --- */

           /* 日期导航栏 */
           .todo-date-navigator {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px 20px;
               background-color: #fff;
               border-bottom: 1px solid var(--border-color);
               flex-shrink: 0;
           }

           .todo-date-navigator button {
               background: none;
               border: none;
               font-size: 24px;
               color: var(--accent-color);
               cursor: pointer;
               padding: 0 10px;
           }

           #todo-current-date-display {
               font-size: 17px;
               font-weight: 600;
               color: var(--text-primary);
           }

           /* 任务卡片 */
           .todo-item {
               background-color: #fff;
               border-radius: 12px;
               padding: 15px;
               margin-bottom: 12px;
               display: flex;
               align-items: flex-start;
               /* 对齐顶部，适应多行文本 */
               gap: 12px;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
               transition: all 0.2s;
               position: relative;
               overflow: hidden;
           }

           .todo-item.completed {
               opacity: 0.6;
               background-color: #f9f9f9;
           }

           /* 复选框样式 */
           .todo-checkbox {
               width: 22px;
               height: 22px;
               border-radius: 50%;
               border: 2px solid #c7c7cc;
               flex-shrink: 0;
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: all 0.2s;
               margin-top: 2px;
               /* 微调对齐 */
           }

           .todo-item.completed .todo-checkbox {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           .todo-item.completed .todo-checkbox::after {
               content: '✔';
               color: white;
               font-size: 14px;
           }

           /* 任务内容 */
           .todo-info {
               flex-grow: 1;
               min-width: 0;
           }

           .todo-content {
               font-size: 16px;
               color: var(--text-primary);
               margin-bottom: 6px;
               line-height: 1.4;
               word-break: break-word;
           }

           .todo-item.completed .todo-content {
               text-decoration: line-through;
               color: var(--text-secondary);
           }

           .todo-meta {
               display: flex;
               align-items: center;
               gap: 8px;
               font-size: 12px;
           }

           /* 标签 Tag */
           .todo-tag {
               padding: 2px 8px;
               border-radius: 6px;
               color: white;
               font-weight: 500;
               font-size: 11px;
               background-color: var(--tag-color, #8e8e93);
           }

           /* 时间显示 */
           .todo-time {
               color: #ff3b30;
               /* 红色强调时间 */
               font-weight: 500;
           }

           .todo-item.completed .todo-time {
               color: var(--text-secondary);
           }

           /* 删除按钮 */
           .todo-delete-btn {
               padding: 5px 10px;
               color: #ff3b30;
               background: none;
               border: none;
               font-size: 18px;
               cursor: pointer;
               margin-left: 5px;
           }

           /* 空状态 */
           .todo-empty-state {
               text-align: center;
               color: var(--text-secondary);
               margin-top: 50px;
           }

           /* --- 类型选择器样式 --- */
           .todo-type-selector {
               display: flex;
               flex-wrap: wrap;
               gap: 10px;
           }

           .todo-type-option {
               padding: 6px 12px;
               border-radius: 15px;
               border: 1px solid #e5e5ea;
               font-size: 14px;
               cursor: pointer;
               color: var(--text-primary);
               background-color: #fff;
               transition: all 0.2s;
           }

           .todo-type-option.active {
               background-color: var(--tag-color);
               color: white;
               border-color: var(--tag-color);
           }

           /* --- 暗黑模式适配 --- */
           #phone-screen.dark-mode #todo-list-screen {
               background-color: #000 !important;
           }

           #phone-screen.dark-mode .todo-date-navigator {
               background-color: #1c1c1e;
               border-bottom-color: #38383a;
           }

           #phone-screen.dark-mode .todo-item {
               background-color: #1c1c1e;
           }

           #phone-screen.dark-mode .todo-item.completed {
               background-color: #121212;
           }

           #phone-screen.dark-mode .todo-type-option {
               background-color: #2c2c2e;
               border-color: #38383a;
               color: #fff;
           }

           /* --- 待办事项：左右分栏布局 (Chat Style) --- */

           /* 1. AI 创建的 (默认靠左) - 保持原样，微调间距 */
           .todo-item.is-char {
               flex-direction: row;
               /* 默认方向：多选框 -> 内容 -> 删除 */
           }

           /* 2. 用户创建的 (靠右) - 使用 row-reverse 翻转布局 */
           .todo-item.is-user {
               flex-direction: row-reverse;
               /* 翻转方向：删除 -> 内容 -> 多选框 */
               background-color: #e7f3ff;
               /* 可选：给用户发的气泡加一点淡淡的蓝色背景，区分更明显 */
           }

           /* 3. 用户内容的文字对齐 */
           .todo-item.is-user .todo-info {
               text-align: right;
               /* 文字靠右 */
               align-items: flex-end;
               /* 如果内部是 flex，则靠右对齐 */
           }

           /* 4. 标签和时间的对齐 */
           .todo-item.is-user .todo-meta {
               justify-content: flex-end;
               /* 标签和时间靠右排列 */
           }

           /* 5. 间距修正 (因为翻转了，margin方向也要反过来) */
           .todo-item.is-user .todo-checkbox {
               margin-right: 0;
               margin-left: 12px;
               /* Checkbox 在最右边，给左边留空隙 */
           }

           .todo-item.is-user .todo-delete-btn {
               margin-left: 0;
               margin-right: 5px;
               /* 删除按钮在最左边，给右边留空隙 */
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .todo-item.is-user {
               background-color: #1a2a3a;
               /* 暗黑模式下的深蓝色背景 */
           }

           #todo-current-date-display {
               cursor: pointer;
               /* 鼠标悬停变小手 */
               user-select: none;
               /* 防止双击选中文字 */
               transition: opacity 0.2s;
               padding: 5px 10px;
               /* 增加一点点击区域 */
               border-radius: 8px;
           }

           #todo-current-date-display:active {
               background-color: rgba(0, 0, 0, 0.05);
               /* 点击时的高亮反馈 */
               opacity: 0.6;
           }

           /* --- Green River (绿江) 极简高端风格 --- */
           :root {
               --gr-primary: #1B4F3E;
               /* 深墨绿 */
               --gr-accent: #2E7D32;
               /* 强调绿 */
               --gr-bg: #FAFAF9;
               /* 暖白/象牙白 */
               --gr-surface: #FFFFFF;
               /* 纯白卡片 */
               --gr-text-main: #1C1C1E;
               /* 深黑 */
               --gr-text-sub: #8E8E93;
               /* 中灰 */
               --gr-border: #E5E5E5;
               /* 极细边框 */
               --gr-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
           }

           /* 全局主题 */
           .gr-theme {
               background-color: var(--gr-bg) !important;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
               color: var(--gr-text-main);
           }

           /* 头部样式 - 极致简约 */
           .gr-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px 24px;
               padding-top: calc(15px + env(safe-area-inset-top));
               background-color: rgba(250, 250, 249, 0.95);
               /* 磨砂背景 */
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               position: sticky;
               top: 0;
               z-index: 10;
               border-bottom: 1px solid transparent;
               /* 默认无边框 */
           }

           .gr-title {
               font-family: "Georgia", serif;
               /* 衬线体增加文学感 */
               font-size: 20px;
               font-weight: 600;
               color: var(--gr-primary);
               letter-spacing: 0.5px;
           }

           .gr-icon-btn {
               background: none;
               border: none;
               color: var(--gr-text-main);
               padding: 8px;
               cursor: pointer;
               opacity: 0.7;
               transition: all 0.2s;
               display: flex;
               align-items: center;
               justify-content: center;
               border-radius: 50%;
           }

           .gr-icon-btn:hover {
               opacity: 1;
               background-color: rgba(0, 0, 0, 0.03);
           }

           /* 内容区域 */
           .gr-content-area {
               padding: 24px;
               overflow-y: auto;
               flex-grow: 1;
           }

           /* 标题与分割 */
           .gr-section-header {
               margin-bottom: 20px;
               display: flex;
               align-items: center;
           }

           .gr-section-title {
               font-size: 14px;
               font-weight: 600;
               color: var(--gr-text-sub);
               text-transform: uppercase;
               letter-spacing: 1px;
           }

           /* 书籍列表 (Grid) */
           .gr-grid-list {
               display: grid;
               grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
               gap: 20px;
           }

           /* 书籍卡片 */
           .gr-book-card {
               background: var(--gr-surface);
               border-radius: 12px;
               padding: 20px;
               box-shadow: var(--gr-shadow);
               cursor: pointer;
               transition: transform 0.2s, box-shadow 0.2s;
               border: 1px solid var(--gr-border);
               display: flex;
               flex-direction: column;
               justify-content: space-between;
               min-height: 120px;
           }

           .gr-book-card:hover {
               transform: translateY(-3px);
               box-shadow: 0 8px 30px rgba(0, 0, 0, 0.06);
               border-color: var(--gr-primary);
           }

           .gr-book-title {
               font-size: 16px;
               font-weight: 600;
               color: var(--gr-text-main);
               margin-bottom: 8px;
               line-height: 1.4;
           }

           .gr-book-meta {
               font-size: 12px;
               color: var(--gr-text-sub);
               display: flex;
               align-items: center;
               gap: 5px;
           }

           /* 作者列表项 */
           .gr-author-item {
               background: var(--gr-surface);
               border-radius: 12px;
               padding: 20px;
               margin-bottom: 16px;
               box-shadow: var(--gr-shadow);
               display: flex;
               justify-content: space-between;
               align-items: center;
               border: 1px solid var(--gr-border);
           }

           .gr-author-info h3 {
               margin: 0 0 4px 0;
               font-size: 16px;
               color: var(--gr-text-main);
           }

           .gr-author-info p {
               margin: 0;
               font-size: 13px;
               color: var(--gr-text-sub);
               max-width: 250px;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           /* 阅读器正文 */
           .gr-reader-content {
               flex-grow: 1;
               overflow-y: auto;
               padding: 30px 24px 100px 24px;
               /* 底部留白给输入框 */
               font-family: "Georgia", "Songti SC", serif;
               /* 衬线体适合阅读 */
               font-size: 17px;
               line-height: 1.8;
               color: #333;
           }

           .gr-chapter {
               margin-bottom: 40px;
           }

           .gr-chapter-text {
               white-space: pre-wrap;
               margin-bottom: 15px;
           }

           /* 摘要折叠块 */
           .gr-summary-box {
               background-color: #F4F4F5;
               border-radius: 8px;
               padding: 12px 16px;
               margin-bottom: 20px;
               font-family: sans-serif;
           }

           .gr-summary-box summary {
               cursor: pointer;
               font-size: 13px;
               color: var(--gr-text-sub);
               font-weight: 500;
               list-style: none;
               /* 隐藏默认三角 */
               display: flex;
               align-items: center;
               gap: 6px;
           }

           .gr-summary-box summary::before {
               content: '▸';
               display: inline-block;
               transition: transform 0.2s;
           }

           .gr-summary-box[open] summary::before {
               transform: rotate(90deg);
           }

           .gr-summary-content {
               font-size: 14px;
               color: #666;
               margin-top: 10px;
               padding-top: 10px;
               border-top: 1px solid #E5E5E5;
               line-height: 1.6;
           }

           /* 底部控制栏 */
           .gr-control-panel {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               background: rgba(255, 255, 255, 0.95);
               backdrop-filter: blur(20px);
               padding: 16px 24px;
               padding-bottom: calc(16px + env(safe-area-inset-bottom));
               border-top: 1px solid var(--gr-border);
               box-sizing: border-box;
           }

           .gr-input-group {
               display: flex;
               gap: 12px;
               align-items: center;
           }

           .gr-input {
               flex-grow: 1;
               background: #F4F4F5;
               border: 1px solid transparent;
               border-radius: 20px;
               padding: 12px 16px;
               font-size: 15px;
               outline: none;
               transition: all 0.2s;
           }

           .gr-input:focus {
               background: #FFF;
               border-color: var(--gr-primary);
               box-shadow: 0 0 0 3px rgba(27, 79, 62, 0.1);
           }

           .gr-main-btn {
               background-color: var(--gr-primary);
               color: white;
               border: none;
               border-radius: 20px;
               padding: 10px 20px;
               font-size: 14px;
               font-weight: 600;
               cursor: pointer;
               display: flex;
               align-items: center;
               gap: 6px;
               transition: transform 0.1s, opacity 0.2s;
               flex-shrink: 0;
           }

           .gr-main-btn:active {
               transform: scale(0.96);
           }

           .gr-main-btn:disabled {
               opacity: 0.6;
               cursor: not-allowed;
           }

           /* 弹窗内表单元素 */
           .gr-form-group {
               margin-bottom: 20px;
           }

           .gr-form-group label {
               display: block;
               font-size: 13px;
               font-weight: 600;
               color: var(--gr-text-main);
               margin-bottom: 8px;
           }

           .gr-select {
               width: 100%;
               padding: 12px;
               border-radius: 10px;
               border: 1px solid #ddd;
               background: #fff;
               font-size: 15px;
               outline: none;
           }

           .gr-checkbox-list {
               max-height: 150px;
               overflow-y: auto;
               border: 1px solid #ddd;
               border-radius: 10px;
               background: #fff;
               padding: 5px;
           }

           .gr-checkbox-item {
               padding: 8px 12px;
               display: flex;
               align-items: center;
               gap: 10px;
               cursor: pointer;
               border-radius: 6px;
           }

           .gr-checkbox-item:hover {
               background-color: #F5F5F7;
           }

           .gr-checkbox-item input {
               accent-color: var(--gr-primary);
               width: 16px;
               height: 16px;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .gr-theme,
           #phone-screen.dark-mode .gr-header,
           #phone-screen.dark-mode .gr-control-panel,
           #phone-screen.dark-mode .gr-book-card,
           #phone-screen.dark-mode .gr-author-item,
           #phone-screen.dark-mode .modal-content {
               background-color: #1C1C1E !important;
               color: #FFFFFF;
           }

           #phone-screen.dark-mode .gr-title,
           #phone-screen.dark-mode .gr-section-title,
           #phone-screen.dark-mode .gr-book-title,
           #phone-screen.dark-mode .gr-author-info h3,
           #phone-screen.dark-mode .gr-form-group label {
               color: #FFFFFF;
           }

           #phone-screen.dark-mode .gr-reader-content {
               color: #E0E0E0;
           }

           #phone-screen.dark-mode .gr-summary-box {
               background-color: #2C2C2E;
           }

           #phone-screen.dark-mode .gr-summary-content {
               color: #AAAAAA;
               border-top-color: #38383A;
           }

           #phone-screen.dark-mode .gr-input,
           #phone-screen.dark-mode .gr-select,
           #phone-screen.dark-mode .gr-checkbox-list {
               background-color: #2C2C2E;
               border-color: #38383A;
               color: #FFFFFF;
           }

           #phone-screen.dark-mode .gr-icon-btn {
               color: #FFFFFF;
           }

           #phone-screen.dark-mode .gr-book-card:hover {
               border-color: #2E7D32;
               /* 暗黑模式下的绿色高亮 */
           }

           /* 绿江：摘要编辑框样式 */
           .gr-summary-input {
               width: 100%;
               background-color: transparent;
               border: 1px dashed transparent;
               /* 默认无边框 */
               font-family: inherit;
               font-size: 13px;
               color: #333;
               resize: vertical;
               padding: 5px;
               box-sizing: border-box;
               transition: all 0.2s;
               min-height: 60px;
           }

           /* 当它是可编辑状态（最后一章）时 */
           .gr-summary-box.editable {
               background-color: #fffbe6;
               /* 淡黄色背景，提示这是存档区 */
               border: 1px solid #e0e0e0;
           }

           .gr-summary-box.editable .gr-summary-input {
               border-color: #ddd;
               /* 显示虚线框 */
               background-color: rgba(255, 255, 255, 0.5);
           }

           .gr-summary-box.editable .gr-summary-input:focus {
               background-color: #fff;
               border-color: var(--gr-primary);
               outline: none;
           }

           .gr-mini-btn {
               font-size: 11px;
               padding: 2px 8px;
               border-radius: 4px;
               border: 1px solid var(--gr-primary);
               background-color: var(--gr-primary);
               color: white;
               cursor: pointer;
           }

           /* --- 绿江阅读器新样式 (Jinjiang Style) --- */

           /* 1. 侧边栏 (Drawer) */
           #gr-sidebar-overlay {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background: rgba(0, 0, 0, 0.3);
               backdrop-filter: blur(2px);
               z-index: 90;
               opacity: 0;
               visibility: hidden;
               transition: all 0.3s;
           }

           #gr-sidebar-overlay.visible {
               opacity: 1;
               visibility: visible;
           }

           #gr-chapter-sidebar {
               position: absolute;
               top: 0;
               left: 0;
               width: 75%;
               /* 侧边栏宽度 */
               height: 100%;
               background: var(--gr-bg);
               z-index: 100;
               transform: translateX(-100%);
               transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
               box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
               display: flex;
               flex-direction: column;
           }

           #gr-chapter-sidebar.visible {
               transform: translateX(0);
           }

           .gr-sidebar-header {
               padding: 20px;
               padding-top: calc(20px + env(safe-area-inset-top));
               border-bottom: 1px solid var(--gr-border);
               font-weight: 600;
               display: flex;
               justify-content: space-between;
               align-items: center;
           }

           #gr-chapter-list-content {
               flex-grow: 1;
               overflow-y: auto;
               padding: 10px 0;
           }

           .gr-sidebar-item {
               padding: 15px 20px;
               border-bottom: 1px solid #f5f5f5;
               cursor: pointer;
               font-size: 14px;
               color: #333;
               transition: background 0.2s;
           }

           .gr-sidebar-item:hover {
               background-color: rgba(0, 0, 0, 0.02);
           }

           .gr-sidebar-item.active {
               color: var(--gr-primary);
               font-weight: 600;
               background-color: rgba(27, 79, 62, 0.05);
           }

           .gr-sidebar-item span {
               margin-left: 10px;
           }

           /* 2. 底部控制栏调整 */
           .gr-control-panel {
               display: flex;
               flex-direction: column;
               gap: 10px;
               /* 确保固定在底部 */
               position: absolute;
               bottom: 0;
           }

           .gr-text-btn {
               background: transparent;
               border: none;
               color: var(--gr-primary);
               font-size: 14px;
               font-weight: 600;
               padding: 10px 20px;
               cursor: pointer;
           }

           .gr-text-btn:disabled {
               color: #ccc;
               cursor: default;
           }

           /* 3. 正文区域微调 */
           .gr-reader-content {
               padding-bottom: 120px;
               /* 给底部栏留出足够空间 */
           }

           .gr-chapter-title-large {
               font-family: "Georgia", serif;
               font-size: 22px;
               font-weight: bold;
               text-align: center;
               margin: 20px 0 30px 0;
               color: #111;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #gr-chapter-sidebar {
               background-color: #1c1c1e;
               border-right: 1px solid #333;
           }

           #phone-screen.dark-mode .gr-sidebar-item {
               color: #ddd;
               border-bottom-color: #2c2c2e;
           }

           #phone-screen.dark-mode .gr-sidebar-item.active {
               background-color: rgba(255, 255, 255, 0.1);
               color: #fff;
           }

           /* --- 绿江：高端摘要卡片重构 --- */

           /* 1. 卡片容器：干净、悬浮感 */
           .gr-summary-card.editable {
               background-color: #FFFFFF;
               /* 纯净白底 */
               border: 1px solid rgba(0, 0, 0, 0.05);
               /* 几乎不可见的极细边框 */
               border-radius: 12px;
               /* 更大的圆角，现代感 */
               padding: 24px;
               /* 充足的内部留白，呼吸感 */
               box-shadow: 0 8px 30px rgba(0, 0, 0, 0.04);
               /* 极轻柔的高级灰阴影 */
               margin-top: 40px;
               /* 与正文拉开更大距离，彰显重要性 */
               transition: all 0.3s ease;
           }

           /* 鼠标悬停时稍微强调一下 */
           .gr-summary-card.editable:hover {
               box-shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
               border-color: rgba(27, 79, 62, 0.1);
           }

           /* 2. 卡片头部 */
           .gr-summary-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               margin-bottom: 16px;
           }

           /* 标题：使用优雅的衬线体，品牌色 */
           .gr-summary-title {
               font-family: "Georgia", "Songti SC", serif;
               /* 衬线体 */
               color: var(--gr-primary);
               /* 深墨绿 */
               font-size: 16px;
               font-weight: 600;
               letter-spacing: 0.5px;
           }

           /* 3. 输入框本体：极简、融入背景 */
           .gr-summary-input {
               width: 100%;
               box-sizing: border-box;
               /* 关键：防止padding撑破宽度 */
               background-color: #F9F9F9;
               /* 极淡的灰，与纯白卡片形成微弱对比 */
               border: 1px solid #EAEAEA;
               /* 极细淡灰边框 */
               border-radius: 8px;
               padding: 16px;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
               /* 输入内容用无衬线体更清晰 */
               font-size: 14px;
               color: #333;
               line-height: 1.7;
               resize: vertical;
               min-height: 100px;
               outline: none;
               transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
           }

           /* 输入框聚焦状态：显现品牌感 */
           .gr-summary-input:focus {
               background-color: #FFFFFF;
               /* 聚焦变纯白 */
               border-color: var(--gr-primary);
               /* 边框变品牌绿 */
               box-shadow: 0 0 0 4px rgba(27, 79, 62, 0.05);
               /* 极微弱的绿色光晕 */
           }

           .gr-summary-input::placeholder {
               color: #CCC;
           }

           /* 4. 底部提示小字：弱化处理 */
           .gr-summary-footer {
               font-size: 12px;
               color: #AAA;
               /* 更浅的灰色 */
               margin-top: 12px;
               text-align: right;
               /* 右对齐，不干扰视线 */
               font-weight: 400;
           }

           /* 保存按钮微调 */
           .gr-mini-btn.save-summary-btn {
               background-color: transparent;
               color: var(--gr-primary);
               border: 1px solid var(--gr-primary);
               padding: 6px 12px;
               font-weight: 500;
               opacity: 0;
               /* 默认隐藏，输入时JS会让它显示，这里配合JS */
               transition: all 0.2s;
           }

           /* JS控制显示时的样式 */
           .gr-mini-btn.save-summary-btn[style*="display: block"] {
               opacity: 1;
           }

           .gr-mini-btn.save-summary-btn:hover {
               background-color: var(--gr-primary);
               color: white;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .gr-summary-card.editable {
               background-color: #2C2C2E;
               border-color: #3A3A3C;
           }

           #phone-screen.dark-mode .gr-summary-title {
               color: #FFFFFF;
           }

           #phone-screen.dark-mode .gr-summary-input {
               background-color: #1C1C1E;
               border-color: #3A3A3C;
               color: #EEE;
           }

           #phone-screen.dark-mode .gr-summary-input:focus {
               background-color: #000;
               border-color: var(--gr-primary);
           }

           #phone-screen.dark-mode .gr-summary-footer {
               color: #666;
           }

           /* 作者列表项的操作按钮容器 */
           .gr-author-actions {
               display: flex;
               gap: 10px;
               /* 按钮之间的间距 */
               align-items: center;
           }

           /* 如果之前没有定义 gr-input，补充一下以防万一 */
           .gr-input {
               width: 100%;
               padding: 12px;
               border-radius: 10px;
               border: 1px solid #ddd;
               background: #f9f9f9;
               font-size: 15px;
               outline: none;
               box-sizing: border-box;
           }

           .gr-input:focus {
               background: #fff;
               border-color: #1B4F3E;
           }

           /* ========================================== */
           /* ▼▼▼ 绿江 (Green River) 风格终极修正 ▼▼▼ */
           /* ========================================== */

           /* 1. 顶栏布局与宽度统一 (对齐QQ风格) */
           .gr-header {
               /* 1. 布局与尺寸：强制占满宽度 */
               display: flex !important;
               justify-content: space-between !important;
               align-items: center !important;
               width: 100% !important;
               box-sizing: border-box !important;

               /* 2. 高度核心修复：对齐 QQ 头部高度 */
               /* QQ 头部样式为: padding: 15px 20px; padding-top: 45px; */
               padding: 15px 20px !important;
               padding-top: 45px !important;
               /* 关键：强制预留 45px 状态栏高度 */

               /* 3. 定位与外观 */
               position: sticky !important;
               top: 0 !important;
               z-index: 100 !important;
               background-color: rgba(250, 250, 249, 0.98) !important;
               border-bottom: 1px solid #E5E5E5 !important;
               flex-shrink: 0 !important;
               /* 防止被内容挤压 */
           }

           /* 确保标题字体与 QQ 头部大小相近，但保持绿江风格 */
           .gr-title {
               font-family: "Georgia", "Songti SC", serif !important;
               font-size: 20px !important;
               /* 稍微大一点点，显得更有文学感，位置居中 */
               font-weight: 700 !important;
               color: #1B4F3E !important;
               /* 绝对定位居中 (可选，如果想要绝对居中对齐请解开下面注释，否则保持 Flex 居中) */
               /* position: absolute;
    left: 50%;
    transform: translateX(-50%);
    */
           }

           /* 修复右侧按钮容器，确保横向排列 */
           .gr-header-actions {
               display: flex !important;
               flex-direction: row !important;
               gap: 15px !important;
               align-items: center !important;
               /* 确保它在最上层，如果使用了标题绝对定位 */
               z-index: 10 !important;
           }

           /* 修正按钮本身的大小和对齐 */
           .gr-header .gr-icon-btn {
               width: 32px !important;
               height: 32px !important;
               padding: 6px !important;
               margin: 0 !important;
               display: flex !important;
               align-items: center;
               justify-content: center;
               /* 去掉可能导致换行的属性 */
               flex: none !important;
           }

           /* 3. 作者列表项内按钮强制横向 */
           .gr-author-actions {
               display: flex !important;
               flex-direction: row !important;
               align-items: center !important;
               gap: 10px !important;
           }

           /* 4. 绿江专属模态窗样式 (统一为“添加书”的高端风格) */
           #gr-author-editor-modal .modal-content {
               background-color: #FAFAF9 !important;
               /* 暖白背景 */
               border-radius: 16px !important;
               box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1) !important;
               padding: 0 !important;
               overflow: hidden !important;
           }

           /* 弹窗头部 */
           #gr-author-editor-modal .modal-header {
               background: transparent !important;
               border-bottom: none !important;
               padding: 25px 25px 10px 25px !important;
               justify-content: flex-start !important;
               /* 标题靠左或居中，这里选靠左更像书 */
           }

           #gr-author-editor-modal .modal-header span {
               font-family: "Georgia", "Songti SC", serif !important;
               color: #1B4F3E !important;
               /* 墨绿色 */
               font-size: 22px !important;
               font-weight: 700 !important;
           }

           /* 弹窗主体 */
           #gr-author-editor-modal .modal-body {
               padding: 10px 25px 30px 25px !important;
           }

           /* 输入框组 */
           #gr-author-editor-modal .form-group {
               margin-bottom: 20px !important;
           }

           /* 标签 */
           #gr-author-editor-modal label {
               color: #1B4F3E !important;
               font-size: 14px !important;
               font-weight: 600 !important;
               margin-bottom: 8px !important;
               display: block !important;
               opacity: 0.8;
           }

           /* 输入框本体 */
           #gr-author-editor-modal input,
           #gr-author-editor-modal textarea {
               background-color: #FFFFFF !important;
               border: 1px solid #E5E5E5 !important;
               border-radius: 10px !important;
               padding: 15px !important;
               font-size: 16px !important;
               color: #333 !important;
               width: 100% !important;
               box-sizing: border-box !important;
               font-family: -apple-system, sans-serif !important;
               transition: all 0.2s !important;
           }

           #gr-author-editor-modal input:focus,
           #gr-author-editor-modal textarea:focus {
               border-color: #1B4F3E !important;
               box-shadow: 0 0 0 3px rgba(27, 79, 62, 0.05) !important;
               outline: none !important;
           }

           /* 弹窗底部 */
           #gr-author-editor-modal .modal-footer {
               border-top: 1px solid #E5E5E5 !important;
               padding: 15px 25px !important;
               background-color: #FFFFFF !important;
               gap: 15px !important;
           }

           /* 按钮 */
           #gr-author-editor-modal .modal-footer button {
               border-radius: 25px !important;
               padding: 12px 0 !important;
               font-size: 15px !important;
               font-weight: 600 !important;
               border: none !important;
           }

           #gr-author-editor-modal .modal-footer .cancel {
               background-color: #F5F5F7 !important;
               color: #8E8E93 !important;
               width: 30% !important;
           }

           #gr-author-editor-modal .modal-footer .save {
               background-color: #1B4F3E !important;
               color: #FFFFFF !important;
               width: 70% !important;
               box-shadow: 0 4px 15px rgba(27, 79, 62, 0.2) !important;
           }

           /* === Mail App Theme (修复版) === */
           :root {
               --mail-bg: #F2F2F7;
               --mail-surface: #FFFFFF;
               --mail-text-primary: #000000;
               --mail-text-secondary: #8E8E93;
               --mail-accent: #007AFF;
               --mail-separator: #C6C6C8;
               --mail-border-radius: 12px;
           }

           /* 主屏幕背景 */
           #email-screen {
               background-color: var(--mail-bg);
               color: var(--mail-text-primary);
               font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
               display: flex;
               /* 新增：改为Flex布局以便控制滚动 */
               flex-direction: column;
           }

           /* --- 1. 头部区域 (统一QQ风格) --- */
           .mail-header,
           .mail-detail-header {
               /* 核心修复：高度和内边距与 QQ 保持一致 */
               padding: 15px 20px !important;
               padding-top: 45px !important;
               /* 避开刘海 */
               background-color: rgba(242, 242, 247, 0.95);
               /* 略带透明背景 */
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               position: sticky;
               top: 0;
               z-index: 10;
               border-bottom: 0.5px solid #C6C6C8;
               display: flex;
               justify-content: space-between;
               align-items: center;
               flex-shrink: 0;
               min-height: 40px;
           }

           /* 详情页头部背景改为纯白，与详情页一致 */
           .mail-detail-header {
               background-color: rgba(255, 255, 255, 0.95);
           }

           /* 头部上方的容器 (用于容纳返回按钮和标题) */
           .mail-header-top {
               display: contents;
               /* 取消这层容器的布局影响，直接让子元素参与 Grid/Flex */
           }

           /* 2. 按钮样式统一 */
           .mail-icon-btn {
               background: none;
               border: none;
               color: var(--mail-accent);
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 5px;
               /* 增加点击区域 */
               cursor: pointer;
               font-size: 16px;
               font-weight: 500;
               transition: opacity 0.2s;
           }

           .mail-icon-btn:active {
               opacity: 0.6;
           }

           .mail-icon-btn svg {
               width: 24px;
               height: 24px;
           }

           /* 右上角操作区 */
           .mail-header-actions {
               display: flex;
               align-items: center;
               gap: 15px;
               /* 按钮间距 */
           }

           /* 3. 收件箱大标题 (下移，不占用顶栏) */
           .mail-large-title {
               font-size: 30px;
               font-weight: 700;
               margin: 10px 20px 10px 20px;
               /* 左右边距对齐列表 */
               letter-spacing: -0.5px;
               color: #000;
           }

           /* 4. 搜索栏 */
           .mail-search-bar {
               background-color: rgba(118, 118, 128, 0.12);
               border-radius: 10px;
               padding: 8px 12px;
               display: flex;
               align-items: center;
               gap: 8px;
               margin: 0 16px 10px 16px;
               /* 增加外边距 */
           }

           .mail-search-bar input {
               background: transparent;
               border: none;
               font-size: 16px;
               width: 100%;
               outline: none;
               color: #000;
           }

           /* 5. 列表容器 */
           .mail-list-container {
               background-color: var(--mail-surface);
               border-radius: var(--mail-border-radius);
               margin: 0 16px;
               /* 两侧留白 */
               flex-grow: 1;
               overflow-y: auto;
               box-shadow: 0 1px 2px rgba(0, 0, 0, 0.02);
               padding-bottom: 20px;
           }

           /* 6. 详情页内容调整 */
           .mail-detail-content {
               padding: 20px;
               overflow-y: auto;
               flex-grow: 1;
               /* 占满剩余空间 */
               height: auto;
               /* 取消固定高度计算 */
               background-color: #fff;
           }

           /* 7. 隐藏底部工具栏 */
           .mail-toolbar {
               display: none !important;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .mail-header,
           #phone-screen.dark-mode .mail-detail-header {
               background-color: #000;
               border-bottom-color: #38383A;
           }

           #phone-screen.dark-mode .mail-detail-content {
               background-color: #000;
           }

           #phone-screen.dark-mode .mail-large-title {
               color: #fff;
           }


           /* ========================================= */
           /* ▼▼▼ Swiss Minimalist Mail Theme ▼▼▼ */
           /* ========================================= */

           :root {
               /* 核心色板 - 极简、冷淡、高级 */
               --mail-bg: #F2F2F7;
               /* iOS系统级浅灰背景 */
               --mail-surface: #FFFFFF;
               /* 纯净白 */
               --mail-text-main: #1C1C1E;
               /* 深炭黑，非纯黑 */
               --mail-text-sub: #8E8E93;
               /* 中性灰 */
               --mail-accent: #007AFF;
               /* 瑞士蓝 (Swiss Blue) */
               --mail-border: rgba(0, 0, 0, 0.04);
               /* 极细微的边界 */
               --mail-divider: #C6C6C8;
               /* 分割线 */
               --mail-radius-l: 16px;
               /* 大圆角 */
               --mail-radius-m: 10px;
               /* 中圆角 */
               --mail-radius-s: 6px;
               /* 小圆角 */
               --mail-shadow: 0 4px 24px rgba(0, 0, 0, 0.03);
               /* 漂浮感阴影 */
           }

           /* 暗黑模式变量重写 */
           #phone-screen.dark-mode {
               --mail-bg: #000000;
               --mail-surface: #1C1C1E;
               --mail-text-main: #FFFFFF;
               --mail-text-sub: #98989D;
               --mail-border: rgba(255, 255, 255, 0.1);
               --mail-divider: #38383A;
               --mail-shadow: 0 4px 24px rgba(0, 0, 0, 0.2);
           }

           /* 邮箱主容器 */
           #email-screen,
           #email-detail-screen {
               background-color: var(--mail-bg) !important;
               font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
               letter-spacing: -0.01em;
               /* 收紧字间距，更精致 */
           }



           /* --- 2. 标题与搜索栏 --- */
           .mail-large-title {
               font-size: 34px;
               font-weight: 700;
               color: var(--mail-text-main);
               margin: 10px 20px 15px 20px !important;
               letter-spacing: 0.01em;
           }

           .mail-search-bar {
               background-color: rgba(118, 118, 128, 0.12);
               border-radius: 10px;
               margin: 0 16px 16px 16px;
               padding: 10px 12px;
               display: flex;
               align-items: center;
               gap: 8px;
               transition: background-color 0.2s;
           }

           .mail-search-bar:focus-within {
               background-color: rgba(118, 118, 128, 0.18);
           }

           .mail-search-bar input {
               font-size: 17px;
               color: var(--mail-text-main);
               height: auto;
           }

           .mail-search-bar input::placeholder {
               color: var(--mail-text-sub);
           }

           /* --- 3. 邮件列表 (List) --- */
           .mail-list-container {
               background-color: var(--mail-bg) !important;
               /* 背景透明，显示层级 */
               padding: 0 16px !important;
               /* 两侧留白 */
               border-radius: 0 !important;
               box-shadow: none !important;
               margin: 0 !important;
               gap: 12px;
               /* 列表项间距 */
               display: flex;
               flex-direction: column;
           }

           .mail-item {
               background-color: var(--mail-surface);
               border-radius: var(--mail-radius-m);
               padding: 16px !important;
               margin-bottom: 0 !important;
               /* 由 gap 控制 */
               border: 1px solid var(--mail-border);
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
               /* 极轻的阴影 */
               position: relative;
               transition: transform 0.1s, background-color 0.2s;
           }

           .mail-item:active {
               transform: scale(0.98);
               background-color: var(--mail-bg);
           }

           /* 未读状态：左侧蓝点 */
           .mail-item.unread::before {
               content: '';
               position: absolute;
               left: 10px;
               top: 20px;
               width: 8px;
               height: 8px;
               background-color: var(--mail-accent);
               border-radius: 50%;
               box-shadow: 0 0 8px rgba(0, 122, 255, 0.4);
           }

           .mail-item.unread {
               padding-left: 26px !important;
               /* 为蓝点留出空间 */
           }

           /* 列表排版优化 */
           .mail-item-header {
               display: flex;
               justify-content: space-between;
               align-items: baseline;
               margin-bottom: 4px;
           }

           .mail-sender {
               font-size: 16px;
               font-weight: 600;
               color: var(--mail-text-main);
           }

           .mail-date {
               font-size: 13px;
               color: var(--mail-text-sub);
               font-weight: 400;
           }

           .mail-subject {
               font-size: 15px;
               font-weight: 500;
               color: var(--mail-text-main);
               margin-bottom: 4px;
           }

           .mail-preview {
               font-size: 14px;
               color: var(--mail-text-sub);
               line-height: 1.4;
               display: -webkit-box;
               -webkit-line-clamp: 2;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           /* --- 4. 邮件详情页 (Detail) --- */
           #email-detail-screen {
               background-color: var(--mail-surface) !important;
           }

           .mail-detail-content {
               padding: 24px 20px !important;
               max-width: 600px;
               margin: 0 auto;
               background-color: transparent !important;
           }

           /* 详情页头部信息块 */
           .mail-meta-header {
               margin-bottom: 30px;
               padding-bottom: 20px;
               border-bottom: 1px solid var(--mail-border);
           }

           .mail-subject-line {
               font-size: 22px;
               font-weight: 700;
               color: var(--mail-text-main);
               line-height: 1.3;
               margin-bottom: 16px;
           }

           .mail-meta-row {
               display: flex;
               align-items: center;
               gap: 12px;
           }

           .mail-sender-avatar {
               width: 44px;
               height: 44px;
               border-radius: 50%;
               background: linear-gradient(135deg, #8E8E93, #636366);
               color: white;
               font-size: 18px;
               font-weight: 600;
               display: flex;
               align-items: center;
               justify-content: center;
               box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
           }

           .mail-meta-info {
               flex-grow: 1;
               display: flex;
               flex-direction: column;
               justify-content: center;
           }

           .mail-from-row {
               display: flex;
               justify-content: space-between;
               align-items: baseline;
           }

           .mail-from-name {
               font-size: 16px;
               font-weight: 600;
               color: var(--mail-text-main);
           }

           .mail-time {
               font-size: 12px;
               color: var(--mail-text-sub);
           }

           .mail-to-row {
               font-size: 13px;
               color: var(--mail-text-sub);
               margin-top: 2px;
           }

           /* 邮件正文 */
           .mail-body-text {
               font-size: 16px;
               line-height: 1.6;
               color: var(--mail-text-main);
               white-space: pre-wrap;
           }

           /* --- 5. 生成器弹窗 (The "Ugly" Fix) --- */
           #email-generator-modal .modal-content {
               background-color: var(--mail-bg) !important;
               border-radius: var(--mail-radius-l) !important;
               box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2) !important;
               border: 1px solid rgba(255, 255, 255, 0.1);
               max-width: 400px;
               width: 92%;
           }

           .mail-modal-header {
               padding: 20px 24px !important;
               border-bottom: 1px solid var(--mail-border);
           }

           .mail-modal-header span {
               font-size: 18px;
               font-weight: 600;
               color: var(--mail-text-main);
           }

           /* 表单控件优化 */
           .gr-form-group {
               background-color: var(--mail-surface);
               border-radius: var(--mail-radius-m);
               padding: 16px;
               margin-bottom: 16px !important;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02);
           }

           .gr-form-group label {
               font-size: 13px;
               text-transform: uppercase;
               letter-spacing: 0.5px;
               color: var(--mail-text-sub) !important;
               margin-bottom: 10px !important;
               display: block;
               font-weight: 600;
           }

           .gr-input,
           textarea.gr-input {
               width: 100%;
               background-color: var(--mail-bg);
               border: none;
               border-radius: 8px;
               padding: 12px;
               font-size: 15px;
               color: var(--mail-text-main);
               outline: none;
               transition: box-shadow 0.2s;
           }

           .gr-input:focus {
               box-shadow: 0 0 0 2px var(--mail-accent);
               background-color: var(--mail-surface);
           }

           /* Checkbox 列表优化 */
           .gr-checkbox-list {
               background: transparent !important;
               border: none !important;
               padding: 0 !important;
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           .gr-checkbox-item {
               display: flex;
               align-items: center;
               padding: 10px;
               background-color: var(--mail-bg);
               /* 浅灰底色 */
               border-radius: 8px;
               cursor: pointer;
               transition: background-color 0.2s;
           }

           .gr-checkbox-item:hover {
               background-color: #E5E5EA;
               /* 悬停加深 */
           }

           #phone-screen.dark-mode .gr-checkbox-item:hover {
               background-color: #3A3A3C;
           }

           /* 复选框美化 */
           .gr-checkbox-item input[type="checkbox"] {
               appearance: none;
               -webkit-appearance: none;
               width: 20px;
               height: 20px;
               border: 2px solid #C7C7CC;
               border-radius: 50%;
               /* 圆形复选框，像选择列表 */
               margin-right: 12px;
               position: relative;
               transition: all 0.2s;
           }

           .gr-checkbox-item input[type="checkbox"]:checked {
               background-color: var(--mail-accent);
               border-color: var(--mail-accent);
           }

           .gr-checkbox-item input[type="checkbox"]:checked::after {
               content: '✔';
               font-size: 12px;
               color: white;
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
           }

           /* 弹窗底部按钮 */
           .modal-footer {
               padding: 16px 24px !important;
               background-color: var(--mail-surface) !important;
           }

           .modal-footer button {
               padding: 12px 0 !important;
               border-radius: 10px !important;
               font-size: 16px !important;
               font-weight: 600 !important;
           }

           /* 底部操作栏样式 */
           #mail-action-bar {
               position: absolute;
               bottom: 0;
               left: 0;
               width: 100%;
               background-color: rgba(242, 242, 247, 0.95);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-top: 0.5px solid #c6c6c8;
               padding: 10px 20px;
               padding-bottom: calc(10px + env(safe-area-inset-bottom));
               display: flex;
               justify-content: space-between;
               align-items: center;
               box-sizing: border-box;
               z-index: 20;
           }

           .select-all-btn {
               color: var(--mail-accent);
               font-size: 16px;
               font-weight: 500;
               cursor: pointer;
           }

           .mail-delete-action-btn {
               color: #ff3b30;
               background: none;
               border: none;
               font-size: 16px;
               font-weight: 600;
               cursor: pointer;
           }

           .mail-delete-action-btn:disabled {
               color: #999;
               pointer-events: none;
           }

           /* 邮件列表项的选择状态样式 */
           .mail-item {
               transition: transform 0.2s ease, padding-left 0.2s ease;
               position: relative;
               overflow: visible !important;
               /* 允许选中圈显示在左侧 */
           }

           /* 编辑模式下，给左侧留出空间 */
           .mail-item.editing {
               transform: translateX(40px);
               /* 整体右移 */
               width: calc(100% - 40px);
               /* 宽度自适应 */
           }

           /* 选择圈 (Checkbox) */
           .mail-select-checkbox {
               position: absolute;
               left: -30px;
               /* 放在卡片左侧 */
               top: 50%;
               transform: translateY(-50%);
               width: 22px;
               height: 22px;
               border: 2px solid #c7c7cc;
               border-radius: 50%;
               box-sizing: border-box;
               background-color: transparent;
               transition: all 0.2s;
               display: none;
               /* 默认隐藏 */
           }

           /* 编辑模式下显示选择圈 */
           .mail-item.editing .mail-select-checkbox {
               display: block;
           }

           /* 选中状态 */
           .mail-item.selected .mail-select-checkbox {
               background-color: var(--mail-accent);
               border-color: var(--mail-accent);
           }

           .mail-item.selected .mail-select-checkbox::after {
               content: '✔';
               color: white;
               font-size: 14px;
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #mail-action-bar {
               background-color: rgba(28, 28, 30, 0.95);
               border-top-color: #38383a;
           }


           /* === 邮件转发卡片样式 === */
           .email-share-card {
               width: 240px;
               background-color: #ffffff;
               border-radius: 12px;
               padding: 12px;
               box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
               border: 1px solid rgba(0, 0, 0, 0.05);
               cursor: pointer;
               transition: transform 0.2s;
               overflow: hidden;
           }

           .email-share-card:active {
               transform: scale(0.98);
               background-color: #f9f9f9;
           }

           /* 顶部：图标 + 标题信息 */
           .email-card-top {
               display: flex;
               gap: 10px;
               margin-bottom: 10px;
               align-items: flex-start;
           }

           /* 蓝色图标块 */
           .email-icon-box {
               width: 36px;
               height: 36px;
               background: linear-gradient(135deg, #007aff, #0056b3);
               border-radius: 8px;
               display: flex;
               align-items: center;
               justify-content: center;
               color: white;
               flex-shrink: 0;
               box-shadow: 0 2px 5px rgba(0, 122, 255, 0.2);
           }

           .email-card-header-text {
               flex: 1;
               overflow: hidden;
           }

           .email-card-subject {
               font-size: 15px;
               font-weight: 600;
               color: #1f1f1f;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               line-height: 1.2;
               margin-bottom: 3px;
           }

           .email-card-sender {
               font-size: 12px;
               color: #8a8a8a;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           /* 中间：摘要预览 */
           .email-card-preview {
               font-size: 13px;
               color: #666;
               line-height: 1.5;
               display: -webkit-box;
               -webkit-line-clamp: 3;
               -webkit-box-orient: vertical;
               overflow: hidden;
               margin-bottom: 8px;
               background-color: #f7f7f9;
               padding: 8px;
               border-radius: 6px;
           }

           /* 底部：脚标 */
           .email-card-footer {
               display: flex;
               justify-content: space-between;
               align-items: center;
               border-top: 1px solid #f0f0f0;
               padding-top: 8px;
               font-size: 11px;
               color: #999;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .email-share-card {
               background-color: #1c1c1e;
               border-color: #333;
           }

           #phone-screen.dark-mode .email-share-card:active {
               background-color: #2c2c2e;
           }

           #phone-screen.dark-mode .email-card-subject {
               color: #fff;
           }

           #phone-screen.dark-mode .email-card-preview {
               background-color: #2c2c2e;
               color: #aaa;
           }

           #phone-screen.dark-mode .email-card-footer {
               border-top-color: #333;
           }

           /* --- 渲染规则绑定范围美化 --- */

           /* 1. 容器美化：类似 iOS 分组卡片 */
           #rule-scope-checkboxes {
               max-height: 250px;
               overflow-y: auto;
               background-color: var(--secondary-bg);
               /* 适配暗黑模式 */
               border: 1px solid var(--border-color);
               border-radius: 10px;
               padding: 5px;
               margin-top: 5px;
               display: flex;
               flex-direction: column;
               gap: 2px;
           }

           /* 2. 单行列表项美化 */
           .rule-scope-item {
               display: flex;
               align-items: center;
               padding: 10px 12px;
               border-radius: 8px;
               cursor: pointer;
               transition: background-color 0.2s ease;
               user-select: none;
               /* 防止双击选中文字 */
           }

           /* 悬停和点击效果 */
           .rule-scope-item:hover {
               background-color: rgba(0, 0, 0, 0.05);
           }

           .rule-scope-item:active {
               background-color: rgba(0, 0, 0, 0.1);
           }

           /* 3. 复选框美化：变大一点，并增加右边距 */
           .rule-scope-item input[type="checkbox"] {
               appearance: none;
               /* 移除默认样式 */
               -webkit-appearance: none;
               width: 22px;
               height: 22px;
               border: 2px solid #c7c7cc;
               border-radius: 50%;
               /* 圆形复选框，像选择列表 */
               margin-right: 12px;
               position: relative;
               transition: all 0.2s;
               flex-shrink: 0;
           }

           /* 选中状态 */
           .rule-scope-item input[type="checkbox"]:checked {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           /* 选中时的对勾 */
           .rule-scope-item input[type="checkbox"]:checked::after {
               content: '✔';
               font-size: 14px;
               color: white;
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
               font-weight: bold;
           }

           /* 4. 头像样式 */
           .rule-scope-avatar {
               width: 36px;
               height: 36px;
               border-radius: 50%;
               object-fit: cover;
               margin-right: 12px;
               border: 1px solid rgba(0, 0, 0, 0.1);
               flex-shrink: 0;
           }

           /* 公用图标的特殊样式 */
           .rule-scope-icon-box {
               width: 36px;
               height: 36px;
               border-radius: 50%;
               background-color: #007aff;
               /* 蓝色背景 */
               color: white;
               display: flex;
               align-items: center;
               justify-content: center;
               margin-right: 12px;
               font-size: 18px;
               flex-shrink: 0;
           }

           /* 5. 文字排版 */
           .rule-scope-info {
               display: flex;
               flex-direction: column;
               flex-grow: 1;
               overflow: hidden;
           }

           .rule-scope-name {
               font-size: 15px;
               font-weight: 500;
               color: var(--text-primary);
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .rule-scope-desc {
               font-size: 12px;
               color: var(--text-secondary);
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #rule-scope-checkboxes {
               background-color: #1c1c1e;
               border-color: #38383a;
           }

           #phone-screen.dark-mode .rule-scope-item:hover {
               background-color: rgba(255, 255, 255, 0.1);
           }

           /* --- 渲染规则管理模式样式 --- */

           /* 1. 规则卡片容器调整 */
           .rule-card {
               position: relative;
               /* 为复选框定位 */
               transition: transform 0.2s ease, border-color 0.2s;
           }

           /* 2. 隐藏的复选框 */
           .rule-select-checkbox {
               position: absolute;
               top: 15px;
               right: 15px;
               width: 22px;
               height: 22px;
               border: 2px solid #c7c7cc;
               border-radius: 50%;
               appearance: none;
               -webkit-appearance: none;
               background-color: transparent;
               display: none;
               /* 默认隐藏 */
               z-index: 5;
               transition: all 0.2s;
           }

           /* 3. 选中状态 */
           .rule-select-checkbox:checked {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           .rule-select-checkbox:checked::after {
               content: '✔';
               color: white;
               font-size: 14px;
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
               font-weight: bold;
           }

           /* 4. 管理模式激活时 */
           #rules-content-container.management-mode {
               padding-bottom: 80px;
               /* 为底部栏留空 */
           }

           #rules-content-container.management-mode .rule-select-checkbox {
               display: block;
               /* 显示复选框 */
           }

           #rules-content-container.management-mode .rule-card {
               border-right: 30px solid transparent;
               /* 稍微挤压一点内容 */
           }

           #rules-content-container.management-mode .rule-card.selected {
               background-color: rgba(0, 122, 255, 0.05);
               border-color: var(--accent-color);
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #rules-action-bar {
               background-color: rgba(28, 28, 30, 0.95);
               border-top-color: #38383a;
               color: #fff;
           }

           /* --- START: 聊天图片缩略图与放大样式 --- */

           /* 1. 强制缩小聊天记录中的图片尺寸 */
           .message-bubble .chat-image {
               max-width: 140px !important;
               /* 缩略图最大宽度 */
               max-height: 180px !important;
               /* 缩略图最大高度 */
               width: auto !important;
               height: auto !important;
               border-radius: 8px !important;
               cursor: zoom-in !important;
               /* 鼠标移上去显示放大图标 */
               object-fit: cover !important;
               display: block;
           }

           /* 2. 简单的全屏放大遮罩层 (不依赖相册组件) */
           #simple-image-zoom-overlay {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: rgba(0, 0, 0, 0.85);
               /* 深色半透明背景 */
               z-index: 99999;
               /* 保证在最上层 */
               display: none;
               /* 默认隐藏 */
               justify-content: center;
               align-items: center;
               opacity: 0;
               transition: opacity 0.25s ease;
               /* 渐变动画 */
               backdrop-filter: blur(5px);
           }

           #simple-image-zoom-overlay.visible {
               display: flex;
               opacity: 1;
           }

           /* 放大后的图片本体 */
           #simple-image-zoom-overlay img {
               max-width: 95%;
               max-height: 90%;
               border-radius: 4px;
               box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
               transform: scale(0.9);
               transition: transform 0.25s ease;
               object-fit: contain;
           }

           #simple-image-zoom-overlay.visible img {
               transform: scale(1);
           }

           /* --- END: 聊天图片缩略图与放大样式 --- */
           /* 通用按钮样式 */
           .nai-regenerate-btn,
           .nai-upload-imgbb-btn,
           .nai-save-local-btn {
               width: 32px;
               height: 32px;
               background-color: rgba(0, 0, 0, 0.6);
               backdrop-filter: blur(4px);
               -webkit-backdrop-filter: blur(4px);
               border: 1px solid rgba(255, 255, 255, 0.3);
               border-radius: 50%;
               color: white;
               cursor: pointer;
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 0;
               opacity: 0;
               transition: all 0.2s ease-in-out;
           }

           /* 悬停显示 */
           .nai-image-wrapper:hover .nai-regenerate-btn,
           .nai-image-wrapper:hover .nai-upload-imgbb-btn,
           .nai-image-wrapper:hover .nai-save-local-btn {
               opacity: 1;
           }

           /* 按钮高亮 */
           .nai-regenerate-btn:hover,
           .nai-upload-imgbb-btn:hover,
           .nai-save-local-btn:hover {
               background-color: rgba(0, 0, 0, 0.85);
               transform: scale(1.1);
           }

           /* --- Reddit App 样式 --- */
           .reddit-post-item {
               background-color: #fff;
               margin-bottom: 10px;
               padding: 10px 15px;
               cursor: pointer;
               display: flex;
               gap: 10px;
               border-bottom: 1px solid #eee;
           }

           .reddit-post-item:active {
               background-color: #f0f0f0;
           }

           .reddit-vote-box {
               display: flex;
               flex-direction: column;
               align-items: center;
               width: 30px;
               font-size: 12px;
               color: #1a1a1b;
               font-weight: 700;
           }

           .reddit-content-box {
               flex: 1;
               display: flex;
               flex-direction: column;
               gap: 5px;
               min-width: 0;
           }

           .reddit-meta {
               font-size: 11px;
               color: #787c7e;
               display: flex;
               align-items: center;
               gap: 5px;
           }

           .reddit-sub-icon {
               width: 16px;
               height: 16px;
               border-radius: 50%;
               background-color: #0079d3;
           }

           .reddit-title {
               font-size: 15px;
               font-weight: 600;
               color: #222;
               line-height: 1.4;
           }

           .reddit-preview-img {
               width: 100%;
               max-height: 200px;
               object-fit: cover;
               border-radius: 8px;
               border: 1px solid #edeff1;
               margin-top: 5px;
           }

           .reddit-forward-btn {
               margin-top: 8px;
               background-color: #f0f0f0;
               color: #555;
               border: none;
               border-radius: 20px;
               padding: 5px 12px;
               font-size: 12px;
               cursor: pointer;
               align-self: flex-start;
               display: flex;
               align-items: center;
               gap: 4px;
           }

           /* --- 聊天气泡中的精美 Reddit 卡片样式 --- */
           .message-bubble.is-reddit-card {
               flex: initial;
               min-width: auto;
           }

           .message-bubble.is-reddit-card .content {
               padding: 0;
               background: transparent !important;
               box-shadow: none;
           }

           .reddit-share-card {
               width: 240px;
               background-color: #ffffff;
               border-radius: 12px;
               overflow: hidden;
               border: 1px solid #e0e0e0;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
               cursor: pointer;
           }

           .reddit-card-header {
               padding: 8px 12px;
               background-color: #f8f9fa;
               display: flex;
               align-items: center;
               gap: 6px;
               border-bottom: 1px solid #eee;
           }

           .reddit-card-logo {
               width: 16px;
               height: 16px;
           }

           .reddit-card-sub {
               font-size: 11px;
               color: #1c1c1c;
               font-weight: 700;
           }

           .reddit-card-user {
               font-size: 11px;
               color: #787c7e;
           }

           .reddit-card-body {
               padding: 10px 12px;
           }

           .reddit-card-title {
               font-size: 14px;
               font-weight: 600;
               color: #222;
               margin-bottom: 8px;
               line-height: 1.4;
               display: -webkit-box;
               -webkit-line-clamp: 3;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }

           .reddit-card-img {
               width: 100%;
               height: 120px;
               object-fit: cover;
               border-radius: 4px;
               margin-bottom: 5px;
               background-color: #eee;
           }

           .reddit-card-footer {
               padding: 8px 12px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               border-top: 1px solid #f0f0f0;
               font-size: 11px;
               color: #878a8c;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #char-reddit-screen {
               background-color: #000;
           }

           #phone-screen.dark-mode #char-reddit-list {
               background-color: #121212;
           }

           #phone-screen.dark-mode .reddit-post-item {
               background-color: #1a1a1b;
               border-bottom-color: #343536;
           }

           #phone-screen.dark-mode .reddit-title {
               color: #d7dadc;
           }

           #phone-screen.dark-mode .reddit-share-card {
               background-color: #1a1a1b;
               border-color: #343536;
           }

           #phone-screen.dark-mode .reddit-card-header {
               background-color: #272729;
               border-bottom-color: #343536;
           }

           #phone-screen.dark-mode .reddit-card-sub {
               color: #d7dadc;
           }

           #phone-screen.dark-mode .reddit-card-title {
               color: #d7dadc;
           }

           #phone-screen.dark-mode .reddit-card-footer {
               border-top-color: #343536;
           }

           /* 暗黑模式适配 Reddit 详情 */
           #phone-screen.dark-mode #char-article-content h2 {
               color: #e0e0e0 !important;
           }

           #phone-screen.dark-mode #char-article-content div {
               color: #ccc !important;
           }

           #phone-screen.dark-mode .reddit-comment-item {
               border-bottom-color: #333 !important;
           }

           /* 绿江书籍卡片上的加入书架按钮 */
           .gr-add-shelf-btn {
               background: none;
               border: 1px solid var(--gr-primary);
               color: var(--gr-primary);
               border-radius: 12px;
               padding: 2px 8px;
               font-size: 11px;
               cursor: pointer;
               display: flex;
               align-items: center;
               gap: 4px;
               transition: all 0.2s;
               z-index: 2;
               /* 确保在卡片点击层之上 */
           }

           .gr-add-shelf-btn:hover {
               background-color: var(--gr-primary);
               color: white;
           }

           /* 已加入状态：实心背景，显示为已完成 */
           .gr-add-shelf-btn.added {
               background-color: rgba(0, 0, 0, 0.05);
               border-color: transparent;
               color: #888;
               cursor: pointer;
               /* 保持可点击 */
           }

           /* 已加入状态悬停：变成红色，提示移除 */
           .gr-add-shelf-btn.added:hover {
               background-color: #ffebee;
               color: #ff3b30;
               border-color: #ff3b30;
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .gr-add-shelf-btn.added {
               background-color: rgba(255, 255, 255, 0.1);
               color: #aaa;
           }

           #phone-screen.dark-mode .gr-add-shelf-btn.added:hover {
               background-color: rgba(255, 59, 48, 0.2);
               color: #ff453a;
               border-color: #ff453a;
           }

           /* ========================================= */
           /* ▼▼▼ 瑞士极简主义通知系统 (Swiss Toast) ▼▼▼ */
           /* ========================================= */

           .toast-container {
               position: fixed;
               top: 12px;
               /* 顶部留出状态栏呼吸感 */
               left: 50%;
               transform: translateX(-50%);
               z-index: 9999;
               display: flex;
               flex-direction: column;
               gap: 10px;
               pointer-events: none;
               /* 允许点击穿透 */
           }

           .toast-item {
               display: flex;
               align-items: center;
               gap: 12px;
               padding: 12px 20px 12px 16px;
               background-color: rgba(255, 255, 255, 0.92);
               /* 极高纯度的白 */
               backdrop-filter: blur(20px);
               /* 磨砂玻璃质感 */
               -webkit-backdrop-filter: blur(20px);
               border-radius: 50px;
               /* 完全胶囊状 */
               box-shadow:
                   0 4px 24px rgba(0, 0, 0, 0.06),
                   /* 弥散阴影 */
                   0 1px 2px rgba(0, 0, 0, 0.04),
                   /* 锐利阴影 */
                   inset 0 0 0 0.5px rgba(0, 0, 0, 0.05);
               /* 内描边代替边框 */
               font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
               font-size: 14px;
               font-weight: 500;
               color: #1d1d1f;
               /* 深炭灰，非纯黑 */
               opacity: 0;
               transform: translateY(-20px) scale(0.95);
               transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
               /* iOS 物理动效曲线 */
           }

           .toast-item.visible {
               opacity: 1;
               transform: translateY(0) scale(1);
           }

           .toast-icon {
               display: flex;
               align-items: center;
               justify-content: center;
               width: 20px;
               height: 20px;
               color: #0071e3;
               /* 苹果蓝 */
           }

           .toast-icon svg {
               width: 100%;
               height: 100%;
               stroke-width: 2;
           }

           /* 加载中动画 */
           .toast-icon.spinning svg {
               animation: toast-spin 1s linear infinite;
           }

           @keyframes toast-spin {
               from {
                   transform: rotate(0deg);
               }

               to {
                   transform: rotate(360deg);
               }
           }

           /* 暗黑模式适配 - 深邃而通透 */
           #phone-screen.dark-mode .toast-item {
               background-color: rgba(28, 28, 30, 0.92);
               color: #f5f5f7;
               box-shadow:
                   0 4px 24px rgba(0, 0, 0, 0.2),
                   inset 0 0 0 0.5px rgba(255, 255, 255, 0.1);
           }

           #phone-screen.dark-mode .toast-icon {
               color: #0a84ff;
           }

           /* ========================================= */
           /* ▼▼▼ 设置页面布局优化 (Spa Aesthetics) ▼▼▼ */
           /* ========================================= */

           /* 1. 增加呼吸感 */
           .settings-container {
               padding: 24px 20px !important;
               /* 增加整体内边距 */
           }

           /* 2. 卡片间距与质感 */
           .settings-section {
               margin-bottom: 24px !important;
               /* 卡片间距增大 */
               border-radius: 16px !important;
               /* 更圆润的角 */
               box-shadow: 0 2px 12px rgba(0, 0, 0, 0.02) !important;
               /* 极轻微的悬浮感 */
               border: 1px solid rgba(0, 0, 0, 0.03);
               /* 极其微妙的边界 */
               overflow: hidden !important;
           }

           /* 3. 列表项高度与分割线 */
           .settings-item,
           .settings-item-block {
               padding: 18px 20px !important;
               /* 增加单行高度，不仅是点击区域，更是视觉留白 */
               min-height: 56px !important;
               border-bottom: 1px solid rgba(0, 0, 0, 0.05) !important;
               /* 线条更细更淡 */
           }

           /* 4. 字体优化 */
           .settings-item label {
               font-size: 16px !important;
               font-weight: 500 !important;
               /* 略微加粗，提升层级 */
               letter-spacing: -0.01em;
               color: #1d1d1f !important;
           }

           .settings-header {
               font-size: 13px !important;
               font-weight: 600 !important;
               color: #86868b !important;
               /* 高级灰 */
               margin: 30px 0 10px 20px !important;
               /* 标题与卡片的距离 */
               text-transform: uppercase;
               letter-spacing: 0.05em;
           }

           /* 5. 暗黑模式微调 */
           #phone-screen.dark-mode .settings-section {
               border: 1px solid rgba(255, 255, 255, 0.05);
               background-color: #1c1c1e !important;
           }

           #phone-screen.dark-mode .settings-item {
               border-bottom-color: rgba(255, 255, 255, 0.08) !important;
           }

           #phone-screen.dark-mode .settings-item label {
               color: #f5f5f7 !important;
           }

           /* ========================================= */
           /* ▼▼▼ CPhone Browser 高端重构 (Swiss Style) ▼▼▼ */
           /* ========================================= */

           /* 1. 浏览器整体容器背景 */
           #char-browser-screen,
           #char-browser-article-screen {
               background-color: #F2F2F7 !important;
               /* iOS 高级灰底色 */
           }

           #phone-screen.dark-mode #char-browser-screen,
           #phone-screen.dark-mode #char-browser-article-screen {
               background-color: #000000 !important;
           }

           /* 2. 历史记录列表容器 */
           #char-browser-history {
               padding: 20px !important;
               /* 增加外边距，让内容呼吸 */
               display: flex;
               flex-direction: column;
               gap: 12px;
               /* 卡片之间的完美间距 */
           }

           /* 3. 单个历史记录卡片 */
           .char-browser-item {
               background-color: #FFFFFF;
               padding: 16px 20px !important;
               /* 内部留白 */
               border-radius: 12px;
               /* 现代感圆角 */
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
               /* 极轻微的悬浮感 */
               border: 1px solid rgba(0, 0, 0, 0.03);
               /* 几乎不可见的边界 */
               display: flex;
               align-items: center;
               gap: 16px;
               /* 图标与文字的间距 */
               transition: transform 0.1s, background-color 0.2s;
           }

           .char-browser-item:active {
               transform: scale(0.98);
               background-color: #F9F9F9;
           }

           /* 4. 列表项左侧图标容器 (替代 Emoji) */
           .char-browser-icon-box {
               width: 40px;
               height: 40px;
               border-radius: 10px;
               background-color: #F2F2F7;
               /* 浅灰背景衬托图标 */
               display: flex;
               align-items: center;
               justify-content: center;
               color: #007AFF;
               /* 瑞士蓝 Accent Color */
               flex-shrink: 0;
           }

           .char-browser-icon-box svg {
               width: 20px;
               height: 20px;
               stroke-width: 2;
           }

           /* 5. 列表项文字内容 */
           .char-browser-info {
               flex-grow: 1;
               overflow: hidden;
               display: flex;
               flex-direction: column;
               gap: 4px;
               /* 标题与URL的间距 */
           }

           .char-browser-item .title {
               font-size: 16px !important;
               font-weight: 600 !important;
               color: #1C1C1E;
               margin: 0 !important;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               letter-spacing: -0.01em;
           }

           .char-browser-item .url {
               font-size: 12px !important;
               color: #8E8E93 !important;
               /* 次要信息灰色 */
               font-weight: 400;
               font-family: -apple-system, BlinkMacSystemFont, "SF Mono", monospace;
               /* 网址用等宽字体更有科技感 */
           }

           /* 6. 列表项右侧箭头 */
           .char-browser-arrow {
               color: #C7C7CC;
               flex-shrink: 0;
           }

           /* 7. 文章详情页排版 (阅读体验优化) */
           #char-article-content {
               padding: 30px 24px !important;
               /* 宽敞的阅读边距 */
               background-color: #FFFFFF !important;
               /* 纯白阅读背景 */

               /* --- 修复开始 --- */
               /* 1. 删除或注释掉 min-height: 100%; */
               /* min-height: 100%; */

               /* 2. 添加 height: 0; 配合 flex-grow 使用，强制它在 flex 容器内滚动 */
               height: 0 !important;

               /* 3. 确保 flex 属性和滚动开启 */
               flex-grow: 1;
               overflow-y: auto !important;
               /* --- 修复结束 --- */
           }

           /* 文章标题 */
           #char-article-title {
               font-size: 17px !important;
               /* 导航栏标题大小 */
               font-weight: 600;
           }

           /* 文章正文容器内的大标题 (如果有) */
           .article-large-title {
               font-size: 24px;
               font-weight: 700;
               color: #1C1C1E;
               margin-bottom: 16px;
               line-height: 1.3;
               letter-spacing: -0.02em;
           }

           /* 文章正文文字 */
           #char-article-content p {
               font-size: 17px;
               /* 最佳阅读字号 */
               line-height: 1.6;
               /* 黄金比例行高 */
               color: #333333;
               margin-bottom: 20px;
               /* 段落间距 */
               text-align: justify;
               /* 两端对齐 */
           }

           /* 文章图片 */
           .char-browser-image-description {
               margin-top: 40px;
               padding: 40px 20px;
               background-color: #F9F9F9;
               border-radius: 12px;
               color: #666;
               font-style: italic;
               text-align: center;
               border: 1px dashed #E5E5E5;
           }

           /* --- 暗黑模式适配 --- */
           #phone-screen.dark-mode .char-browser-item {
               background-color: #1C1C1E;
               border-color: #333;
           }

           #phone-screen.dark-mode .char-browser-icon-box {
               background-color: #2C2C2E;
               color: #0A84FF;
           }

           #phone-screen.dark-mode .char-browser-item .title {
               color: #FFFFFF;
           }

           #phone-screen.dark-mode #char-article-content {
               background-color: #000000 !important;
           }

           #phone-screen.dark-mode .article-large-title {
               color: #FFFFFF;
           }

           #phone-screen.dark-mode #char-article-content p {
               color: #E0E0E0;
           }

           #phone-screen.dark-mode .char-browser-image-description {
               background-color: #1C1C1E;
               border-color: #333;
               color: #AAA;
           }

           /* ========================================= */
           /* ▼▼▼ CPhone 备忘录 & 日记 高端重构 ▼▼▼ */
           /* ========================================= */

           /* 1. 列表容器背景 */
           #char-memo-list,
           #char-diary-list {
               padding: 20px !important;
               /* 统一外边距 */
               display: flex;
               flex-direction: column;
               gap: 12px;
               /* 卡片间距 */
               background-color: #F2F2F7 !important;
               /* 统一底色 */
           }

           #phone-screen.dark-mode #char-memo-list,
           #phone-screen.dark-mode #char-diary-list {
               background-color: #000000 !important;
           }

           /* 2. 列表项卡片样式 */
           .memo-item,
           .diary-item {
               background-color: #FFFFFF;
               padding: 16px 20px !important;
               border-radius: 12px;
               /* 现代感圆角 */
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
               border: 1px solid rgba(0, 0, 0, 0.03);
               display: flex;
               align-items: center;
               gap: 16px;
               transition: transform 0.1s, background-color 0.2s;
               cursor: pointer;
               border-bottom: 1px solid rgba(0, 0, 0, 0.03) !important;
               /* 覆盖旧样式的边框 */
           }

           .memo-item:active,
           .diary-item:active {
               transform: scale(0.98);
               background-color: #F9F9F9;
           }

           /* 3. 图标容器 (左侧方形区域) */
           .cphone-item-icon-box {
               width: 42px;
               height: 42px;
               border-radius: 10px;
               /* iOS 风格圆角 */
               display: flex;
               align-items: center;
               justify-content: center;
               flex-shrink: 0;
           }

           .cphone-item-icon-box svg {
               width: 22px;
               height: 22px;
               stroke-width: 2;
           }

           /* 备忘录专属配色 (暖黄) */
           .memo-icon-style {
               background-color: #FFF8E1;
               /* 极淡黄底 */
               color: #FF9500;
               /* 活力橙黄 */
           }

           /* 日记专属配色 (清新绿) */
           .diary-icon-style {
               background-color: #E8F5E9;
               /* 极淡绿底 */
               color: #34C759;
               /* 苹果绿 */
           }

           /* 4. 中间文字区域 */
           .cphone-item-info {
               flex-grow: 1;
               overflow: hidden;
               display: flex;
               flex-direction: column;
               gap: 4px;
           }

           .cphone-item-title {
               font-size: 16px !important;
               font-weight: 600 !important;
               color: #1C1C1E;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               letter-spacing: -0.01em;
           }

           .cphone-item-preview {
               font-size: 13px !important;
               color: #8E8E93 !important;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               font-weight: 400;
               line-height: 1.3;
           }

           /* 5. 右侧元素 (箭头或时间) */
           .cphone-item-arrow {
               color: #C7C7CC;
               flex-shrink: 0;
           }

           /* --- 详情页重构 --- */

           /* 备忘录详情页 */
           #char-memo-detail-screen .form-container {
               padding: 20px !important;
               background-color: #F2F2F7 !important;
               height: 100%;
               box-sizing: border-box;
           }

           #char-memo-detail-content {
               background-color: #FFFFFF !important;
               border-radius: 12px;
               padding: 24px !important;
               font-size: 16px !important;
               line-height: 1.6 !important;
               color: #1C1C1E !important;
               box-shadow: 0 2px 12px rgba(0, 0, 0, 0.02);
               border: 1px solid rgba(0, 0, 0, 0.03);
               height: 100% !important;
               resize: none;
               outline: none;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
           }

           /* 日记详情页 */
           #char-diary-detail-screen {
               background-color: #F2F2F7 !important;
           }

           #char-diary-detail-content-wrapper {
               padding: 20px !important;
               background: transparent !important;
           }

           #char-diary-detail-content {
               /* 核心修复：强制高度自动，随文字撑开 */
               height: auto !important;

               /* 保持最小高度，内容少时也好看 */
               min-height: 80vh;

               /* 确保背景色和圆角完整包裹内容 */
               background-color: #FFFFFF !important;
               border-radius: 12px;

               /* 优化内边距 */
               padding: 32px 28px 60px 28px !important;
               /* 底部增加内边距，防止文字贴底 */

               /* 视觉样式 */
               box-shadow: 0 2px 15px rgba(0, 0, 0, 0.03);
               border: 1px solid rgba(0, 0, 0, 0.03);
               font-family: "Georgia", "Songti SC", serif !important;
               color: #333 !important;
               line-height: 1.8 !important;

               /* 防止宽度溢出 */
               width: 100%;
               box-sizing: border-box;
               overflow: visible !important;
           }

           /* 确保外层容器允许滚动且布局正确 */
           #char-diary-detail-content-wrapper {
               padding: 20px !important;
               background: transparent !important;
               overflow-y: auto !important;
               /* 确保竖向滚动条在 wrapper 上 */
               display: block !important;
               /* 防止 Flex 布局某些情况下压缩子元素高度 */
           }

           /* --- 暗黑模式适配 --- */
           #phone-screen.dark-mode .memo-item,
           #phone-screen.dark-mode .diary-item {
               background-color: #1C1C1E;
               border-color: #333;
           }

           #phone-screen.dark-mode .cphone-item-title {
               color: #FFFFFF;
           }

           #phone-screen.dark-mode .memo-icon-style {
               background-color: #332A15;
               /* 深黄背景 */
               color: #FFD60A;
           }

           #phone-screen.dark-mode .diary-icon-style {
               background-color: #1A3021;
               /* 深绿背景 */
               color: #30D158;
           }

           #phone-screen.dark-mode #char-memo-detail-screen .form-container,
           #phone-screen.dark-mode #char-diary-detail-screen {
               background-color: #000000 !important;
           }

           #phone-screen.dark-mode #char-memo-detail-content,
           #phone-screen.dark-mode #char-diary-detail-content {
               background-color: #1C1C1E !important;
               color: #E0E0E0 !important;
               border-color: #333;
           }

           #phone-screen.dark-mode #char-diary-detail-content>p:first-of-type {
               color: #FFFFFF !important;
               border-bottom-color: #333;
           }

           /* 1. 外层容器：营造沉浸式阅读环境 */
           #char-diary-detail-screen {
               background-color: #F2F2F7 !important;
               /* iOS 系统级浅灰背景，提供视觉支撑 */
           }

           #phone-screen.dark-mode #char-diary-detail-screen {
               background-color: #000000 !important;
           }

           /* 2. 滚动区域 */
           #char-diary-detail-content-wrapper {
               padding: 20px 16px !important;
               /* 移动端两侧留出合适的呼吸空间 */
               background: transparent !important;
               box-sizing: border-box;
           }

           /* 3. 日记纸张本体 (核心修改) */
           #char-diary-detail-content {
               background-color: #FFFFFF !important;
               border-radius: 16px;
               /* 更圆润、友好的圆角 */
               /* 移除显眼的边框，改用极轻柔的弥散阴影，营造悬浮感 */
               border: none !important;
               box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04);

               /* 内部留白：像高级杂志一样的排版 */
               padding: 32px 24px 48px 24px !important;

               /* 字体设置：回归系统原生，追求极致清晰 */
               font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Songti SC", serif !important;
               color: #1D1D1F !important;
               /* Apple 深炭灰，比纯黑更护眼 */

               min-height: 85vh;
               /* 保证纸张长度，即使内容少也不显得单薄 */
               box-sizing: border-box;
           }

           /* 4. 标题/日期 (您觉得太大的那个字) - 重构为“眉批”风格 */
           #char-diary-detail-content>p:first-of-type {
               /* 即使是标题，也不需要巨大。精致 > 巨大 */
               font-size: 15px !important;
               font-weight: 600 !important;
               color: #86868B !important;
               /* 使用高级中灰色，降低视觉干扰 */
               text-transform: uppercase;
               /* 增加一点形式感 */
               letter-spacing: 0.05em;
               /* 增加字间距，增加透气感 */

               margin-top: 0 !important;
               margin-bottom: 24px !important;
               /* 标题与正文的完美距离 */
               padding-bottom: 16px;
               border-bottom: 1px solid rgba(0, 0, 0, 0.05);
               /* 极细的分隔线 */
               text-align: left !important;
           }

           #char-diary-detail-content p {

               line-height: 1.6 !important;

               /* 核心修改：减小段落间距 */
               margin-bottom: 1px !important;
               /* 从 16px 减小到 8px，更加紧凑 */
               margin-top: 0 !important;
               /* 强制去除顶部间距，防止叠加 */

               text-align: justify;
               letter-spacing: -0.01em;
           }

           /* 6. 特殊格式修饰 (保持风格统一) */
           #char-diary-detail-content strong {
               font-weight: 600;
               color: #000;
           }

           /* 重点高亮：改为荧光笔风格，而非简单的背景色 */
           #char-diary-detail-content .diary-highlight {
               background: linear-gradient(120deg, rgba(255, 214, 10, 0.3) 0%, rgba(255, 214, 10, 0.3) 100%);
               background-position: 0 88%;
               background-size: 100% 0.4em;
               /* 只高亮下半部分 */
               background-repeat: no-repeat;
               padding: 0;
               border-radius: 0;
           }

           /* --- 暗黑模式适配 (深邃模式) --- */
           #phone-screen.dark-mode #char-diary-detail-content {
               background-color: #1C1C1E !important;
               /* 深灰卡片 */
               color: #F5F5F7 !important;
               /* 柔白文字 */
               box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2);
           }

           #phone-screen.dark-mode #char-diary-detail-content>p:first-of-type {
               color: #98989D !important;
               border-bottom-color: rgba(255, 255, 255, 0.1);
           }

           #phone-screen.dark-mode #char-diary-detail-content .diary-highlight {
               background: rgba(255, 214, 10, 0.2);
               /* 暗黑模式下改为全背景淡淡高亮 */
               background-size: 100% 100%;
               border-radius: 4px;
           }

           /* =================================================== */
           /* ▼▼▼ CPhone 终极固定布局 (仿 iOS 高级质感) ▼▼▼ */
           /* =================================================== */

           /* CPhone 翻页容器 */
           #cphone-pages-container {
               flex-grow: 1;
               width: 100%;
               overflow: hidden;
               position: relative;
           }

           #cphone-pages {
               display: flex;
               width: 200%;
               /* 两页 */
               height: 100%;
               transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }

           .cphone-page {
               width: 50%;
               /* 每页占50% */
               height: 100%;
               flex-shrink: 0;
           }

           /* CPhone 页面指示器 */
           .cphone-pagination {
               display: none;
               /* 隐藏页面指示器 */
               justify-content: center;
               gap: 8px;
               padding: 10px 0;
               position: absolute;
               bottom: 80px;
               left: 50%;
               transform: translateX(-50%);
               z-index: 10;
           }

           .cphone-pagination-dot {
               width: 8px;
               height: 8px;
               border-radius: 50%;
               background-color: rgba(255, 255, 255, 0.4);
               transition: all 0.3s ease;
               cursor: pointer;
           }

           .cphone-pagination-dot.active {
               background-color: white;
               transform: scale(1.2);
           }

           /* MyPhone 翻页容器 - 与CPhone完全一致 */
           #myphone-pages-container {
               flex-grow: 1;
               width: 100%;
               overflow: hidden;
               position: relative;
           }

           #myphone-pages {
               display: flex;
               width: 100%;
               /* MyPhone 暂时只有一页，所以是100% */
               height: 100%;
               transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }

           .myphone-page {
               width: 100%;
               /* 每页占100% */
               height: 100%;
               flex-shrink: 0;
           }

           #cphone-layout-container,
           #cphone-page-2-container,
           #myphone-layout-container {
               padding: 0 20px;
               display: flex;
               flex-direction: column;
               gap: 25px;
               /* 行与行之间的间距 */
               width: 100%;
               box-sizing: border-box;
               align-items: center;
               /* 整体居中 */
           }

           /* --- 通用行布局：左右排列 --- */
           .cphone-fixed-row {
               display: flex;
               justify-content: space-between;
               width: 100%;
               max-width: 340px;
               /* 限制最大宽度，防止在大屏上散开 */
           }

           /* --- 1. 顶部错落气泡 --- */
           .cphone-staggered-group {
               display: flex;
               flex-direction: column;
               gap: 12px;
               width: 100%;
               max-width: 340px;
           }

           .cphone-bubble-pill {
               width: 85%;
               /* 不占满，留出空隙显示错落感 */
               height: 55px;
               border-radius: 28px;
               padding: 5px 15px;
               display: flex;
               align-items: center;
               gap: 10px;
               box-sizing: border-box;

               /* 玻璃拟态 */
               background: rgba(255, 255, 255, 0.25);
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border: 1px solid rgba(255, 255, 255, 0.4);
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
               color: #fff;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
           }

           /* 左侧气泡靠左 */
           .cphone-bubble-pill.left {
               align-self: flex-start;
               border-bottom-left-radius: 4px;
               /* 稍微改变一点形状增加设计感 */
           }

           /* 右侧气泡靠右 */
           .cphone-bubble-pill.right {
               align-self: flex-end;
               flex-direction: row-reverse;
               /* 头像在右边 */
               border-top-right-radius: 4px;
           }

           .bubble-avatar {
               width: 40px;
               height: 40px;
               border-radius: 50%;
               border: 2px solid rgba(255, 255, 255, 0.8);
               object-fit: cover;
               flex-shrink: 0;
           }

           .bubble-content {
               flex-grow: 1;
               overflow: hidden;
           }

           .bubble-content p {
               margin: 0;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               font-size: 13px;
               font-weight: 500;
           }

           /* --- 2. 固定大小的 App 网格 (2x2) --- */
           .cphone-fixed-app-grid {
               width: 155px;
               /* 强制固定宽度！ */
               height: 155px;
               /* 强制固定高度！ */
               display: grid;
               grid-template-columns: 1fr 1fr;
               grid-template-rows: 1fr 1fr;
               gap: 10px 15px;
               /* 行间距10，列间距15 */
               justify-items: center;
               align-items: center;
           }

           /* 调整图标大小以适应紧凑布局 */
           .cphone-fixed-app-grid .app-icon.small {
               width: 60px;
               /* 限制整体点击区域 */
           }

           .cphone-fixed-app-grid .app-icon.small .icon-bg {
               width: 56px;
               height: 56px;
               border-radius: 14px;
               margin-bottom: 4px;
               /* 确保图标不会被拉伸 */
               min-width: 56px;
           }

           .cphone-fixed-app-grid .app-icon.small .label {
               font-size: 11px;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
           }

           /* --- 3. 堆叠拍立得组件 --- */
           .cphone-stack-polaroid-widget {
               width: 155px;
               /* 固定大小 */
               height: 155px;
               position: relative;
               /* 用于绝对定位子元素 */
           }

           .polaroid-stack-layer {
               width: 140px;
               height: 160px;
               background-color: #fff;
               position: absolute;
               top: 0;
               left: 50%;
               transform: translateX(-50%);
               padding: 8px 8px 25px 8px;
               /* 底部留白 */
               box-sizing: border-box;
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
               border-radius: 2px;
               transition: transform 0.3s ease;
           }

           /* 底层照片：旋转 */
           .polaroid-stack-layer.back {
               transform: translateX(-50%) rotate(-6deg);
               z-index: 1;
               background-color: #f0f0f0;
               /* 稍微暗一点 */
           }

           /* 顶层照片：稍微反向旋转 */
           .polaroid-stack-layer.front {
               transform: translateX(-50%) rotate(3deg) translateY(-5px);
               z-index: 2;
           }

           /* 悬停效果：散开 */
           .cphone-stack-polaroid-widget:hover .polaroid-stack-layer.back {
               transform: translateX(-65%) rotate(-12deg);
           }

           .cphone-stack-polaroid-widget:hover .polaroid-stack-layer.front {
               transform: translateX(-35%) rotate(8deg) scale(1.05);
           }

           .polaroid-inner {
               width: 100%;
               height: 100%;
               background: #eee;
               overflow: hidden;
           }

           .polaroid-inner img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           /* --- 4. 圆形组件 --- */
           .cphone-circle-widget-container {
               width: 155px;
               height: 155px;
               display: flex;
               flex-direction: column;
               align-items: center;
               justify-content: center;

               /* 背景板 */
               background: rgba(255, 255, 255, 0.15);
               backdrop-filter: blur(10px);
               border-radius: 24px;
               border: 1px solid rgba(255, 255, 255, 0.3);
           }

           .cphone-circle-widget {
               width: 80px;
               height: 80px;
               border-radius: 50%;
               overflow: hidden;
               border: 3px solid rgba(255, 255, 255, 0.9);
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
               margin-bottom: 8px;
           }

           .cphone-circle-widget img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           .circle-deco-text p {
               margin: 0;
               font-size: 12px;
               color: #fff;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
               font-family: "Georgia", serif;
               /* 衬线体更文艺 */
               font-style: italic;
           }

           .circle-deco-line {
               width: 30px;
               height: 2px;
               background: rgba(255, 255, 255, 0.6);
               margin: 4px auto 0 auto;
               border-radius: 2px;
           }

           /* --- Dock 栏优化 --- */
           .cphone-dock-container {
               padding: 0 15px;
               margin-bottom: calc(25px + env(safe-area-inset-bottom));
               margin-top: auto;
               width: 100%;
               box-sizing: border-box;
               display: flex;
               justify-content: center;
           }

           .cphone-dock.glass {
               background: rgba(40, 40, 40, 0.4);
               /* 深色半透明Dock，像iOS */
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border: 1px solid rgba(255, 255, 255, 0.1);
               border-radius: 32px;
               padding: 18px 20px;
               width: 100%;
               max-width: 340px;
               /* 限制Dock最大宽度 */
               display: flex;
               justify-content: space-between;
           }

           .cphone-dock .app-icon .icon-bg {
               width: 56px;
               height: 56px;
               border-radius: 14px;
               margin-bottom: 0;
               /* Dock里不要文字，所以不需要下边距 */
           }

           .cphone-dock .app-icon .label {
               display: none;
               /* 隐藏Dock文字 */
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .cphone-bubble-pill {
               background: rgba(0, 0, 0, 0.4);
               border-color: rgba(255, 255, 255, 0.1);
           }

           #phone-screen.dark-mode .polaroid-stack-layer {
               background-color: #333;
               /* 拍立得白边变黑 */
           }

           /* =================================================== */
           /* ▼▼▼ CPhone 高级固定布局 V3 (完美复刻版) ▼▼▼ */
           /* =================================================== */

           #cphone-layout-container {
               display: flex;
               flex-direction: column;
               align-items: center;
               /* 强制居中 */
               gap: 20px;
               width: 100%;
           }

           /* --- 1. 错落气泡组 --- */
           .cphone-staggered-group {
               display: flex;
               flex-direction: column;
               gap: 8px;
               /* 两个气泡之间的间距 */
               width: 330px;
               /* 锁定总宽度 */
           }

           .cphone-bubble-pill {
               width: 290px;
               /* 固定气泡长度 */
               height: 60px;
               /* 固定气泡高度 */
               border-radius: 30px;
               /* 胶囊形状 */
               display: flex;
               align-items: center;
               padding: 5px 8px;
               box-sizing: border-box;

               /* 玻璃质感复刻 */
               background: rgba(255, 255, 255, 0.25);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border: 1px solid rgba(255, 255, 255, 0.35);
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
               color: #fff;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
           }

           /* 上方气泡：靠左 */
           .cphone-bubble-pill.top {
               align-self: flex-start;
           }

           /* 下方气泡：靠右 */
           .cphone-bubble-pill.bottom {
               align-self: flex-end;
               justify-content: flex-end;
               /* 内容靠右 */
           }

           /* 头像容器 (带白边) */
           .bubble-avatar-container {
               width: 46px;
               height: 46px;
               border-radius: 50%;
               background: rgba(255, 255, 255, 0.6);
               display: flex;
               justify-content: center;
               align-items: center;
               flex-shrink: 0;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
           }

           .bubble-avatar-container img {
               width: 42px;
               height: 42px;
               border-radius: 50%;
               object-fit: cover;
           }

           /* 气泡文字内容区域 */
           .bubble-content {
               flex-grow: 1;
               display: flex;
               align-items: center;
               padding: 0 10px;
               gap: 5px;
               overflow: hidden;
           }

           .bubble-content.left-align {
               justify-content: flex-start;
           }

           .bubble-content.right-align {
               justify-content: flex-end;
               text-align: right;
           }

           .bubble-content p {
               margin: 0;
               font-size: 14px;
               font-weight: 500;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .bubble-deco-icon {
               font-size: 16px;
               opacity: 0.9;
           }

           /* --- 通用固定行 (锁死宽度) --- */
           .cphone-fixed-row {
               display: flex;
               justify-content: space-between;
               width: 330px;
               /* 锁死行宽 */
           }

           /* --- 2. App 网格 (2x2 固定) --- */
           .cphone-fixed-app-grid {
               width: 150px;
               height: 150px;
               display: grid;
               grid-template-columns: 1fr 1fr;
               grid-template-rows: 1fr 1fr;
               gap: 8px 15px;
               justify-items: center;
               align-items: start;
           }

           .app-icon.small .icon-bg {
               width: 54px;
               height: 54px;
               border-radius: 13px;
               margin-bottom: 3px;
               min-width: 54px;
               /* 防止压缩 */
           }

           .app-icon.small .label {
               font-size: 11px;
           }

           /* --- 3. 堆叠拍立得 (复刻) --- */
           .cphone-stack-polaroid {
               width: 150px;
               height: 150px;
               position: relative;
           }

           /* 底层照片 (倾斜) */
           .polaroid-bg-layer {
               width: 125px;
               height: 140px;
               background-color: #fff;
               position: absolute;
               top: 5px;
               left: 10px;
               transform: rotate(-6deg);
               box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
               border-radius: 3px;
               z-index: 1;
           }

           /* 顶层照片 (主图) */
           .polaroid-main-layer {
               width: 125px;
               height: 145px;
               background-color: #fff;
               position: absolute;
               top: 0;
               left: 15px;
               /* 稍微错位 */
               transform: rotate(3deg);
               box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
               border-radius: 3px;
               z-index: 2;
               padding: 8px 8px 25px 8px;
               /* 经典的拍立得留白 */
               box-sizing: border-box;
               transition: transform 0.2s;
           }

           .polaroid-main-layer:hover {
               transform: rotate(0deg) scale(1.05) translateY(-5px);
               z-index: 10;
           }

           .polaroid-photo-frame {
               width: 100%;
               height: 100%;
               background-color: #eee;
               overflow: hidden;
           }

           .polaroid-photo-frame img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           /* --- 4. 圆形组件 (复刻) --- */
           .cphone-circle-widget-wrapper {
               width: 150px;
               height: 150px;
               background: rgba(255, 255, 255, 0.2);
               backdrop-filter: blur(10px);
               border-radius: 24px;
               border: 1px solid rgba(255, 255, 255, 0.3);
               display: flex;
               flex-direction: column;
               align-items: center;
               justify-content: center;
               position: relative;
           }

           .cphone-circle-bg {
               width: 75px;
               height: 75px;
               border-radius: 50%;
               overflow: hidden;
               border: 3px solid rgba(255, 255, 255, 0.9);
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
               margin-bottom: 8px;
           }

           .cphone-circle-bg img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           .circle-text-area p {
               margin: 0;
               font-size: 12px;
               color: #fff;
               font-family: "Georgia", serif;
               font-style: italic;
               text-align: center;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
           }

           .line-deco {
               width: 40px;
               height: 2px;
               background: rgba(255, 255, 255, 0.5);
               margin: 4px auto 0 auto;
               border-radius: 2px;
               position: relative;
           }

           /* 加两个小点在装饰线两端 */
           .line-deco::before,
           .line-deco::after {
               content: '';
               position: absolute;
               width: 4px;
               height: 4px;
               background: white;
               border-radius: 50%;
               top: -1px;
           }

           .line-deco::before {
               left: -2px;
           }

           .line-deco::after {
               right: -2px;
           }

           /* --- Dock 栏 (保持不变但确保宽度) --- */
           .cphone-dock-container {
               padding: 0;
               margin-top: auto;
               margin-bottom: calc(25px + env(safe-area-inset-bottom));
               width: 100%;
               display: flex;
               justify-content: center;
           }

           .cphone-dock {
               width: 330px;
               /* 锁死宽度 */
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode .cphone-bubble-pill,
           #phone-screen.dark-mode .cphone-circle-widget-wrapper {
               background: rgba(0, 0, 0, 0.4);
               border-color: rgba(255, 255, 255, 0.1);
           }

           #phone-screen.dark-mode .polaroid-bg-layer,
           #phone-screen.dark-mode .polaroid-main-layer {
               background-color: #2c2c2e;
           }

           /* --- 1. 错落气泡组 (带倾斜) --- */
           .cphone-staggered-group {
               display: flex;
               flex-direction: column;
               /* gap: 8px;  <-- 移除这个 gap，改用 margin 控制 */
               width: 330px;
               padding: 10px 0;
               /* 增加上下内边距，给倾斜留空间 */
           }

           .cphone-bubble-pill {
               width: 290px;
               height: 60px;
               border-radius: 30px;
               display: flex;
               align-items: center;
               padding: 5px 8px;
               box-sizing: border-box;

               /* 玻璃质感 */
               background: rgba(255, 255, 255, 0.25);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border: 1px solid rgba(255, 255, 255, 0.35);
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
               color: #fff;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);

               /* 让旋转更平滑 */
               transform-origin: center center;
               backface-visibility: hidden;
           }

           /* 上方气泡：靠左 + 向上倾斜 */
           .cphone-bubble-pill.top {
               align-self: flex-start;
               transform: rotate(-3deg);
               /* 关键：旋转角度 */
               margin-bottom: -8px;
               /* 向上拉近距离 */
               z-index: 2;
               /* 稍微叠在上面一点 */
           }

           /* 下方气泡：靠右 + 向下倾斜 */
           .cphone-bubble-pill.bottom {
               align-self: flex-end;
               justify-content: flex-end;
               transform: rotate(2deg);
               /* 关键：旋转角度 */
               margin-top: -5px;
               z-index: 1;
           }

           /* ... (头像容器部分保持不变) ... */
           .bubble-avatar-container {
               width: 46px;
               height: 46px;
               border-radius: 50%;
               background: rgba(255, 255, 255, 0.6);
               display: flex;
               justify-content: center;
               align-items: center;
               flex-shrink: 0;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
           }

           .bubble-avatar-container img {
               width: 42px;
               height: 42px;
               border-radius: 50%;
               object-fit: cover;
           }

           /* 气泡文字内容区域 */
           .bubble-content {
               flex-grow: 1;
               display: flex;
               align-items: center;
               padding: 0 10px;
               gap: 5px;
               overflow: hidden;
               cursor: text;
               /* 鼠标放上去显示可输入状态 */
           }

           /* 编辑时的输入框样式 */
           .bubble-edit-input {
               background: rgba(255, 255, 255, 0.2);
               border: none;
               border-radius: 4px;
               color: #fff;
               padding: 4px;
               width: 100%;
               outline: none;
               text-shadow: none;
           }

           /* =================================================== */
           /* ▼▼▼ CPhone 布局修正 V4 (倾斜+外框+编辑修复) ▼▼▼ */
           /* =================================================== */

           #cphone-layout-container {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 20px;
               width: 100%;
           }

           /* --- 1. 顶部气泡 (倾斜修正) --- */
           .cphone-staggered-group {
               display: flex;
               flex-direction: column;
               width: 330px;
               /* 给旋转留出上下空间，防止被切掉 */
               padding: 15px 0;
               position: relative;
           }

           .cphone-bubble-pill {
               width: 290px;
               height: 60px;
               border-radius: 35px;
               /* 更圆润 */
               display: flex;
               align-items: center;
               padding: 5px 8px;
               box-sizing: border-box;

               /* 玻璃质感 */
               background: rgba(255, 255, 255, 0.25);
               backdrop-filter: blur(15px);
               -webkit-backdrop-filter: blur(15px);
               border: 1px solid rgba(255, 255, 255, 0.4);
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
               color: #fff;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);

               /* 核心：旋转基点 */
               transform-origin: center;
               transition: transform 0.3s ease;
           }

           /* 上方气泡：向左上倾斜 (-3度) */
           .cphone-bubble-pill.top {
               align-self: flex-start;
               transform: rotate(-3deg);
               margin-bottom: -10px;
               /* 拉近距离 */
               z-index: 2;
               margin-left: 5px;
           }

           /* 下方气泡：向右下倾斜 (2度) */
           .cphone-bubble-pill.bottom {
               align-self: flex-end;
               justify-content: flex-end;
               /* 内容靠右 */
               transform: rotate(2deg);
               margin-top: -5px;
               z-index: 1;
               margin-right: 5px;
           }

           /* 编辑时的输入框样式 (修复文字无法修改的问题) */
           .bubble-edit-input {
               background: rgba(0, 0, 0, 0.1);
               border: none;
               border-radius: 4px;
               color: #fff;
               padding: 2px 5px;
               font-size: inherit;
               font-family: inherit;
               width: 100%;
               outline: none;
           }

           /* 头像容器 */
           .bubble-avatar-container {
               width: 48px;
               height: 48px;
               border-radius: 50%;
               background: rgba(255, 255, 255, 0.7);
               /* 半透明白底 */
               display: flex;
               justify-content: center;
               align-items: center;
               flex-shrink: 0;
               box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
               border: 1px solid rgba(255, 255, 255, 0.8);
           }

           .bubble-avatar-container img {
               width: 44px;
               height: 44px;
               border-radius: 50%;
               object-fit: cover;
           }

           /* 文字区域 */
           .bubble-content {
               flex-grow: 1;
               display: flex;
               align-items: center;
               padding: 0 12px;
               gap: 6px;
               overflow: hidden;
               cursor: text;
               /* 提示可编辑 */
           }

           .bubble-content.left-align {
               justify-content: flex-start;
           }

           .bubble-content.right-align {
               justify-content: flex-end;
               text-align: right;
           }

           .bubble-content p {
               margin: 0;
               font-size: 14px;
               font-weight: 500;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
               pointer-events: none;
               /* 让点击穿透到父容器，触发onclick */
           }

           .bubble-deco-icon {
               font-size: 14px;
               opacity: 0.9;
           }

           /* --- 2. App 网格 (保持固定) --- */
           .cphone-fixed-row {
               display: flex;
               justify-content: space-between;
               width: 330px;
           }

           .cphone-fixed-app-grid {
               width: 150px;
               height: 150px;
               display: grid;
               grid-template-columns: 1fr 1fr;
               grid-template-rows: 1fr 1fr;
               gap: 8px 15px;
               justify-items: center;
               align-items: start;
           }

           .app-icon.small .icon-bg {
               width: 54px;
               height: 54px;
               border-radius: 13px;
               margin-bottom: 3px;
               min-width: 54px;
           }

           .app-icon.small .label {
               font-size: 11px;
           }

           /* --- 3. 拍立得 (保持堆叠) --- */
           .cphone-stack-polaroid {
               width: 150px;
               height: 150px;
               position: relative;
           }

           .polaroid-bg-layer {
               width: 125px;
               height: 140px;
               background-color: #f5f5f5;
               position: absolute;
               top: 5px;
               left: 10px;
               transform: rotate(-6deg);
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
               border-radius: 2px;
               z-index: 1;
               border: 1px solid #eee;
           }

           .polaroid-main-layer {
               width: 125px;
               height: 145px;
               background-color: #fff;
               position: absolute;
               top: 0;
               left: 15px;
               transform: rotate(4deg);
               box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
               border-radius: 2px;
               z-index: 2;
               padding: 8px 8px 25px 8px;
               box-sizing: border-box;
               transition: transform 0.2s;
           }

           .polaroid-main-layer:hover {
               transform: rotate(0deg) scale(1.05) translateY(-5px);
               z-index: 10;
           }

           .polaroid-photo-frame {
               width: 100%;
               height: 100%;
               background-color: #eee;
               overflow: hidden;
           }

           .polaroid-photo-frame img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           /* --- 4. 圆形组件 (外框修复) --- */
           .cphone-circle-widget-wrapper {
               width: 150px;
               height: 150px;
               background: rgba(255, 255, 255, 0.2);
               backdrop-filter: blur(10px);
               border-radius: 24px;
               border: 1px solid rgba(255, 255, 255, 0.3);
               display: flex;
               flex-direction: column;
               align-items: center;
               justify-content: center;
           }

           /* 【修复】圆形图片的外框 */
           .cphone-circle-bg {
               width: 75px;
               height: 75px;
               border-radius: 50%;
               overflow: hidden;
               /* 这里加粗了边框，并且使用了纯白色 */
               border: 3px solid #ffffff;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
               /* 增加阴影让白边更明显 */
               margin-bottom: 8px;
               background-color: #fff;
           }

           .cphone-circle-bg img {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           .circle-text-area p {
               margin: 0;
               font-size: 12px;
               color: #fff;
               font-family: "Georgia", serif;
               font-style: italic;
               text-align: center;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
           }

           .line-deco {
               width: 30px;
               height: 2px;
               background: rgba(255, 255, 255, 0.8);
               margin: 5px auto 0 auto;
               border-radius: 2px;
               position: relative;
           }

           .line-deco::before,
           .line-deco::after {
               content: '';
               position: absolute;
               width: 4px;
               height: 4px;
               background: white;
               border-radius: 50%;
               top: -1px;
           }

           .line-deco::before {
               left: -3px;
           }

           .line-deco::after {
               right: -3px;
           }

           /* --- Dock --- */
           .cphone-dock-container {
               padding: 0;
               margin-top: auto;
               margin-bottom: calc(25px + env(safe-area-inset-bottom));
               width: 100%;
               display: flex;
               justify-content: center;
           }

           .cphone-dock {
               width: 330px;
           }

           /* 暗黑模式 */
           #phone-screen.dark-mode .cphone-bubble-pill,
           #phone-screen.dark-mode .cphone-circle-widget-wrapper {
               background: rgba(0, 0, 0, 0.4);
               border-color: rgba(255, 255, 255, 0.1);
           }

           #phone-screen.dark-mode .cphone-circle-bg {
               border-color: rgba(255, 255, 255, 0.8);
               /* 暗黑模式下稍微暗一点的白 */
           }

           /* ================================================== */
           /* ▼▼▼ CPhone 界面统一化修复补丁 (去除外框 + 放大图标) ▼▼▼ */
           /* ================================================== */

           /* 1. 【左侧组件】去除圆形组件的"丑"外框 */
           .cphone-circle-widget-wrapper {
               background: transparent !important;
               /* 去掉背景色 */
               border: none !important;
               /* 去掉边框线 */
               backdrop-filter: none !important;
               /* 去掉磨砂玻璃 */
               -webkit-backdrop-filter: none !important;
               box-shadow: none !important;
               /* 去掉阴影 */
           }

           /* 优化去除外框后的文字显示 (加强阴影，防止看不清) */
           .circle-text-area p {
               text-shadow: 0 1px 4px rgba(0, 0, 0, 0.8) !important;
               font-weight: 500 !important;
           }

           /* 去除装饰线 (既然不要框了，装饰线悬空会很怪) */
           .line-deco {
               display: none !important;
           }

           /* 2. 【图标大小】放大 CPhone 图标 (对齐 EPhone) */
           /* 调整网格间距，给大图标腾出空间 */
           .cphone-fixed-app-grid {
               gap: 2px 15px !important;
               /* 减小行间距 */
           }

           /* 强制放大图标背景 */
           .app-icon.small .icon-bg {
               width: 62px !important;
               /* 原为 54px -> 改为 62px */
               height: 62px !important;
               min-width: 62px !important;
               border-radius: 16px !important;
               /* 稍微圆润一点 */
               margin-bottom: 5px !important;
           }

           /* 3. 【字体统一】修正 CPhone 字体颜色和大小 */
           .app-icon.small .label {
               font-size: 13px !important;
               /* 原为 11px -> 改为 EPhone 标准的 13px */
               color: #ffffff !important;
               /* 纯白文字 */
               font-weight: 500 !important;
               /* 统一使用 EPhone 的强阴影，保证在亮色壁纸上也清晰 */
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6) !important;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
           }

           /* 4. 【Dock栏】改为 EPhone 风格 (浅色透明) */
           .cphone-dock.glass {
               /* 原为深灰色 rgba(40, 40, 40, 0.4) -> 改为浅白透明 */
               background: rgba(255, 255, 255, 0.2) !important;
               border: 1px solid rgba(255, 255, 255, 0.2) !important;
               backdrop-filter: blur(20px) !important;
               -webkit-backdrop-filter: blur(20px) !important;
               /* 稍微调整圆角，使其不那么圆，更像 EPhone 的 Dock */
               border-radius: 24px !important;
           }

           /* 5. 【Dock图标】确保 Dock 里的图标也够大 */
           .cphone-dock .app-icon .icon-bg {
               width: 60px !important;
               height: 60px !important;
           }

           /* --- 暗黑模式下的适配修正 --- */
           #phone-screen.dark-mode .cphone-dock.glass {
               /* 暗黑模式下稍微深一点，但保持通透 */
               background: rgba(50, 50, 50, 0.4) !important;
               border-color: rgba(255, 255, 255, 0.1) !important;
           }

           /* ================================================== */
           /* ▼▼▼ CPhone 界面统一化修复补丁 (去除外框 + 放大图标) ▼▼▼ */
           /* ================================================== */

           /* 1. 【左侧组件】去除圆形组件的"丑"外框 */
           .cphone-circle-widget-wrapper {
               background: transparent !important;
               /* 去掉背景色 */
               border: none !important;
               /* 去掉边框线 */
               backdrop-filter: none !important;
               /* 去掉磨砂玻璃 */
               -webkit-backdrop-filter: none !important;
               box-shadow: none !important;
               /* 去掉阴影 */
           }

           /* 优化去除外框后的文字显示 (加强阴影，防止看不清) */
           .circle-text-area p {
               text-shadow: 0 1px 4px rgba(0, 0, 0, 0.8) !important;
               font-weight: 500 !important;
           }

           /* 去除装饰线 (既然不要框了，装饰线悬空会很怪) */
           .line-deco {
               display: none !important;
           }

           /* 2. 【图标大小】放大 CPhone 图标 (对齐 EPhone) */
           /* 调整网格间距，给大图标腾出空间 */
           .cphone-fixed-app-grid {
               gap: 2px 15px !important;
               /* 减小行间距 */
           }

           /* 强制放大图标背景 */
           .app-icon.small .icon-bg {
               width: 62px !important;
               /* 原为 54px -> 改为 62px */
               height: 62px !important;
               min-width: 62px !important;
               border-radius: 16px !important;
               /* 稍微圆润一点 */
               margin-bottom: 5px !important;
           }

           /* 3. 【字体统一】修正 CPhone 字体颜色和大小 */
           .app-icon.small .label {
               font-size: 13px !important;
               /* 原为 11px -> 改为 EPhone 标准的 13px */
               color: #ffffff !important;
               /* 纯白文字 */
               font-weight: 500 !important;
               /* 统一使用 EPhone 的强阴影，保证在亮色壁纸上也清晰 */
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6) !important;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
           }

           /* 4. 【Dock栏】改为 EPhone 风格 (浅色透明) */
           .cphone-dock.glass {
               /* 原为深灰色 rgba(40, 40, 40, 0.4) -> 改为浅白透明 */
               background: rgba(255, 255, 255, 0.2) !important;
               border: 1px solid rgba(255, 255, 255, 0.2) !important;
               backdrop-filter: blur(20px) !important;
               -webkit-backdrop-filter: blur(20px) !important;
               /* 稍微调整圆角，使其不那么圆，更像 EPhone 的 Dock */
               border-radius: 24px !important;
           }

           /* 5. 【Dock图标】确保 Dock 里的图标也够大 */
           .cphone-dock .app-icon .icon-bg {
               width: 60px !important;
               height: 60px !important;
           }

           /* --- 暗黑模式下的适配修正 --- */
           #phone-screen.dark-mode .cphone-dock.glass {
               /* 暗黑模式下稍微深一点，但保持通透 */
               background: rgba(50, 50, 50, 0.4) !important;
               border-color: rgba(255, 255, 255, 0.1) !important;
           }

           /* ========================================================= */
           /* ▼▼▼ CPhone 布局微调补丁 V2 (气泡对齐 + 圆形下移) ▼▼▼ */
           /* ========================================================= */

           /* 1. 【圆形组件】位置下移修正 */
           .cphone-circle-widget-wrapper {
               /* 原来是靠顶对齐，现在往下推 30px，视觉上更平衡 */
               margin-top: 30px !important;

               /* 既然去掉了外框，确保它是透明的 */
               background: transparent !important;
               border: none !important;
               backdrop-filter: none !important;
               -webkit-backdrop-filter: none !important;
               box-shadow: none !important;
           }

           /* 2. 【第一行气泡】容器调整 */
           .cphone-staggered-group {
               width: 100% !important;
               /* 占满整行 */
               max-width: 360px !important;
               /* 限制最大宽 */
               padding: 10px 5px !important;
               /* 左右留点呼吸空间 */
               box-sizing: border-box !important;
               display: flex !important;
               flex-direction: column !important;
               /* 去掉 gap，完全靠 margin 控制位置 */
               gap: 0 !important;
           }

           /* 3. 【上方气泡】严格左对齐 + 向左上倾斜 */
           .cphone-bubble-pill.top {
               /* 稍微缩短宽度，让“靠左”更明显 */
               width: 275px !important;

               /* 核心对齐代码 */
               align-self: flex-start !important;
               margin-right: auto !important;
               /* 强制把右边空出来 */
               margin-left: 5px !important;
               /* 离左边缘一点点距离 */

               /* 倾斜与重叠控制 */
               transform: rotate(-3deg) !important;
               margin-bottom: -10px !important;
               /* 只是轻微重叠，不再是大面积重合 */
               z-index: 2 !important;
               /* 压在下面那个上面 */
           }

           /* 4. 【下方气泡】严格右对齐 + 向右下倾斜 */
           .cphone-bubble-pill.bottom {
               /* 宽度保持一致 */
               width: 275px !important;

               /* 核心对齐代码 */
               align-self: flex-end !important;
               margin-left: auto !important;
               /* 强制把左边空出来 */
               margin-right: 5px !important;
               /* 离右边缘一点点距离 */

               /* 倾斜与重叠控制 */
               transform: rotate(2deg) !important;
               margin-top: 0 !important;
               z-index: 1 !important;
           }

           /* 5. 确保气泡内的文字能完整显示 */
           .bubble-content {
               /* 修复可能被压缩的问题 */
               flex-shrink: 1 !important;
               min-width: 0 !important;
           }

           /* ================================================================= */
           /* ▼▼▼ Swiss Style 终极版式修正 (Steve Jobs Approved) ▼▼▼ */
           /* ================================================================= */

           /* --- 1. 全局布局容器：增加呼吸感 --- */
           #cphone-layout-container {
               display: flex;
               flex-direction: column;
               align-items: center;
               width: 100%;
               /* 增加垂直间距，这就是“数千美元”的高级感来源 */
               gap: 35px !important;
               padding-top: 10px;
               /* 稍微往下压一点，不顶头 */
           }

           /* 统一所有行的宽度，确保视觉边缘垂直对齐 */
           .cphone-staggered-group,
           .cphone-fixed-row,
           .cphone-dock {
               width: 330px !important;
               /* 黄金宽度，适配大部分手机屏 */
               max-width: 100% !important;
           }

           /* --- 2. 错落气泡：精准对齐算法 --- */
           .cphone-staggered-group {
               padding: 5px 0 !important;
               gap: 0 !important;
               /* 重叠由 margin 控制 */
               position: relative;
               /* 确保容器本身不裁剪阴影 */
               overflow: visible !important;
           }

           .cphone-bubble-pill {
               /* 稍微缩短宽度，为旋转留出余量，防止视觉溢出 */
               width: 285px !important;
               height: 58px !important;
               border-radius: 29px !important;

               /* 玻璃质感增强：更通透 */
               background: rgba(255, 255, 255, 0.2) !important;
               backdrop-filter: blur(25px) !important;
               -webkit-backdrop-filter: blur(25px) !important;
               border: 1px solid rgba(255, 255, 255, 0.25) !important;
               box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05) !important;
           }

           /* 上方气泡：左对齐 + 绕左侧旋转 */
           .cphone-bubble-pill.top {
               align-self: flex-start !important;
               /* 物理靠左 */
               margin-right: auto !important;

               /* 核心：轴心设在左侧，旋转时左边不动，右边翘起 */
               transform-origin: center left !important;
               transform: rotate(-4deg) translateY(0px) !important;

               margin-bottom: -18px !important;
               /* 向下挤压，创造层叠感 */
               margin-left: 2px !important;
               /* 微调视觉边缘 */
               z-index: 2;
           }

           /* 下方气泡：右对齐 + 绕右侧旋转 */
           .cphone-bubble-pill.bottom {
               align-self: flex-end !important;
               /* 物理靠右 */
               margin-left: auto !important;

               /* 核心：轴心设在右侧，旋转时右边不动，左边垂下 */
               transform-origin: center right !important;
               transform: rotate(3deg) translateY(0px) !important;

               margin-top: 0 !important;
               margin-right: 2px !important;
               /* 微调视觉边缘 */
               z-index: 1;
           }

           /* --- 3. 圆形组件文字优化：增加间距 --- */
           .cphone-circle-widget-wrapper {
               /* 移除背景和边框，保持透明 */
               background: transparent !important;
               border: none !important;
               backdrop-filter: none !important;
               -webkit-backdrop-filter: none !important;
               box-shadow: none !important;

               /* 垂直布局 */
               display: flex;
               flex-direction: column;
               align-items: center;
               justify-content: center;
           }

           .cphone-circle-bg {
               /* 图片容器 */
               margin-bottom: 0 !important;
               /* 移除旧边距，由 text-area 的 margin-top 控制 */
           }

           .circle-text-area {
               /* 开启 Flex 布局来控制两行字的间距 */
               display: flex !important;
               flex-direction: column !important;
               align-items: center !important;

               /* 这里控制两行文字中间的距离，这就是你要的 */
               gap: 6px !important;

               /* 控制文字整体与圆图的距离 */
               margin-top: 15px !important;
           }

           /* 第一行字：主标题 */
           #cphone-circle-text {
               font-size: 15px !important;
               font-weight: 600 !important;
               letter-spacing: 0.5px !important;
               /* 字间距微调 */
               color: #ffffff !important;
               text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5) !important;
               line-height: 1 !important;
               margin: 0 !important;
           }

           /* 第二行字：副标题 */
           #cphone-circle-subtext {
               font-size: 12px !important;
               font-weight: 400 !important;
               opacity: 0.85 !important;
               color: #ffffff !important;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
               font-family: "Georgia", serif !important;
               /* 衬线体，优雅 */
               font-style: italic !important;
               line-height: 1 !important;
               margin: 0 !important;
           }

           /* --- 4. 再次确保图标大小统一 (防止被覆盖) --- */
           .cphone-fixed-app-grid {
               gap: 8px 15px !important;
               /* 微调网格间距 */
           }

           .app-icon.small .icon-bg {
               width: 62px !important;
               height: 62px !important;
               min-width: 62px !important;
               border-radius: 15px !important;
               /* iOS 标准圆角 */
               box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1) !important;
           }

           .app-icon.small .label {
               margin-top: 4px !important;
               font-size: 12px !important;
               font-weight: 500 !important;
               color: #ffffff !important;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
           }

           /* --- 5. 拍立得堆叠优化 (右侧组件) --- */
           /* 让拍立得也稍微倾斜一点点，增加随意感 */
           .cphone-stack-polaroid {
               transform: rotate(2deg);
           }


           /* --- CPhone 气泡：强制对齐复刻版 --- */

           /* 1. 容器：强制居中，锁死宽度 */
           .cphone-staggered-group {
               display: flex !important;
               flex-direction: column !important;
               align-items: center !important;
               /* 核心：垂直居中对齐 */
               width: 330px !important;
               /* 核心：固定宽度 */
               margin: 0 auto !important;
               padding: 10px 0 !important;
               gap: 0 !important;
               /* 去掉间隙，用 margin 控制堆叠 */
           }

           /* 2. 气泡通用：填满容器，保持一致 */
           .cphone-bubble-pill {
               width: 100% !important;
               /* 强制占满 330px，保证上下一样宽 */
               height: 60px !important;
               border-radius: 35px !important;
               /* 更圆润一点 */
               box-sizing: border-box !important;
               transition: transform 0.3s ease !important;

               /* 核心：全部绕中心旋转，保证不会歪到没边 */
               transform-origin: center center !important;
           }

           /* 3. 上方气泡：左低右高 (-3deg) */
           .cphone-bubble-pill.top {
               align-self: center !important;
               /* 强制居中，不要靠左 */
               transform: rotate(-3deg) !important;

               margin-bottom: -12px !important;
               /* 向下挤压，产生堆叠感 */
               z-index: 2 !important;
               /* 压在下面那个上面 */

               /* 清除旧的干扰 */
               margin-left: 0 !important;
               margin-right: 0 !important;
           }

           /* 4. 下方气泡：同样左低右高 (-3deg)，保持平行 */
           /* 根据原图，它们是平行的，这样视觉上最整齐 */
           .cphone-bubble-pill.bottom {
               align-self: center !important;
               /* 强制居中，不要靠右 */
               transform: rotate(-3deg) !important;

               margin-top: 0 !important;
               z-index: 1 !important;

               /* 清除旧的干扰 */
               margin-left: 0 !important;
               margin-right: 0 !important;
           }

           /* 5. 修复 Dock 栏文字显示 */
           .cphone-dock .app-icon .label {
               display: block !important;
               margin-top: 4px !important;
               font-size: 11px !important;
               font-weight: 500 !important;
               color: #ffffff !important;
               text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6) !important;
               text-align: center !important;
           }

           /* --- CPhone 气泡：居中对齐 + 反向倾斜 + 增加间距版 --- */

           /* 1. 容器：控制整体间距 */
           .cphone-staggered-group {
               display: flex !important;
               flex-direction: column !important;
               align-items: center !important;
               /* 垂直居中 */
               width: 330px !important;
               margin: 0 auto !important;
               padding: 10px 0 !important;

               /* 【关键修改 1】增加气泡之间的物理间距 */
               gap: 5px !important;
           }

           /* 2. 气泡通用设置 */
           .cphone-bubble-pill {
               width: 100% !important;
               height: 60px !important;
               border-radius: 35px !important;
               box-sizing: border-box !important;
               transition: transform 0.3s ease !important;
               transform-origin: center center !important;
           }

           /* 3. 上方气泡：左低右高 (-3deg) */
           .cphone-bubble-pill.top {
               align-self: center !important;
               transform: rotate(-3deg) !important;

               /* 【关键修改 2】移除负边距，不再挤压 */
               margin-bottom: 0 !important;

               z-index: 2 !important;
               margin-left: 0 !important;
               margin-right: 0 !important;
           }

           /* 4. 下方气泡：左高右低 (3deg) */
           .cphone-bubble-pill.bottom {
               align-self: center !important;
               transform: rotate(3deg) !important;

               margin-top: 0 !important;
               z-index: 1 !important;
               margin-left: 0 !important;
               margin-right: 0 !important;
           }

           /* 5. 确保Dock文字显示 */
           .cphone-dock .app-icon .label {
               display: block !important;
           }

           /* --- CPhone 全局布局调整：紧凑版 --- */

           #cphone-layout-container {
               display: flex;
               flex-direction: column;
               align-items: center;
               width: 100%;

               /* 【关键修改】减小行与行之间的间距 */
               /* 原来是 35px，现在改为 10px，立刻变紧凑 */
               gap: 35px !important;

               /* 顶部稍微留一点点呼吸空间，防止气泡顶到刘海 */
               padding-top: 15px !important;
           }

           /* 确保错落气泡组本身没有多余的外部边距 */
           .cphone-staggered-group {
               margin-bottom: 0 !important;
               padding-bottom: 5px !important;
               /* 稍微减小一点底部内边距 */
           }

           .cphone-dock-container {
               /* 核心修改：移除 env() 计算，直接使用固定数值 */
               /* 20px 是比较标准的距离，如果您想让它更靠下，可以改为 10px */
               margin-bottom: 20px !important;

               /* 确保没有额外的底部内边距干扰 */
               padding-bottom: 0 !important;

               /* 确保它是通过 margin-top: auto 被推到底部的 (保持原有逻辑) */
               margin-top: auto !important;
           }

           /* 如果您开启了【手机外框模式】，可能需要稍微抬高一点点防止贴边太紧 */
           body.frame-mode-active .cphone-dock-container {
               margin-bottom: 25px !important;
           }

           .nai-binding-checkbox {
               width: 20px;
               height: 20px;
               border: 2px solid #ccc;
               border-radius: 50%;
               /* 圆形 */
               appearance: none;
               -webkit-appearance: none;
               transition: all 0.2s;
               position: relative;
               cursor: pointer;
           }

           .nai-binding-checkbox:checked {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           .nai-binding-checkbox:checked::after {
               content: '✔';
               color: white;
               font-size: 12px;
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
           }

           /* 快捷回复管理模式样式 */
           .quick-reply-item {
               position: relative;
               transition: background-color 0.2s;
           }

           /* 隐藏的复选框 */
           .quick-reply-checkbox {
               display: none;
               margin-right: 15px;
               width: 20px;
               height: 20px;
               border: 2px solid #ccc;
               border-radius: 50%;
               appearance: none;
               -webkit-appearance: none;
               flex-shrink: 0;
               position: relative;
           }

           .quick-reply-checkbox:checked {
               background-color: var(--accent-color);
               border-color: var(--accent-color);
           }

           .quick-reply-checkbox:checked::after {
               content: '✔';
               color: white;
               font-size: 12px;
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
           }

           /* 管理模式下显示复选框 */
           #quick-reply-list.management-mode .quick-reply-checkbox {
               display: block;
           }

           #quick-reply-list.management-mode .quick-reply-actions {
               display: none;
               /* 管理模式下隐藏单行操作按钮 */
           }

           /* 选中状态高亮 */
           .quick-reply-item.selected {
               background-color: rgba(0, 123, 255, 0.05);
           }

           /* 暗黑模式适配 */
           #phone-screen.dark-mode #quick-reply-action-bar {
               background-color: rgba(28, 28, 30, 0.95);
               border-top-color: #38383a;
               color: #fff;
           }

           /* --- 隐藏层消息显形样式 (完美伪装成系统提示) --- */

           /* 1. 布局重置：强制居中 */
           .message-wrapper.hidden-revealed {
               justify-content: center !important;
               align-self: center !important;
               width: 100%;
               margin: 5px 0;
               /* 保持系统消息的间距 */
               padding: 0;
               border: none !important;
               background: transparent !important;
               flex-direction: row !important;
           }

           /* 2. 隐藏无关元素 (头像、名字、时间、引用、小尖角) */
           .message-wrapper.hidden-revealed .avatar-group,
           .message-wrapper.hidden-revealed .sender-name,
           .message-wrapper.hidden-revealed .timestamp,
           .message-wrapper.hidden-revealed .quoted-message,
           .message-wrapper.hidden-revealed .message-bubble::after,
           /* 去掉气泡尖角 */
           .message-wrapper.hidden-revealed .message-bubble::before {
               display: none !important;
           }

           /* 3. 外层气泡：变成灰色小胶囊 */
           .message-wrapper.hidden-revealed .message-bubble {
               /* 核心外观：模仿系统消息 */
               background-color: rgba(0, 0, 0, 0.1) !important;
               color: #8a8a8a !important;
               /* 灰色文字 */
               font-size: 12px !important;
               padding: 4px 12px !important;
               border-radius: 10px !important;

               /* 布局重置 */
               flex: initial !important;
               /* 不要自动伸缩 */
               min-width: auto !important;
               max-width: 85% !important;
               width: fit-content !important;
               /* 宽度随内容 */
               display: inline-block !important;
               margin: 0 auto !important;
               /* 自身居中 */
               border: none !important;
               box-shadow: none !important;
               text-align: center;
           }

           /* 4. 【关键修复】彻底剥离内部 .content 的样式 */
           /* 这就是导致“胶囊里有气泡”的元凶，我们把它变透明 */
           .message-wrapper.hidden-revealed .message-bubble .content {
               background-color: transparent !important;
               /* 去掉白色背景 */
               box-shadow: none !important;
               /* 去掉阴影 */
               border: none !important;
               padding: 0 !important;
               /* 去掉内边距 */
               margin: 0 !important;

               /* 字体重置 */
               color: inherit !important;
               /* 继承外层的灰色 */
               font-size: inherit !important;
               /* 继承小字号 */
               line-height: 1.4 !important;
               font-weight: normal !important;

               /* 布局 */
               display: inline !important;
               /* 变成行内元素，紧贴文字 */
               width: auto !important;
               min-width: 0 !important;
           }

           /* 5. 暗黑模式适配 */
           #phone-screen.dark-mode .message-wrapper.hidden-revealed .message-bubble {
               background-color: rgba(255, 255, 255, 0.15) !important;
               /* 深色下的半透明白 */
               color: #8d8d92 !important;
               /* 浅灰字 */
           }

           /* ========== 排除消息样式 (省Token) ========== */
           .message-wrapper.msg-excluded {
               opacity: 0.45;
               position: relative;
           }
           .message-wrapper.msg-excluded .message-bubble {
               border: 1.5px dashed #ff9500 !important;
           }
           .message-wrapper.msg-excluded::after {
               content: '已排除';
               position: absolute;
               top: 2px;
               right: 8px;
               font-size: 10px;
               color: #ff9500;
               background: rgba(255, 149, 0, 0.12);
               padding: 1px 6px;
               border-radius: 8px;
               pointer-events: none;
               z-index: 5;
           }
           .message-wrapper.msg-excluded.user::after {
               right: auto;
               left: 8px;
           }
           #phone-screen.dark-mode .message-wrapper.msg-excluded .message-bubble {
               border-color: #cc7a00 !important;
           }
           #phone-screen.dark-mode .message-wrapper.msg-excluded::after {
               color: #cc7a00;
               background: rgba(204, 122, 0, 0.15);
           }
           /* 排除按钮在消息操作菜单中的样式 */
           #toggle-exclude-message-btn {
               color: #ff9500;
           }

           /* ========== 批量管理排除消息列表样式 ========== */
           .batch-exclude-item {
               display: flex;
               align-items: flex-start;
               gap: 10px;
               padding: 10px 15px;
               border-bottom: 1px solid rgba(0,0,0,0.06);
               cursor: pointer;
               transition: background 0.15s;
           }
           .batch-exclude-item:active {
               background: rgba(0,0,0,0.04);
           }
           .batch-exclude-item.is-excluded {
               background: rgba(255, 149, 0, 0.06);
           }
           .batch-exclude-item .bei-checkbox {
               width: 20px;
               height: 20px;
               border-radius: 50%;
               border: 2px solid #ccc;
               flex-shrink: 0;
               margin-top: 2px;
               display: flex;
               align-items: center;
               justify-content: center;
               transition: all 0.15s;
           }
           .batch-exclude-item.checked .bei-checkbox {
               border-color: #007aff;
               background: #007aff;
           }
           .batch-exclude-item.checked .bei-checkbox::after {
               content: '✓';
               color: white;
               font-size: 12px;
               font-weight: bold;
           }
           .batch-exclude-item .bei-content {
               flex: 1;
               min-width: 0;
           }
           .batch-exclude-item .bei-meta {
               font-size: 11px;
               color: #8a8a8a;
               margin-bottom: 2px;
           }
           .batch-exclude-item .bei-text {
               font-size: 13px;
               color: #333;
               word-break: break-all;
               display: -webkit-box;
               -webkit-line-clamp: 2;
               -webkit-box-orient: vertical;
               overflow: hidden;
           }
           .batch-exclude-item .bei-tag {
               font-size: 10px;
               color: #ff9500;
               background: rgba(255,149,0,0.1);
               padding: 1px 6px;
               border-radius: 6px;
               flex-shrink: 0;
               margin-top: 2px;
           }
           #phone-screen.dark-mode .batch-exclude-item .bei-text {
               color: #ddd;
           }
           #phone-screen.dark-mode .batch-exclude-item.is-excluded {
               background: rgba(255, 149, 0, 0.1);
           }

           /* ========== 一起看电影功能样式 ========== */
           #watch-together-modal {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               background-color: #000;
               display: none;
               z-index: 9000;
           }

           #watch-together-upload-modal,
           #watch-together-url-modal,
           #watch-together-settings-modal,
           #watch-together-playlist-modal,
           #watch-together-save-video-modal {
               z-index: 10000 !important;
           }

           /* 播放列表样式 */
           .playlist-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px;
               background-color: #f8f9fa;
               border-radius: 8px;
               border: 1px solid #e0e0e0;
               transition: all 0.2s;
           }

           .playlist-item:hover {
               background-color: #f0f0f0;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
           }

           .playlist-item-info {
               flex: 1;
               min-width: 0;
           }

           .playlist-item-name {
               font-size: 16px;
               font-weight: 600;
               color: #333;
               margin-bottom: 5px;
               overflow: hidden;
               text-overflow: ellipsis;
               white-space: nowrap;
           }

           .playlist-item-time {
               font-size: 12px;
               color: #999;
               margin-bottom: 3px;
           }

           .playlist-item-type {
               font-size: 12px;
               color: #667eea;
               font-weight: 500;
           }

           .playlist-item-actions {
               display: flex;
               gap: 8px;
               flex-shrink: 0;
           }

           .playlist-play-btn,
           .playlist-delete-btn {
               padding: 8px 16px;
               border: none;
               border-radius: 6px;
               font-size: 14px;
               font-weight: 500;
               cursor: pointer;
               transition: all 0.2s;
           }

           .playlist-play-btn {
               background-color: #667eea;
               color: white;
           }

           .playlist-play-btn:hover {
               background-color: #5568d3;
               transform: translateY(-1px);
           }

           .playlist-delete-btn {
               background-color: #f5f5f5;
               color: #ff4757;
           }

           .playlist-delete-btn:hover {
               background-color: #ffecee;
               transform: translateY(-1px);
           }

           #watch-together-header button {
               background: rgba(255, 255, 255, 0.1);
               border: 1px solid rgba(255, 255, 255, 0.2);
               color: white;
               padding: 8px 16px;
               border-radius: 6px;
               cursor: pointer;
               transition: all 0.2s;
           }

           #watch-together-header button:hover {
               background: rgba(255, 255, 255, 0.2);
           }

           /* ========== 修复：观影界面弹窗层级全面优化 ========== */

           /* 消息长按菜单及所有功能弹窗的层级要高于观影界面 */
           #message-actions-modal {
               z-index: 10100 !important;
           }

           /* 所有消息操作相关的弹窗层级都要高于观影界面 */
           #message-editor-modal,
           #ai-response-editor-modal {
               z-index: 10100 !important;
           }

           /* 其他可能在观影时触发的弹窗也提升层级 */
           #photo-viewer-modal {
               z-index: 10100 !important;
           }

           #character-profile-modal {
               z-index: 10100 !important;
           }

           #watch-together-modal.visible {
               display: block;
           }

           #watch-together-container {
               width: 100%;
               height: 100%;
               display: flex;
               flex-direction: column;
               background-color: #000;
           }

           #watch-together-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px 20px;
               padding-top: calc(15px + env(safe-area-inset-top));
               /* iOS 安全区支持 */
               background-color: #1a1a1a;
               border-bottom: 1px solid #333;
               color: #fff;
           }

           #watch-together-header button {
               background: none;
               border: none;
               color: #fff;
               font-size: 18px;
               cursor: pointer;
               padding: 5px 10px;
           }

           #watch-together-header button:hover {
               background-color: #333;
               border-radius: 4px;
           }

           #watch-together-main {
               flex: 1;
               position: relative;
               display: flex;
               overflow: hidden;
           }

           #watch-together-video-container {
               flex: 1;
               position: relative;
               background-color: #000;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           #watch-together-video {
               width: 100%;
               height: 100%;
               object-fit: contain;
           }

           #watch-together-placeholder {
               position: absolute;
               top: 50%;
               left: 50%;
               transform: translate(-50%, -50%);
               color: #999;
               text-align: center;
               font-size: 16px;
           }

           #watch-together-chat-float {
               position: absolute;
               right: 20px;
               bottom: 20px;
               width: 350px;
               max-height: 500px;
               background-color: rgba(255, 255, 255, 0.95);
               border-radius: 8px;
               display: flex;
               flex-direction: column;
               box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
               overflow: hidden;
           }

           #watch-together-chat-float.minimized {
               max-height: 40px;
           }

           #watch-together-chat-float.minimized #watch-together-chat-messages,
           #watch-together-chat-float.minimized #watch-together-chat-input-area {
               display: none;
           }

           #watch-together-chat-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 10px 15px;
               background-color: #f5f5f5;
               border-bottom: 1px solid #e0e0e0;
               cursor: move;
           }

           #watch-together-chat-name {
               font-size: 14px;
               font-weight: 500;
               color: #333;
           }

           #watch-together-chat-toggle {
               background: none;
               border: none;
               font-size: 18px;
               cursor: pointer;
               color: #666;
               padding: 0;
               width: 24px;
               height: 24px;
           }

           #watch-together-chat-messages {
               flex: 1;
               overflow-y: auto;
               padding: 15px;
               background-color: #fff;
               max-height: 350px;
           }

           .watch-together-message {
               margin-bottom: 15px;
               display: flex;
               gap: 10px;
           }

           .watch-together-message.user {
               flex-direction: row-reverse;
           }

           .watch-together-message-avatar {
               width: 36px;
               height: 36px;
               border-radius: 50%;
               object-fit: cover;
               flex-shrink: 0;
           }

           .watch-together-message-content {
               max-width: 70%;
               padding: 8px 12px;
               border-radius: 8px;
               font-size: 14px;
               line-height: 1.4;
               word-wrap: break-word;
           }

           .watch-together-message.user .watch-together-message-content {
               background-color: #07c160;
               color: #fff;
           }

           .watch-together-message.assistant .watch-together-message-content {
               background-color: #f0f0f0;
               color: #333;
           }

           .watch-together-system-message {
               text-align: center;
               color: #999;
               font-size: 12px;
               margin: 10px 0;
           }

           #watch-together-chat-input-area {
               display: flex;
               gap: 8px;
               padding: 10px 15px;
               background-color: #f5f5f5;
               border-top: 1px solid #e0e0e0;
           }

           #watch-together-chat-input {
               flex: 1;
               padding: 8px 10px;
               border: 1px solid #d0d0d0;
               border-radius: 4px;
               resize: none;
               font-size: 14px;
               outline: none;
               max-height: 80px;
           }

           #watch-together-call-api-btn {
               padding: 8px 15px;
               background-color: #576b95;
               border: none;
               border-radius: 4px;
               color: #fff;
               font-size: 14px;
               cursor: pointer;
               white-space: nowrap;
           }

           #watch-together-call-api-btn:hover {
               background-color: #4a5b82;
           }

           #watch-together-call-api-btn:disabled {
               background-color: #ccc;
               cursor: not-allowed;
           }

           #watch-together-chat-send {
               padding: 8px 15px;
               background-color: #07c160;
               border: none;
               border-radius: 4px;
               color: #fff;
               font-size: 14px;
               cursor: pointer;
               white-space: nowrap;
           }

           #watch-together-chat-send:hover {
               background-color: #06ad56;
           }

           #watch-together-chat-send:disabled {
               background-color: #ccc;
               cursor: not-allowed;
           }

           /* ========== 真心话悬浮球样式 ========== */
           #truth-game-float-ball {
               position: fixed;
               bottom: 80px;
               right: 20px;
               width: 60px;
               height: 60px;
               border-radius: 50%;
               cursor: pointer;
               z-index: 9999;
               box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
               transition: transform 0.2s ease;
               overflow: hidden;
               border: 3px solid #fff;
           }

           #truth-game-float-ball:hover {
               transform: scale(1.1);
           }

           #truth-game-float-ball:active {
               transform: scale(0.95);
           }

           #truth-game-float-avatar {
               width: 100%;
               height: 100%;
               object-fit: cover;
           }

           #truth-game-float-indicator {
               position: absolute;
               top: -2px;
               right: -2px;
               width: 16px;
               height: 16px;
               background-color: #ff4444;
               border-radius: 50%;
               border: 2px solid #fff;
               display: none;
               animation: pulse-indicator 1.5s ease-in-out infinite;
           }

           #truth-game-float-indicator.active {
               display: block;
           }

           @keyframes pulse-indicator {

               0%,
               100% {
                   transform: scale(1);
                   opacity: 1;
               }

               50% {
                   transform: scale(1.2);
                   opacity: 0.7;
               }
           }

           /* 真心话modal最小化时隐藏 */
           #truth-game-modal.minimized {
               display: none !important;
           }

           /* ========== 真心话游戏移动端适配 ========== */
           /* 桌面端优化 */
           @media (min-width: 769px) {
               #truth-game-buttons {
                   flex: 0 1 auto !important;
               }

               #truth-input {
                   flex: 1 1 auto !important;
               }
           }

           /* 平板和小屏幕适配 */
           @media (max-width: 768px) {

               /* 真心话对话框宽度适配 */
               #truth-game-modal .modal-content {
                   max-width: 100% !important;
                   margin: 0 10px !important;
                   height: 88vh !important;
               }

               /* 输入区域容器 */
               #truth-game-input-area {
                   padding: 10px 12px !important;
               }

               /* 输入框 */
               #truth-input {
                   font-size: 15px !important;
                   padding: 10px !important;
                   min-height: 42px !important;
                   margin-bottom: 8px !important;
               }

               /* 按钮组 */
               #truth-game-buttons {
                   gap: 8px !important;
               }

               /* 三个按钮 */
               #truth-start-game-btn,
               #truth-call-api-btn,
               #truth-send-btn {
                   padding: 10px 10px !important;
                   font-size: 14px !important;
                   min-height: 42px !important;
               }
           }

           /* 手机竖屏适配 */
           @media (max-width: 480px) {

               /* 真心话对话框占满屏幕 */
               #truth-game-modal .modal-content {
                   max-width: 100% !important;
                   margin: 0 !important;
                   height: 100vh !important;
                   border-radius: 0 !important;
               }

               /* 输入区域更紧凑 */
               #truth-game-input-area {
                   padding: 8px 10px !important;
               }

               /* 输入框 */
               #truth-input {
                   font-size: 14px !important;
                   padding: 8px 10px !important;
                   min-height: 38px !important;
                   margin-bottom: 8px !important;
               }

               /* 按钮组 */
               #truth-game-buttons {
                   gap: 6px !important;
               }

               /* 三个按钮均分宽度并优化间距 */
               #truth-start-game-btn,
               #truth-call-api-btn,
               #truth-send-btn {
                   padding: 9px 6px !important;
                   font-size: 13px !important;
                   min-height: 38px !important;
                   flex: 1 1 0 !important;
               }
           }

           /* 超小屏幕适配 */
           @media (max-width: 360px) {

               /* 输入区域 */
               #truth-game-input-area {
                   padding: 6px 8px !important;
               }

               /* 输入框 */
               #truth-input {
                   font-size: 13px !important;
                   padding: 7px 8px !important;
                   min-height: 36px !important;
               }

               /* 按钮组 */
               #truth-game-buttons {
                   gap: 5px !important;
               }

               /* 三个按钮 */
               #truth-start-game-btn,
               #truth-call-api-btn,
               #truth-send-btn {
                   font-size: 12px !important;
                   padding: 8px 4px !important;
                   min-height: 36px !important;
               }
           }

           /* ========================================= */
           /* ▼▼▼ 你画我猜App样式 ▼▼▼ */
           /* ========================================= */

           #draw-guess-screen {
               background-color: #f0f2f5;
           }

           #phone-screen.dark-mode #draw-guess-screen {
               background-color: #000000;
           }

           #draw-guess-content {
               display: flex;
               flex-direction: column;
               justify-content: flex-start;
               padding: 15px;
               gap: 15px;
               width: 100%;
               height: 100%;
               box-sizing: border-box;
           }

           #draw-guess-interactive-area {
               width: 100%;
               display: flex;
               flex-direction: column;
               gap: 12px;
           }

           .player-avatars-container {
               display: flex;
               justify-content: space-around;
               padding: 0 40px;
           }

           .player-info {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 8px;
           }

           .player-avatar {
               width: 50px;
               height: 50px;
               border-radius: 50%;
               object-fit: cover;
               border: 2px solid var(--border-color);
           }

           .player-name {
               font-size: 13px;
               font-weight: 500;
               color: var(--text-primary);
           }

           #draw-guess-dialogue-box {
               height: 80px;
               background-color: var(--secondary-bg);
               border: 1px solid var(--border-color);
               border-radius: 8px;
               padding: 10px;
               overflow-y: auto;
               font-size: 14px;
               color: var(--text-secondary);
           }

           #draw-guess-dialogue-box:empty::before {
               content: attr(data-placeholder);
               color: var(--text-secondary);
               font-style: italic;
               animation: typing-pulse 1.5s infinite;
           }

           .draw-guess-input-area {
               display: flex;
               flex-direction: column;
               gap: 8px;
           }

           #draw-guess-action-bar {
               display: flex;
               justify-content: space-around;
               gap: 10px;
           }

           #draw-guess-action-bar .action-bar-btn {
               background: none;
               border: 1px solid var(--accent-color);
               color: var(--accent-color);
               padding: 5px 15px;
               border-radius: 15px;
               font-size: 13px;
               cursor: pointer;
           }

           .draw-guess-input-row {
               display: flex;
               gap: 8px;
           }

           #draw-guess-input {
               flex-grow: 1;
               border: 1px solid var(--border-color);
               background-color: var(--secondary-bg);
               border-radius: 6px;
               padding: 0 12px;
               font-size: 15px;
               outline: none;
           }

           #draw-guess-send-btn {
               flex-shrink: 0;
               padding: 8px 18px;
               border: none;
               background-color: var(--accent-color);
               color: white;
               border-radius: 6px;
               font-size: 15px;
               font-weight: 500;
               cursor: pointer;
           }

           #draw-guess-main-area {
               flex-grow: 1;
               display: flex;
               justify-content: center;
               align-items: center;
               width: 100%;
           }

           #draw-guess-welcome-text {
               text-align: center;
               color: var(--text-secondary);
               line-height: 1.6;
           }

           #draw-guess-studio {
               width: 100%;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 15px;
           }

           #draw-guess-studio #drawing-canvas {
               display: block;
               background-color: #ffffff;
               border-radius: 12px;
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
               width: 100%;
               height: auto;
               aspect-ratio: 4 / 3;
               max-width: 400px;
           }

           #drawing-canvas.active {
               cursor: crosshair !important;
           }

           #draw-guess-tool-bar {
               width: 100%;
               display: flex;
               justify-content: space-around;
               align-items: center;
               flex-wrap: wrap;
               gap: 15px;
               padding: 10px 0;
           }

           .drawing-tools.left {
               display: flex;
               flex-direction: column;
               gap: 15px;
               align-items: center;
           }

           .game-controls-group {
               display: flex;
               flex-direction: column;
               gap: 10px;
           }

           .color-palette {
               display: grid;
               grid-template-columns: repeat(3, 1fr);
               gap: 12px;
           }

           .color-dot {
               width: 22px;
               height: 22px;
               border-radius: 50%;
               cursor: pointer;
               transition: transform 0.2s;
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
           }

           .color-dot.active {
               transform: scale(1.2);
               box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
           }

           .tool-buttons {
               display: flex;
               gap: 8px;
           }

           .tool-btn {
               background-color: #f0f2f5;
               border: 1px solid #dcdcdc;
               border-radius: 6px;
               padding: 6px 12px;
               font-size: 13px;
               cursor: pointer;
           }

           .tool-btn.active {
               background-color: var(--accent-color);
               color: white;
               border-color: var(--accent-color);
           }

           .game-control-btn {
               background-color: #fff;
               border: 1px solid var(--border-color);
               border-radius: 8px;
               padding: 8px 15px;
               font-size: 14px;
               color: var(--text-primary);
               cursor: pointer;
           }

           #draw-guess-bottom-bar {
               width: 100%;
               padding: 10px;
               box-sizing: border-box;
           }

           #draw-guess-bottom-bar .form-button {
               background-color: var(--accent-color);
               border-radius: 22px;
               height: 44px;
               font-size: 16px;
           }

           .custom-color-picker {
               position: relative;
               width: 22px;
               height: 22px;
               border-radius: 50%;
               cursor: pointer;
               background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red);
               box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
               border: 2px solid white;
               outline: 1px solid #ccc;
           }

           .custom-color-picker input[type="color"] {
               position: absolute;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               opacity: 0;
               cursor: pointer;
           }

           #brush-settings {
               display: flex;
               flex-direction: column;
               gap: 10px;
               margin-top: 10px;
               padding: 10px;
               background-color: var(--secondary-bg);
               border: 1px solid var(--border-color);
               border-radius: 8px;
           }

           #brush-settings label {
               font-size: 12px;
               color: var(--text-secondary);
               margin-bottom: 4px;
               display: block;
           }

           #brush-settings select {
               width: 100%;
               padding: 5px;
               border: 1px solid var(--border-color);
               border-radius: 4px;
               background-color: var(--secondary-bg);
               color: var(--text-primary);
           }

           .size-control {
               display: flex;
               flex-direction: column;
           }

           .size-control input[type="range"] {
               width: 100%;
           }

           .size-control input[type="number"] {
               margin-top: 5px;
               width: 100%;
               text-align: center;
               padding: 4px;
               border: 1px solid var(--border-color);
               border-radius: 4px;
               background-color: var(--secondary-bg);
               color: var(--text-primary);
           }

           /* ▲▲▲ 你画我猜样式结束 ▲▲▲ */

           /* ========== 移动端控制台样式 ========== */
           #mobile-console {
               position: fixed;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;
               background: var(--bg-primary, #ffffff);
               z-index: 99999;
               display: flex;
               flex-direction: column;
           }

           #phone-screen.dark-mode #mobile-console {
               background: #000000;
           }

           #mobile-console-header {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 15px 20px;
               /* iOS安全区域适配 - 避免被状态栏遮挡 */
               padding-top: calc(15px + env(safe-area-inset-top));
               background: var(--secondary-bg, #f5f5f7);
               border-bottom: 1px solid var(--border-color, #e0e0e0);
               font-size: 17px;
               font-weight: 600;
               color: var(--text-primary, #000000);
           }

           #phone-screen.dark-mode #mobile-console-header {
               background: #1c1c1e;
               border-bottom-color: #38383a;
               color: #ffffff;
           }

           #mobile-console-actions {
               display: flex;
               gap: 10px;
           }

           #mobile-console-actions button {
               padding: 6px 12px;
               font-size: 14px;
               background: var(--bg-primary, #ffffff);
               border: 1px solid var(--border-color, #d1d1d6);
               border-radius: 6px;
               color: var(--text-primary, #000000);
               cursor: pointer;
               transition: all 0.2s;
           }

           #phone-screen.dark-mode #mobile-console-actions button {
               background: #2c2c2e;
               border-color: #48484a;
               color: #ffffff;
           }

           #mobile-console-actions button:active {
               opacity: 0.6;
               transform: scale(0.95);
           }

           #mobile-console-tabs {
               display: flex;
               background: var(--secondary-bg, #f5f5f7);
               border-bottom: 1px solid var(--border-color, #e0e0e0);
               padding: 0 10px;
           }

           #phone-screen.dark-mode #mobile-console-tabs {
               background: #1c1c1e;
               border-bottom-color: #38383a;
           }

           .console-tab {
               flex: 1;
               padding: 12px 8px;
               font-size: 13px;
               background: transparent;
               border: none;
               border-bottom: 2px solid transparent;
               color: var(--text-secondary, #8e8e93);
               cursor: pointer;
               transition: all 0.2s;
           }

           #phone-screen.dark-mode .console-tab {
               color: #8e8e93;
           }

           .console-tab.active {
               color: var(--accent-color, #007aff);
               border-bottom-color: var(--accent-color, #007aff);
               font-weight: 600;
           }

           #phone-screen.dark-mode .console-tab.active {
               color: #0a84ff;
               border-bottom-color: #0a84ff;
           }

           #mobile-console-content {
               flex: 1;
               overflow-y: auto;
               padding: 10px;
               font-family: 'Courier New', Courier, monospace;
               font-size: 12px;
               line-height: 1.6;
               background: var(--bg-primary, #ffffff);
           }

           #phone-screen.dark-mode #mobile-console-content {
               background: #000000;
           }

           .console-entry {
               padding: 8px 10px;
               margin-bottom: 5px;
               border-radius: 6px;
               border-left: 3px solid;
               background: var(--secondary-bg, #f5f5f7);
               word-wrap: break-word;
               white-space: pre-wrap;
           }

           #phone-screen.dark-mode .console-entry {
               background: #1c1c1e;
           }

           .console-entry.log {
               border-left-color: #007aff;
               color: var(--text-primary, #000000);
           }

           #phone-screen.dark-mode .console-entry.log {
               border-left-color: #0a84ff;
               color: #ffffff;
           }

           .console-entry.warn {
               border-left-color: #ff9500;
               color: #ff9500;
               background: rgba(255, 149, 0, 0.1);
           }

           #phone-screen.dark-mode .console-entry.warn {
               border-left-color: #ff9f0a;
               color: #ff9f0a;
               background: rgba(255, 159, 10, 0.15);
           }

           .console-entry.error {
               border-left-color: #ff3b30;
               color: #ff3b30;
               background: rgba(255, 59, 48, 0.1);
           }

           #phone-screen.dark-mode .console-entry.error {
               border-left-color: #ff453a;
               color: #ff453a;
               background: rgba(255, 69, 58, 0.15);
           }

           .console-entry.info {
               border-left-color: #34c759;
               color: var(--text-primary, #000000);
           }

           #phone-screen.dark-mode .console-entry.info {
               border-left-color: #32d74b;
               color: #ffffff;
           }

           .console-timestamp {
               font-size: 10px;
               color: var(--text-secondary, #8e8e93);
               margin-right: 8px;
           }

           #phone-screen.dark-mode .console-timestamp {
               color: #8e8e93;
           }

           .console-message {
               display: inline;
           }

           /* ========== 移动端控制台样式结束 ========== */

           /* 守护甜心风格好友列表 */
           .shugo-list-item {
               background: rgba(255, 255, 255, 0.9);
               border: 2px solid #ffe0e6;
               border-radius: 20px;
               padding: 15px;
               margin-bottom: 12px;
               display: flex;
               align-items: center;
               transition: all 0.3s ease;
               box-shadow: 0 4px 10px rgba(255, 183, 197, 0.2);
               backdrop-filter: blur(5px);
           }

           .shugo-list-item:hover {
               transform: translateY(-2px);
               border-color: #ff6b81;
               box-shadow: 0 6px 15px rgba(255, 183, 197, 0.4);
               background: #fff;
           }

           .shugo-avatar-wrapper {
               position: relative;
               margin-right: 15px;
               flex-shrink: 0;
           }

           .shugo-avatar {
               width: 50px;
               height: 50px;
               border-radius: 50%;
               border: 2px solid #fff;
               box-shadow: 0 2px 8px rgba(255, 107, 129, 0.3);
               object-fit: cover;
           }

           .shugo-info {
               flex: 1;
               display: flex;
               flex-direction: column;
               justify-content: center;
               min-width: 0;
               /* Prevent text overflow issues */
           }

           .shugo-nickname {
               font-family: 'Quicksand', sans-serif;
               font-weight: bold;
               color: #ff6b81;
               font-size: 16px;
               margin-bottom: 4px;
               white-space: nowrap;
               overflow: hidden;
               text-overflow: ellipsis;
           }

           .shugo-id {
               font-size: 12px;
               color: #ff9ca8;
               background: #fff0f5;
               padding: 2px 8px;
               border-radius: 10px;
               display: inline-block;
               width: fit-content;
           }

           .shugo-actions {
               display: flex;
               gap: 8px;
               flex-shrink: 0;
           }

           .shugo-btn {
               padding: 6px 12px;
               border: none;
               border-radius: 15px;
               font-size: 13px;
               font-weight: bold;
               cursor: pointer;
               transition: all 0.2s;
               color: white;
               box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
               white-space: nowrap;
           }

           .shugo-btn:hover {
               transform: translateY(-1px);
               box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
           }

           .shugo-btn-primary {
               background: linear-gradient(90deg, #ff9a9e 0%, #ff6b81 100%);
           }

           .shugo-btn-secondary {
               background: linear-gradient(90deg, #a1c4fd 0%, #c2e9fb 100%);
           }

           .shugo-btn-danger {
               background: linear-gradient(90deg, #ff9a9e 0%, #fecfef 100%);
               color: #fff;
           }

           .shugo-empty {
               text-align: center;
               padding: 30px;
               color: #ff9ca8;
               background: rgba(255, 255, 255, 0.5);
               border-radius: 20px;
               border: 2px dashed #ffe0e6;
               margin: 10px;
           }

           /* ========== 语音识别确认对话框样式 ========== */
           .voice-text-confirm-dialog {
               position: fixed;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;
               z-index: 10000;
               display: flex;
               align-items: center;
               justify-content: center;
           }

           .voice-text-confirm-overlay {
               position: absolute;
               top: 0;
               left: 0;
               right: 0;
               bottom: 0;
               background: rgba(0, 0, 0, 0.5);
               backdrop-filter: blur(4px);
           }

           .voice-text-confirm-content {
               position: relative;
               background: white;
               border-radius: 16px;
               box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
               width: 90%;
               max-width: 500px;
               max-height: 80vh;
               display: flex;
               flex-direction: column;
               animation: voiceDialogSlideIn 0.3s ease-out;
           }

           @keyframes voiceDialogSlideIn {
               from {
                   opacity: 0;
                   transform: translateY(-20px) scale(0.95);
               }

               to {
                   opacity: 1;
                   transform: translateY(0) scale(1);
               }
           }

           .voice-text-confirm-header {
               padding: 20px 24px 16px;
               border-bottom: 1px solid #f0f0f0;
           }

           .voice-text-confirm-header h3 {
               margin: 0 0 8px 0;
               font-size: 18px;
               font-weight: 600;
               color: #333;
           }

           .voice-text-hint {
               margin: 0;
               font-size: 13px;
               color: #999;
           }

           .voice-text-confirm-body {
               padding: 20px 24px;
               flex: 1;
               overflow: auto;
           }

           .voice-text-input {
               width: 100%;
               min-height: 120px;
               padding: 12px;
               border: 2px solid #e0e0e0;
               border-radius: 8px;
               font-size: 14px;
               font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
               line-height: 1.6;
               resize: vertical;
               transition: border-color 0.2s;
               box-sizing: border-box;
           }

           .voice-text-input:focus {
               outline: none;
               border-color: #007AFF;
               box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
           }

           .voice-text-input::placeholder {
               color: #bbb;
           }

           .voice-text-confirm-footer {
               padding: 16px 24px;
               border-top: 1px solid #f0f0f0;
               display: flex;
               justify-content: flex-end;
               gap: 12px;
           }

           .voice-text-cancel-btn,
           .voice-text-send-btn {
               padding: 10px 24px;
               border: none;
               border-radius: 8px;
               font-size: 14px;
               font-weight: 500;
               cursor: pointer;
               transition: all 0.2s;
           }

           .voice-text-cancel-btn {
               background: #f5f5f5;
               color: #666;
           }

           .voice-text-cancel-btn:hover {
               background: #e8e8e8;
           }

           .voice-text-send-btn {
               background: #007AFF;
               color: white;
           }

           .voice-text-send-btn:hover {
               background: #0051D5;
               transform: translateY(-1px);
               box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
           }

           .voice-text-send-btn:active {
               transform: translateY(0);
           }

           /* 移动端适配 */
           @media (max-width: 600px) {
               .voice-text-confirm-content {
                   width: 95%;
                   max-height: 70vh;
               }

               .voice-text-confirm-header {
                   padding: 16px 20px 12px;
               }

               .voice-text-confirm-body {
                   padding: 16px 20px;
               }

               .voice-text-input {
                   min-height: 100px;
               }

               .voice-text-confirm-footer {
                   padding: 12px 20px;
               }
           }




           /* ========================================
   提示词管理器样式
   ======================================== */

           /* ========================================
   提示词管理器样式 (守护甜心风格)
   ======================================== */

           #prompt-scenes-container {
               padding: 10px;
               background-color: transparent;
           }

           .prompt-category {
               margin-bottom: 25px;
               border-radius: 25px;
               /* 加上淡淡的白色背景晕染，增加层次感 */
               background: rgba(255, 255, 255, 0.6);
               padding: 5px;
               box-shadow: 0 5px 20px rgba(255, 183, 197, 0.15);
           }

           .prompt-category-header {
               /* 守护甜心标志性的粉红渐变 - 调整为更浅的粉白风格 */
               background: linear-gradient(90deg, #ffc2cd 0%, #ffdde1 100%);
               color: white;
               padding: 15px 25px;
               font-weight: bold;
               font-size: 16px;
               /* 更圆润的边角 */
               border-radius: 20px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               box-shadow: 0 4px 10px rgba(255, 194, 205, 0.4);
               text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
               letter-spacing: 1px;
           }

           .category-action-btn {
               background: rgba(255, 255, 255, 0.4);
               color: #fff;
               border: 2px solid rgba(255, 255, 255, 0.8);
               padding: 6px 15px;
               border-radius: 15px;
               font-size: 12px;
               cursor: pointer;
               transition: all 0.3s ease;
               font-weight: bold;
           }

           .category-action-btn:hover {
               background: white;
               color: #ffc2cd;
               transform: translateY(-1px);
           }

           .category-action-btn:active {
               transform: scale(0.95);
           }

           .prompt-scene-list {
               background: white;
               /* 这是一个稍微缩进的设计，看起来像卡片插在口袋里 */
               margin-top: -10px;
               padding-top: 15px;
               border-radius: 0 0 20px 20px;
               overflow: hidden;
               /* 移除外层容器已经有的阴影，避免叠加太重，或者加一种内部光泽 */
               border: 2px solid #fff0f5;
               border-top: none;
           }

           .prompt-scene-item {
               display: flex;
               justify-content: space-between;
               align-items: center;
               padding: 18px 25px;
               border-bottom: 1px dashed #ffe0e6;
               /* 虚线分割更可爱 */
               transition: all 0.2s ease;
           }

           .prompt-scene-item:last-child {
               border-bottom: none;
           }

           .prompt-scene-item:hover {
               background: #fff5f7;
               /* 极淡的粉色悬停就好 */
           }

           .prompt-scene-item:active {
               background: #ffe6ea;
           }

           .prompt-scene-name {
               font-size: 15px;
               color: #666;
               /* 稍微柔和一点的黑色 */
               flex: 1;
               font-family: 'Quicksand', sans-serif;
               /* 如果有的话，可爱圆体 */
               font-weight: 600;
           }

           .prompt-scene-status {
               font-size: 12px;
               color: #ffc2cd;
               margin-right: 15px;
               background: #fff;
               padding: 2px 8px;
               border-radius: 8px;
               border: 1px solid #ffe0e6;
           }

           .prompt-scene-status.custom {
               color: #ff9a9e;
               border-color: #ff9a9e;
               font-weight: 600;
               box-shadow: 0 2px 5px rgba(255, 154, 158, 0.1);
           }

           .prompt-edit-btn {
               /* 按钮改成可爱风格 */
               background: white;
               color: #ffc2cd;
               border: 2px solid #ffc2cd;
               padding: 6px 18px;
               border-radius: 20px;
               font-size: 13px;
               cursor: pointer;
               transition: all 0.3s ease;
               font-weight: bold;
               box-shadow: 0 2px 5px rgba(255, 194, 205, 0.2);
           }

           .prompt-edit-btn:hover {
               background: #ffc2cd;
               color: white;
               transform: translateY(-2px);
               box-shadow: 0 5px 10px rgba(255, 194, 205, 0.4);
           }

           .prompt-edit-btn:active {
               transform: scale(0.95);
               transform: translateY(0);
           }

           /* 提示词编辑器模态框 */
           #prompt-editor-modal {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               /* 增加格纹背景，更有次元感 */
               background: rgba(255, 240, 245, 0.4);
               backdrop-filter: blur(8px);
               display: flex;
               justify-content: center;
               align-items: center;
               z-index: 10000;
               transition: opacity 0.3s ease;
           }

           #prompt-editor-modal .modal-content {
               background: white;
               border-radius: 30px;
               box-shadow: 0 20px 60px rgba(255, 194, 205, 0.3), 0 0 0 5px rgba(255, 255, 255, 0.8);
               overflow: hidden;
               animation: modalPopIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
               /* Q弹的动画 */
               border: 2px solid #ffe0e6;
           }

           @keyframes modalPopIn {
               0% {
                   opacity: 0;
                   transform: scale(0.8) translateY(20px);
               }

               100% {
                   opacity: 1;
                   transform: scale(1) translateY(0);
               }
           }

           #prompt-editor-modal .modal-header {
               /* 头部也是粉红渐变 */
               background: linear-gradient(90deg, #ffc2cd 0%, #ffdde1 100%);
               color: white;
               padding: 20px 30px;
               display: flex;
               justify-content: space-between;
               align-items: center;
               border-bottom: 3px solid white;
               /* 增加一点间隔感 */
           }

           #prompt-editor-modal .modal-header h3 {
               margin: 0;
               font-size: 20px;
               font-weight: bold;
               text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.1);
               letter-spacing: 1px;
           }

           #prompt-editor-modal .modal-close {
               font-size: 24px;
               cursor: pointer;
               background: rgba(255, 255, 255, 0.3);
               width: 36px;
               height: 36px;
               display: flex;
               align-items: center;
               justify-content: center;
               border-radius: 50%;
               transition: all 0.3s ease;
               color: white;
           }

           #prompt-editor-modal .modal-close:hover {
               background: white;
               color: #ffc2cd;
               transform: rotate(90deg);
           }

           #prompt-editor-textarea {
               font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
               line-height: 1.6;
               border: 2px solid #fff0f5;
               border-radius: 15px;
               padding: 15px;
               margin: 20px;
               background: #fffcfd;
               /* 微微泛红的白 */
               width: calc(100% - 40px);
               box-sizing: border-box;
               color: #666;
               font-size: 14px;
           }

           #prompt-editor-textarea:focus {
               outline: none;
               border-color: #ffc2cd;
               box-shadow: 0 0 0 4px rgba(255, 194, 205, 0.1);
               background: white;
           }

           /* 按钮容器 */
           #prompt-editor-modal .modal-footer {
               padding: 0 20px 20px 20px;
               display: flex;
               justify-content: flex-end;
               gap: 15px;
           }

           #prompt-editor-modal button {
               padding: 10px 25px;
               border-radius: 25px;
               border: none;
               cursor: pointer;
               font-weight: bold;
               transition: all 0.3s ease;
               font-size: 14px;
           }

           #prompt-editor-modal .btn-cancel {
               background: #f5f5f5;
               color: #999;
           }

           #prompt-editor-modal .btn-cancel:hover {
               background: #eee;
               color: #666;
           }

           #prompt-editor-modal .btn-save {
               background: linear-gradient(90deg, #ffc2cd 0%, #ff9a9e 100%);
               color: white;
               box-shadow: 0 4px 10px rgba(255, 194, 205, 0.3);
           }

           #prompt-editor-modal .btn-save:hover {
               transform: translateY(-2px);
               box-shadow: 0 6px 15px rgba(255, 194, 205, 0.4);
           }

           /* 移动端适配 */
           @media (max-width: 768px) {
               #prompt-editor-modal .modal-content {
                   max-width: 92% !important;
                   max-height: 90% !important;
                   border-radius: 20px;
               }

               #prompt-editor-textarea {
                   min-height: 300px !important;
                   font-size: 13px;
                   margin: 15px;
                   width: calc(100% - 30px);
               }

               #prompt-editor-modal .modal-header {
                   padding: 15px 20px;
               }
           }


           /* ========================================
              第三页 - 个人资料小组件 & 布局
              ======================================== */

           #page-3-content {
               padding: 8px 20px;
               display: flex;
               flex-direction: column;
               gap: 10px;
               align-content: start;
               box-sizing: border-box;
               flex-grow: 1;
               height: 100%;
           }

           /* --- 顶部个人资料卡片 --- */
           .p3-profile-widget {
               display: flex;
               align-items: center;
               gap: 13px;
               width: 100%;
               padding: 12px 15px;
               box-sizing: border-box;
               background: transparent;
               border-radius: 20px;
               flex-shrink: 0;
           }

           /* 左侧：头像 + 名字 */
           .p3-profile-left {
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 4px;
               flex-shrink: 0;
           }

           .p3-name-tag {
               background: rgba(255, 255, 255, 0.95);
               padding: 2px 10px;
               border-radius: 8px;
               box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
               font-size: 11px;
               font-weight: 600;
               color: #1c1c1e;
               white-space: nowrap;
           }

           .p3-avatar-wrapper {
               width: 68px;
               height: 68px;
               border-radius: 50%;
               overflow: hidden;
               box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
               border: 2.5px solid rgba(255, 255, 255, 0.8);
               flex-shrink: 0;
           }

           .p3-avatar-wrapper img {
               width: 100%;
               height: 100%;
               object-fit: cover;
               display: block;
           }

           .p3-profile-title {
               font-size: 11px;
               font-weight: 600;
               color: #1c1c1e;
               text-align: center;
               letter-spacing: 2px;
           }

           /* 右侧：装饰文字区域 */
           .p3-profile-right {
               flex: 1;
               display: flex;
               flex-direction: column;
               gap: 5px;
               min-width: 0;
           }

           .p3-deco-line {
               margin: 0;
               font-size: 12px;
               color: #555;
               line-height: 1.4;
               word-break: break-word;
           }

           .p3-studio-line {
               font-weight: 700;
               font-size: 12.5px;
               color: #333;
               letter-spacing: 1px;
               font-style: italic;
           }

           .p3-dotted-divider {
               border: none;
               border-top: 1.5px dashed rgba(0, 0, 0, 0.15);
               width: 100%;
           }

           /* 可编辑文本样式 */
           .p3-profile-widget .editable-text {
               cursor: pointer;
               transition: opacity 0.2s;
           }

           .p3-profile-widget .editable-text:hover {
               opacity: 0.7;
           }

           /* --- 第三页 App 网格 --- */
           #page-3-app-grid {
               display: grid;
               grid-template-columns: 1fr 1fr;
               gap: 25px;
               align-content: start;
               justify-items: center;
           }


           /* =============================================
              餐盘图片小组件 — 白色蕾丝风格
              ============================================= */
           .p3-plate-widget {
               width: 100%;
               flex-shrink: 0;
               background: rgba(255,255,255,0.7);
               backdrop-filter: blur(10px);
               -webkit-backdrop-filter: blur(10px);
               border-radius: 18px;
               border: 1px solid rgba(255,255,255,0.6);
               position: relative;
               overflow: hidden;
               box-shadow: 0 2px 10px rgba(0,0,0,0.04);
           }

           /* ---- 束腰绑带 (左右边缘) ---- */
           .plate-corset {
               position: absolute;
               top: 0;
               bottom: 0;
               width: 32px;
               z-index: 3;
           }
           .plate-corset-left {
               left: 0;
           }
           .plate-corset-right {
               right: 0;
           }
           .plate-corset svg {
               display: block;
           }

           /* ---- 蕾丝花边 ---- */
           .plate-lace {
               width: 100%;
               line-height: 0;
           }
           .plate-lace-bottom {
               transform: scaleY(-1);
           }

           /* ---- 顶部蝴蝶结 ---- */
           .plate-top-bow {
               display: flex;
               justify-content: center;
               margin: -4px 0 2px;
               position: relative;
               z-index: 2;
           }

           /* ---- 主内容区 ---- */
           .plate-center {
               display: flex;
               align-items: center;
               justify-content: center;
               padding: 2px 36px 8px;
               gap: 8px;
           }

           /* 刀叉容器 */
           .plate-utensil {
               flex-shrink: 0;
               line-height: 0;
           }

           /* ---- 盘子 ---- */
           .plate-dish {
               position: relative;
               display: flex;
               flex-direction: column;
               align-items: center;
               flex-shrink: 0;
           }
           .plate-dish-bow {
               margin-bottom: -6px;
               position: relative;
               z-index: 3;
           }
           .plate-dish-outer {
               width: 120px;
               height: 120px;
               border-radius: 50%;
               background: linear-gradient(145deg, #f8f8f8, #e8e8e8);
               box-shadow:
                   0 3px 10px rgba(0,0,0,0.08),
                   0 1px 3px rgba(0,0,0,0.05),
                   inset 0 2px 0 rgba(255,255,255,0.95),
                   inset 0 -1px 3px rgba(0,0,0,0.04);
               display: flex;
               align-items: center;
               justify-content: center;
               border: 1.5px solid rgba(255,255,255,0.7);
           }
           .plate-dish-inner {
               width: 85px;
               height: 85px;
               border-radius: 50%;
               overflow: hidden;
               background: #fafafa;
               box-shadow:
                   inset 0 2px 5px rgba(0,0,0,0.06),
                   0 0 0 1.5px rgba(255,255,255,0.5);
               border: 1px solid rgba(0,0,0,0.03);
           }
           .plate-dish-inner img {
               width: 100%;
               height: 100%;
               object-fit: cover;
               display: block;
           }

           /* =============================================
              第三页左右分栏：纪念日 + 微博
              ============================================= */
           .p3-split-row {
               width: 100%;
               display: flex;
               gap: 10px;
               flex-shrink: 0;
           }

           /* -- 左：纪念日 -- */
           .p3-anniversary-widget {
               flex: 1;
               display: flex;
               flex-direction: column;
               align-items: center;
               gap: 3px;
               padding: 6px 0;
           }
           .anni-day-counter {
               display: flex;
               align-items: baseline;
               gap: 3px;
           }
           .anni-day-counter span:first-child {
               font-size: 27px;
               font-weight: 700;
               color: #fff;
               text-shadow: 0 1px 6px rgba(0,0,0,0.18);
               letter-spacing: 2px;
           }
           .anni-day-unit {
               font-size: 13px;
               font-weight: 500;
               color: rgba(255,255,255,0.9);
               text-shadow: 0 1px 4px rgba(0,0,0,0.12);
           }
           .anni-photos {
               display: flex;
               justify-content: center;
           }
           .anni-photo {
               width: 60px;
               height: 60px;
               border-radius: 50%;
               overflow: hidden;
               border: 2px solid #fff;
               box-shadow: 0 2px 6px rgba(0,0,0,0.1);
               flex-shrink: 0;
               cursor: pointer;
           }
           .anni-photo:first-child {
               margin-right: -8px;
               z-index: 1;
               position: relative;
           }
           .anni-photo img {
               width: 100%;
               height: 100%;
               object-fit: cover;
               display: block;
           }
           .anni-caption {
               font-size: 11px;
               color: #666;
               margin-top: 2px;
           }
           .anni-date {
               font-size: 10px;
               color: #999;
               letter-spacing: 0.5px;
           }

           /* -- 右：微博/小红书帖子 -- */
           .p3-weibo-widget {
               flex: 1;
               display: flex;
               flex-direction: column;
               gap: 3px;
               padding: 6px 0;
               font-size: 9.5px;
               color: #333;
           }
           .weibo-header {
               display: flex;
               align-items: center;
               gap: 6px;
           }
           .weibo-avatar {
               width: 26px;
               height: 26px;
               border-radius: 50%;
               object-fit: cover;
               flex-shrink: 0;
           }
           .weibo-user-info {
               display: flex;
               flex-direction: column;
               line-height: 1.2;
           }
           .weibo-user-info span:first-child {
               font-weight: 600;
               font-size: 11px;
               color: #333;
           }
           .weibo-post-date {
               font-size: 9px;
               color: #aaa;
           }
           .weibo-body {
               line-height: 1.5;
               color: #444;
               font-size: 9.5px;
           }
           .weibo-body p {
               margin: 0;
           }
           .weibo-footer {
               font-size: 8.5px;
               color: #bbb;
           }
           .weibo-image {
               width: 58px;
               height: 68px;
               border-radius: 6px;
               overflow: hidden;
               align-self: flex-end;
               margin-top: -20px;
               cursor: pointer;
               box-shadow: 0 1px 4px rgba(0,0,0,0.08);
           }
           .weibo-image img {
               width: 100%;
               height: 100%;
               object-fit: cover;
               display: block;
           }

           /* 纪念日和微博小组件的可编辑文本样式 */
           .p3-anniversary-widget .editable-text,
           .p3-weibo-widget .editable-text {
               cursor: pointer;
               transition: opacity 0.2s;
           }

           .p3-anniversary-widget .editable-text:hover,
           .p3-weibo-widget .editable-text:hover {
               opacity: 0.7;
           }

           /* --- 第三页 App 网格 改为 4 列 --- */
           #page-3-app-grid {
               display: grid;
               grid-template-columns: repeat(4, 1fr);
               gap: 10px;
               align-content: start;
               justify-items: center;
               margin-top: auto;
           }

           /* 占位 App 图标 */
           .p3-placeholder-icon {
               width: 100%;
               height: 100%;
               display: flex;
               align-items: center;
               justify-content: center;
               font-size: 20px;
               color: #ccc;
               background: linear-gradient(135deg, #f0f0f0, #e5e5e5);
               border-radius: 14px;
           }

           .p3-placeholder-app .label {
               color: #bbb !important;
           }

           /* 移动端壁纸设置布局优化 */
           @media (max-width: 600px) {
               /* 壁纸设置项的右侧区域改为换行布局 */
               .settings-item:has(.wallpaper-thumbnail) .settings-right {
                   flex-wrap: wrap;
                   gap: 8px;
               }

               /* 预览图占据第一行 */
               .settings-item .wallpaper-thumbnail {
                   width: 40px !important;
                   height: 70px !important;
               }

               /* 按钮组占据第二行，占满整行 */
               .settings-item .action-btn-group {
                   flex: 1 0 100%;
                   display: flex;
                   gap: 6px;
                   justify-content: flex-start;
               }

               /* 按钮平分宽度 */
               .settings-item .action-btn-group .settings-mini-btn {
                   flex: 1;
                   min-width: 0;
               }
               
               /* 数据分析统计界面移动端优化 */
               #data-distribution-container {
                   padding: 10px !important;
               }
               
               /* 表格在移动端横向滚动 */
               #data-distribution-container table {
                   display: block;
                   overflow-x: auto;
                   white-space: nowrap;
               }
               
               /* 调整字体大小 */
               #data-distribution-container th,
               #data-distribution-container td {
                   font-size: 12px !important;
                   padding: 6px !important;
               }
               
               /* 清理按钮适配 */
               #data-distribution-container .cleanup-btn {
                   padding: 4px 8px !important;
                   font-size: 11px !important;
               }
           }
